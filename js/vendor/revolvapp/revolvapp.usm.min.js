!function(){var s={settings:{},post:function(t){return new i("post",t)},get:function(t){return new i("get",t)},request:function(t,e){return new i(t,e)}},i=function(t,e){var i={method:t,url:"",before:function(){},success:function(){},error:function(){},data:!1,async:!0,headers:{}};this.p=this.extend(i,e),this.p=this.extend(this.p,s.settings),this.p.method=this.p.method.toUpperCase(),this.prepareData(),this.xhr=new XMLHttpRequest,this.xhr.open(this.p.method,this.p.url,this.p.async),this.setHeaders(),!1!==("function"!=typeof this.p.before||this.p.before(this.xhr))&&this.send()};i.prototype={extend:function(t,e){if(e)for(var i in e)t[i]=e[i];return t},prepareData:function(){if(-1===["POST","PUT"].indexOf(this.p.method)||this.isFormData()||(this.p.headers["Content-Type"]="application/x-www-form-urlencoded"),"object"!=typeof this.p.data||this.isFormData()||(this.p.data=this.toParams(this.p.data)),"GET"===this.p.method){var t=-1!==this.p.url.search(/\?/)?"&":"?";this.p.url=this.p.data?this.p.url+t+this.p.data:this.p.url}},setHeaders:function(){for(var t in this.xhr.setRequestHeader("X-Requested-With",this.p.headers["X-Requested-With"]||"XMLHttpRequest"),this.p.headers)this.xhr.setRequestHeader(t,this.p.headers[t])},isFormData:function(){return void 0!==window.FormData&&this.p.data instanceof window.FormData},isComplete:function(){return!(this.xhr.status<200||300<=this.xhr.status&&304!==this.xhr.status)},send:function(){this.p.async?(this.xhr.onload=this.loaded.bind(this),this.xhr.send(this.p.data)):(this.xhr.send(this.p.data),this.loaded.call(this))},loaded:function(){var t;this.isComplete()?(t=this.parseResponse(),"function"==typeof this.p.success&&this.p.success(t,this.xhr)):(t=this.parseResponse(),"function"==typeof this.p.error&&this.p.error(t,this.xhr,this.xhr.status))},parseResponse:function(){var t=this.xhr.response,e=this.parseJson(t);return e||t},parseJson:function(t){try{var e=JSON.parse(t);if(e&&"object"==typeof e)return e}catch(t){return!1}return!1},toParams:function(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}};function r(t,e){return this.parse(t,e)}var n=[0],a="data"+(new Date).getTime();r.ready=function(t){document.addEventListener("DOMContentLoaded",t)},r.prototype={get length(){return this.nodes.length},parse:function(t,e){var i;if(t){if(t instanceof r)return this.nodes=t.nodes,t;i=/^\s*<(\w+|!)[^>]*>/.test(t)?this.create(t):"string"!=typeof t?t.nodeType&&11===t.nodeType?t.childNodes:t.nodeType||this._isWindowNode(t)?[t]:t:this._query(t,e)}else i=[];this.nodes=this._slice(i)},create:function(t){if(/^<(\w+)\s*\/?>(?:<\/\1>|)$/.test(t))return[document.createElement(RegExp.$1)];var e=[],i=document.createElement("div");i.innerHTML=t;for(var s=0,n=i.childNodes.length;s<n;s++)e.push(i.childNodes[s]);return e},dataset:function(e,i){return this.each(function(t){n[this.dataindex(t.get())][e]=i})},dataget:function(t){return n[this.dataindex(this.get())][t]},dataindex:function(t){var e=t[a],i=n.length;return e||(e=i,t&&(t[a]=i),n[e]={}),e},add:function(t){return this.nodes=this.nodes.concat(this._array(t)),this},get:function(t){return this.nodes[t||0]||!1},getAll:function(){return this.nodes},eq:function(t){return new r(this.nodes[t])},first:function(){return new r(this.nodes[0])},last:function(){return new r(this.nodes[this.nodes.length-1])},contents:function(){return this.get().childNodes},each:function(t){for(var e=this.nodes.length,i=0;i<e;i++)t.call(this,new r(this.nodes[i]),i);return this},is:function(t){return 0<this.filter(t).length},filter:function(e){var t;return void 0===e?this:(t="function"==typeof e?function(t){return e(new r(t))}:function(t){return e&&e.nodeType||e instanceof Node?e===t:(t.matches=t.matches||t.msMatchesSelector||t.webkitMatchesSelector,1===t.nodeType&&t.matches(e||"*"))},new r(this.nodes.filter.call(this.nodes,t)))},not:function(e){return this.filter(function(t){return!new r(t).is(e||!0)})},find:function(n){var a=[];return this.each(function(t){for(var e=t.get(),i=this._query(n,e),s=0;s<i.length;s++)a.push(i[s])}),new r(a)},children:function(t){var n=[];return this.each(function(t){var e=t.get();if(e.children)for(var i=e.children,s=0;s<i.length;s++)n.push(i[s])}),new r(n).filter(t)},parent:function(t){var e=this.get(),i=!!e.parentNode&&e.parentNode;return i?new r(i).filter(t):new r},parents:function(i,s){s=this._context(s);var n=[];return this.each(function(t){for(var e=t.get().parentNode;e&&e!==s;)i?new r(e).is(i)&&n.push(e):n.push(e),e=e.parentNode}),new r(n)},closest:function(i,s){s=this._context(s);var n=[],a=i&&i.nodeType;return this.each(function(t){var e=t.get();do{if(e&&(a&&e===i||new r(e).is(i)))return n.push(e)}while((e=e.parentNode)&&e!==s)}),new r(n)},next:function(t){return this._sibling(t,"nextSibling")},nextElement:function(t){return this._sibling(t,"nextElementSibling")},prev:function(t){return this._sibling(t,"previousSibling")},prevElement:function(t){return this._sibling(t,"previousElementSibling")},css:function(n,a){if(void 0!==a||"object"==typeof n)return this.each(function(t){var e=t.get(),i={};for(var s in"object"==typeof n?i=n:i[n]=a,i)e.style&&(e.style[s]=i[s])});var t=this.get();return"width"===n||"height"===n?t.style?this._getHeightOrWidth(n)+"px":void 0:t.style?getComputedStyle(t,null)[n]:void 0},attr:function(n,a,o){if(o=o?"data-":"",void 0!==a||"object"==typeof n)return this.each(function(t){var e=t.get(),i={};for(var s in"object"==typeof n?i=n:i[n]=a,i)3!==e.nodeType&&("checked"===s?e.checked=i[s]:e.setAttribute(o+s,i[s]))});var t=this.get();return t&&3!==t.nodeType?"checked"===n?t.checked:this._boolean(t.getAttribute(o+n)):void 0},data:function(t,e){if(void 0!==t&&!0!==t)return this.attr(t,e,!0);function i(t){return t[1].toUpperCase()}var s=/^data-(.+)$/,n=this.get().attributes,a={};for(var o in n)if(n[o]&&s.test(n[o].nodeName)){var r=n[o].nodeName.match(s)[1],h=n[o].value;!0!==t&&(r=r.replace(/-([a-z])/g,i)),h=-1!==h.search(/^{/)?this._object(h):this._number(h)?parseFloat(h):this._boolean(h),a[r]=h}return a},val:function(i){if(void 0!==i)return this.each(function(t){var e=t.get();e.type&&"checkbox"===e.type?e.checked=i:e.value=i});var t=this.get();return t.type&&"checkbox"===t.type?t.checked:t.value},removeAttr:function(i){return this.each(function(t){var e=t.get();i.split(" ").forEach(function(t){3!==e.nodeType&&e.removeAttribute(t)})})},addClass:function(t){return this._eachClass(t,"add")},removeClass:function(t){return this._eachClass(t,"remove")},toggleClass:function(t){return this._eachClass(t,"toggle")},hasClass:function(t){var e=this.get();return!!e.classList&&e.classList.contains(t)},empty:function(){return this.each(function(t){t.get().innerHTML=""})},html:function(t){return void 0===t?this.get().innerHTML||"":this.empty().append(t)},text:function(e){return void 0===e?this.get().textContent||"":this.each(function(t){t.get().textContent=e})},after:function(t){return this._inject(t,function(t,e){if("string"==typeof t)e.insertAdjacentHTML("afterend",t);else if(null!==e.parentNode)for(var i=t instanceof Node?[t]:this._array(t).reverse(),s=0;s<i.length;s++)e.parentNode.insertBefore(i[s],e.nextSibling);return e})},before:function(t){return this._inject(t,function(t,e){if("string"==typeof t)e.insertAdjacentHTML("beforebegin",t);else for(var i=t instanceof Node?[t]:this._array(t),s=0;s<i.length;s++)e.parentNode.insertBefore(i[s],e);return e})},append:function(t){return this._inject(t,function(t,e){if("string"==typeof t||"number"==typeof t)e.insertAdjacentHTML("beforeend",t);else for(var i=t instanceof Node?[t]:this._array(t),s=0;s<i.length;s++)e.appendChild(i[s]);return e})},prepend:function(t){return this._inject(t,function(t,e){if("string"==typeof t||"number"==typeof t)e.insertAdjacentHTML("afterbegin",t);else for(var i=t instanceof Node?[t]:this._array(t).reverse(),s=0;s<i.length;s++)e.insertBefore(i[s],e.firstChild);return e})},wrap:function(t){return this._inject(t,function(t,e){var i="string"==typeof t||"number"==typeof t?this.create(t)[0]:t instanceof Node?t:this._array(t)[0];return e.parentNode&&e.parentNode.insertBefore(i,e),i.appendChild(e),i})},unwrap:function(){return this.each(function(t){for(var e=t.get(),i=document.createDocumentFragment();e.firstChild;){var s=e.removeChild(e.firstChild);i.appendChild(s)}e.parentNode.replaceChild(i,e)})},replaceWith:function(t){return this._inject(t,function(t,e){for(var i=document.createDocumentFragment(),s="string"==typeof t||"number"==typeof t?this.create(t):t instanceof Node?[t]:this._array(t),n=0;n<s.length;n++)i.appendChild(s[n]);var a=i.childNodes[0];return e.parentNode&&e.parentNode.replaceChild(i,e),a})},remove:function(){return this.each(function(t){var e=t.get();e.parentNode&&e.parentNode.removeChild(e)})},clone:function(s){var n=[];return this.each(function(t){var e=t.get(),i=this._clone(e);s&&(i=this._cloneEvents(e,i)),n.push(i)}),new r(n)},show:function(){return this.each(function(t){var e=t.get();if(e.style&&this._hasDisplayNone(e)){var i=e.getAttribute("domTargetShow");e.style.display=i||"block",e.removeAttribute("domTargetShow")}}.bind(this))},hide:function(){return this.each(function(t){var e=t.get();if(e.style&&!this._hasDisplayNone(e)){var i=e.style.display;"block"!==i&&e.setAttribute("domTargetShow",i),e.style.display="none"}})},scrollTop:function(t){var e=this.get(),i=this._isWindowNode(e),s=9===e.nodeType?e.scrollingElement||e.body.parentNode||e.body||e.documentElement:e;return void 0!==t?(t=parseInt(t),void(i?e.scrollTo(0,t):s.scrollTop=t)):i?e.pageYOffset:s.scrollTop},offset:function(){return this._getPos("offset")},position:function(){return this._getPos("position")},width:function(t){return void 0!==t?this.css("width",parseInt(t)+"px"):this._getSize("width","Width")},height:function(t){return void 0!==t?this.css("height",parseInt(t)+"px"):this._getSize("height","Height")},outerWidth:function(){return this._getSize("width","Width","outer")},outerHeight:function(){return this._getSize("height","Height","outer")},innerWidth:function(){return this._getSize("width","Width","inner")},innerHeight:function(){return this._getSize("height","Height","inner")},click:function(){return this._trigger("click")},focus:function(){return this._trigger("focus")},blur:function(){return this._trigger("blur")},on:function(o,r,h){return this.each(function(t){for(var e=t.get(),i=o.split(" "),s=0;s<i.length;s++){var n=this._getEventName(i[s]),a=this._getEventNamespace(i[s]);r=h?this._getOneHandler(r,o):r,e.addEventListener(n,r),e._e=e._e||{},e._e[a]=e._e[a]||{},e._e[a][n]=e._e[a][n]||[],e._e[a][n].push(r)}})},one:function(t,e){return this.on(t,e,!0)},off:function(o,r){function h(t,e,i){return t===i}function l(t,e,i,s){return e===s}function p(t,e,i,s){return t===i&&e===s}function e(){return!0}return void 0===o?this.each(function(t){this._offEvent(t.get(),!1,!1,r,e)}):this.each(function(t){for(var e=t.get(),i=o.split(" "),s=0;s<i.length;s++){var n=this._getEventName(i[s]),a=this._getEventNamespace(i[s]);"_events"===a?this._offEvent(e,n,a,r,h):n||"_events"===a?this._offEvent(e,n,a,r,p):this._offEvent(e,n,a,r,l)}})},serialize:function(t){for(var e={},i=this.get().elements,s=0;s<i.length;s++){var n=i[s];if((!/(checkbox|radio)/.test(n.type)||n.checked)&&(n.name&&!n.disabled&&"file"!==n.type)){if("select-multiple"===n.type)for(var a=0;a<n.options.length;a++){var o=n.options[a];o.selected&&(e[n.name]=o.value)}e[n.name]=this._number(n.value)?parseFloat(n.value):this._boolean(n.value)}}return t?e:this._params(e)},scroll:function(){this.get().scrollIntoView({behavior:"smooth"})},fadeIn:function(t,e){var i=this._anim(t,e,500);return this.each(function(t){t.css({display:"block",opacity:0,animation:"fadeIn "+i.speed+"s ease-in-out"}).removeClass("hidden"),t.one("animationend",function(){t.css({opacity:"",animation:""}),i.fn&&i.fn(t)})})},fadeOut:function(t,e){var i=this._anim(t,e,300);return this.each(function(t){t.css({opacity:1,animation:"fadeOut "+i.speed+"s ease-in-out"}),t.one("animationend",function(){t.css({display:"none",opacity:"",animation:""}),i.fn&&i.fn(t)})})},slideUp:function(t,e){var i=this._anim(t,e,300);return this.each(function(t){t.height(t.height()),t.css({overflow:"hidden",animation:"slideUp "+i.speed+"s ease-out"}),t.one("animationend",function(){t.css({display:"none",height:"",animation:""}),i.fn&&i.fn(t)})})},slideDown:function(t,e){var i=this._anim(t,e,400);return this.each(function(t){t.height(t.height()),t.css({display:"block",overflow:"hidden",animation:"slideDown "+i.speed+"s ease-in-out"}).removeClass("hidden"),t.one("animationend",function(){t.css({overflow:"",height:"",animation:""}),i.fn&&i.fn(t)})})},_queryContext:function(t,e){return 3!==(e=this._context(e)).nodeType&&"function"==typeof e.querySelectorAll?e.querySelectorAll(t):[]},_query:function(t,e){var i=document;if(e)return this._queryContext(t,e);if(/^[.#]?[\w-]*$/.test(t)){if("#"!==t[0])return"."===t[0]?i.getElementsByClassName(t.slice(1)):i.getElementsByTagName(t);var s=i.getElementById(t.slice(1));return s?[s]:[]}return i.querySelectorAll(t)},_context:function(t){return t?"string"==typeof t?document.querySelector(t):t:document},_sibling:function(i,s){var n,a=i&&i.nodeType;return this.each(function(t){var e=t.get();do{if((e=e[s])&&(a&&e===i||new r(e).is(i)))return void(n=e)}while(e)}),new r(n)},_slice:function(t){return t&&0!==t.length?t.length?[].slice.call(t.nodes||t):[t]:[]},_array:function(t){if(void 0===t)return[];if(t instanceof NodeList){for(var e=[],i=0;i<t.length;i++)e[i]=t[i];return e}return t instanceof r?t.nodes:t},_object:function(t){return new Function("return "+t)()},_params:function(t){var e="";for(var i in t)e+="&"+this._encodeUri(i)+"="+this._encodeUri(t[i]);return e.replace(/^&/,"")},_boolean:function(t){return"true"===t||"false"!==t&&t},_number:function(t){return!isNaN(t)&&!isNaN(parseFloat(t))},_inject:function(t,e){for(var i=this.nodes.length,s=[];i--;){var n="function"==typeof t?t.call(this,this.nodes[i]):t,a=0===i?n:this._clone(n),o=e.call(this,a,this.nodes[i]);o&&(o.dom?s.push(o.get()):s.push(o))}return new r(s)},_clone:function(t){if(void 0!==t)return"string"==typeof t?t:t instanceof Node||t.nodeType?t.cloneNode(!0):"length"in t?[].map.call(this._array(t),function(t){return t.cloneNode(!0)}):void 0},_cloneEvents:function(t,e){var i=t._e;if(i)for(var s in(e._e=i)._events)for(var n=0;n<i._events[s].length;n++)e.addEventListener(s,i._events[s][n]);return e},_trigger:function(t){var e=this.get();return e&&3!==e.nodeType&&e[t](),this},_encodeUri:function(t){return encodeURIComponent(t).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},_getSize:function(t,e){var i=this.get(),s=0;return s=3===i.nodeType?0:9===i.nodeType?this._getDocSize(i,e):this._isWindowNode(i)?window["inner"+e]:this._getHeightOrWidth(t),Math.round(s)},_getDocSize:function(t,e){var i=t.body,s=t.documentElement;return Math.max(i["scroll"+e],i["offset"+e],s["client"+e],s["scroll"+e],s["offset"+e])},_getPos:function(t){var e=this.get(),i={top:0,left:0};if(3===e.nodeType||this._isWindowNode(e)||9===e.nodeType)return i;if("position"===t)return{top:e.offsetTop,left:e.offsetLeft};if("offset"!==t)return i;var s=e.getBoundingClientRect(),n=e.ownerDocument,a=n.documentElement,o=n.defaultView;return{top:s.top+o.pageYOffset-a.clientTop,left:s.left+o.pageXOffset-a.clientLeft}},_getHeightOrWidth:function(t,e){var i=t.charAt(0).toUpperCase()+t.slice(1),s=e||"offset",n=0,a=this.get(),o=getComputedStyle(a,null),r=this.parents().filter(function(t){var e=t.get();return 1===e.nodeType&&"none"===getComputedStyle(e,null).display&&e});if("none"===o.display&&r.add(a),0!==r.length){var h="visibility: hidden !important; display: block !important;",l=[];r.each(function(t){var e=t.attr("style");null!==e&&l.push(e),t.attr("style",null!==e?e+";"+h:h)}),n=a[s+i],r.each(function(t,e){void 0===l[e]?t.removeAttr("style"):t.attr("style",l[e])})}else n=a[s+i];return n},_eachClass:function(i,s){return this.each(function(t){if(i){var e=t.get();i.split(" ").forEach(function(t){e.classList&&e.classList[s](t)})}})},_getOneHandler:function(t,e){var i=this;return function(){t.apply(this,arguments),i.off(e)}},_getEventNamespace:function(t){var e=t.split("."),i=e[1]?e[1]:"_events";return e[2]?i+e[2]:i},_getEventName:function(t){return t.split(".")[0]},_offEvent:function(t,e,i,s,n){for(var a in t._e)for(var o in t._e[a])if(n(o,a,e,i))for(var r=t._e[a][o],h=0;h<r.length;h++)void 0!==s&&r[h].toString()!==s.toString()||(t.removeEventListener(o,r[h]),t._e[a][o].splice(h,1),0===t._e[a][o].length&&delete t._e[a][o],0===Object.keys(t._e[a]).length&&delete t._e[a])},_hasDisplayNone:function(t){return"none"===t.style.display||"none"===(t.currentStyle?t.currentStyle.display:getComputedStyle(t,null).display)},_anim:function(t,e,i){return t="function"==typeof t?(e=t,i):t||i,{fn:e,speed:t/1e3}},_isWindowNode:function(t){return t===window||t.parent&&t.parent===window}};function h(t,e){return o(t,e)}var o=function(t,e){var i,s="revolvapp",n=l.dom(t);return 0!==n.length&&((i=n.dataget(s))||(i=new p(n,e),n.dataset(s,i))),i},l=h;l.dom=function(t,e){return new r(t,e)},l.ajax=s,l.prefix="rex",l.version="2.3.5",l.settings={},l.lang={},l._store={},l._mixins={},l._subscribe={},l.keycodes={BACKSPACE:8,DELETE:46,UP:38,DOWN:40,ENTER:13,SPACE:32,ESC:27,TAB:9,CTRL:17,META:91,SHIFT:16,ALT:18,RIGHT:39,LEFT:37},l.add=function(t,e,i){if(i.translations&&(h.lang=l.extend(!0,l.lang,i.translations)),i.defaults){var s={};s[e]=i.defaults,h.opts=l.extend(!0,l.opts,s)}if("mixin"===t)l._mixins[e]=i;else{if(i.subscribe)for(var n in i.subscribe){void 0===l._subscribe[n]&&(l._subscribe[n]=[]);var a={module:e,func:i.subscribe[n]};l._subscribe[n].push(a)}function o(){}if((o.prototype=i).mixins)for(var r=0;r<i.mixins.length;r++)l.inherit(o,l._mixins[i.mixins[r]]);l._store[e]={type:t,proto:o}}},l.addLang=function(t,e){void 0===l.lang[t]&&(l.lang[t]={}),l.lang[t]=l.extend(!0,h.lang[t],e)},l.inherit=function(t,e){function i(){}i.prototype=e;var s=new i;for(var n in t.prototype)t.prototype.__lookupGetter__(n)?s.__defineGetter__(n,t.prototype.__lookupGetter__(n)):s[n]=t.prototype[n];return t.prototype=s,t.prototype.super=e,t},l.error=function(t){throw t},l.extend=function(){var i={},s=!1,t=0,e=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(s=arguments[0],t++);function n(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(s&&"[object Object]"===Object.prototype.toString.call(t[e])?i[e]=l.extend(!0,i[e],t[e]):i[e]=t[e])}for(;t<e;t++){n(arguments[t])}return i},h.opts={plugins:[],pluginsCss:[],source:!0,bsmodal:!1,content:!1,editor:{font:"Helvetica, Arial, sans-serif",lang:"en",https:!1,direction:"ltr",path:!1,template:!1,images:!1,viewOnly:!1,spellcheck:!0,grammarly:!1,notranslate:!1,minHeight:!1,maxHeight:!1,undoredo:!1,shortcutsPopup:!0,scrollTarget:window,mobile:400,zIndex:100,width:"600px",align:"left",doctype:'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">',delimiters:!1},autosave:{url:!1,method:"post"},image:{url:!0,select:!1,upload:!1,name:"file",data:!1,drop:!0,clipboard:!0,multiple:"single",types:["image/*"]},placeholders:{upload:'<svg height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="m17 20h-14c-1.65685425 0-3-1.3431458-3-3v-14c0-1.65685425 1.34314575-3 3-3h14c1.6568542 0 3 1.34314575 3 3v14c0 1.6568542-1.3431458 3-3 3zm1-16c0-1.1045695-.8954305-2-2-2h-12c-1.1045695 0-2 .8954305-2 2v8.524l5.32-5.324c.1671609-.20313009.41643233-.32082226.6795-.32082226s.5123391.11769217.6795.32082226l3.82 3.821 5.5-5.5v-1.521zm0 4.476-4.024 4.024 1.824 1.82c.2037074.2038286.2037074.5341714 0 .738l-.738.738c-.2038286.2037074-.5341714.2037074-.738 0l-6.324-6.32-6 6v.524c0 1.1045695.8954305 2 2 2h12c1.1045695 0 2-.8954305 2-2zm-7-2.976c0-.82842712.6715729-1.5 1.5-1.5s1.5.67157288 1.5 1.5-.6715729 1.5-1.5 1.5-1.5-.67157288-1.5-1.5z"/></svg>',image:'<svg height="180" viewBox="0 0 280 180" width="280" xmlns="http://www.w3.org/2000/svg"><path d="m278 0c1.104569 0 2 .8954305 2 2v176c0 1.104569-.895431 2-2 2h-276c-1.1045695 0-2-.895431-2-2v-176c0-1.1045695.8954305-2 2-2zm-1 3h-274v174h274zm-123 67c3.313708 0 6 2.6862915 6 6v28c0 3.313708-2.686292 6-6 6h-28c-3.313708 0-6-2.686292-6-6v-28c0-3.3137085 2.686292-6 6-6zm3 16-8.551 8.8727425 3.876 4.0130198c.432878.4494329.432878 1.1778247 0 1.6272577l-1.56825 1.627257c-.433136.449166-1.135114.449166-1.56825 0l-13.4385-13.9353211-12.75 13.2297351v1.155397c0 2.435527 1.90279 4.409912 4.25 4.409912h25.5c2.34721 0 4.25-1.974385 4.25-4.409912zm-4.25-13h-25.5c-2.34721 0-4.25 1.9569462-4.25 4.3709616v18.6290384l11.305-11.6354998c.355217-.4439369.884919-.7011509 1.443938-.7011509.559018 0 1.08872.257214 1.443937.7011509l8.1175 8.3507221 11.6875-12.0201444v-3.3241163h.002125c0-2.4140154-1.90279-4.3709616-4.25-4.3709616zm-7.75 5c1.656854 0 3 1.3431458 3 3s-1.343146 3-3 3-3-1.3431458-3-3 1.343146-3 3-3z"/></svg>',social:'<svg height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="m10 0c5.5228475 0 10 4.4771525 10 10s-4.4771525 10-10 10-10-4.4771525-10-10 4.4771525-10 10-10zm0 2c-4.418278 0-8 3.581722-8 8s3.581722 8 8 8 8-3.581722 8-8-3.581722-8-8-8zm0 6c1.1045695 0 2 .8954305 2 2s-.8954305 2-2 2-2-.8954305-2-2 .8954305-2 2-2z"/></svg>'},buffer:{limit:50},toolbar:{sticky:!0,stickyTopOffset:0},buttons:{icons:!1},colors:{base:["#111118","#ffffff"],gray:["#212529","#343a40","#495057","#868e96","#adb5bd","#ced4da","#dee2e6","#e9ecef","#f1f3f5","#f8f9fa"],red:["#c92a2a","#e03131","#f03e3e","#fa5252","#ff6b6b","#ff8787","#ffa8a8","#ffc9c9","#ffe3e3","#fff5f5"],pink:["#a61e4d","#c2255c","#d6336c","#e64980","#f06595","#f783ac","#faa2c1","#fcc2d7","#ffdeeb","#fff0f6"],grape:["#862e9c","#9c36b5","#ae3ec9","#be4bdb","#cc5de8","#da77f2","#e599f7","#eebefa","#f3d9fa","#f8f0fc"],violet:["#5f3dc4","#6741d9","#7048e8","#7950f2","#845ef7","#9775fa","#b197fc","#d0bfff","#e5dbff","#f3f0ff"],indigo:["#364fc7","#3b5bdb","#4263eb","#4c6ef5","#5c7cfa","#748ffc","#91a7ff","#bac8ff","#dbe4ff","#edf2ff"],blue:["#1864ab","#1971c2","#1c7ed6","#228be6","#339af0","#4dabf7","#74c0fc","#a5d8ff","#d0ebff","#e7f5ff"],cyan:["#0b7285","#0c8599","#1098ad","#15aabf","#22b8cf","#3bc9db","#66d9e8","#99e9f2","#c5f6fa","#e3fafc"],teal:["#087f5b","#099268","#0ca678","#12b886","#20c997","#38d9a9","#63e6be","#96f2d7","#c3fae8","#e6fcf5"],green:["#2b8a3e","#2f9e44","#37b24d","#40c057","#51cf66","#69db7c","#8ce99a","#b2f2bb","#d3f9d8","#ebfbee"],lime:["#5c940d","#66a80f","#74b816","#82c91e","#94d82d","#a9e34b","#c0eb75","#d8f5a2","#e9fac8","#f4fce3"],yellow:["#e67700","#f08c00","#f59f00","#fab005","#fcc419","#ffd43b","#ffe066","#ffec99","#fff3bf","#fff9db"],orange:["#d9480f","#e8590c","#f76707","#fd7e14","#ff922b","#ffa94d","#ffc078","#ffd8a8","#ffe8cc","#fff4e6"]},styles:{text:{"font-family":!1,"font-size":"16px","line-height":"1.5",color:"#222228"},heading:{"font-family":!1,"font-weight":"bold",color:"#111118"},link:{color:"#0091ff","font-weight":"normal","text-decoration":"underline"},button:{"font-size":"18px","font-weight":"normal",color:"#fff","background-color":"#0091ff",padding:"14px 40px","border-radius":"24px"},code:{padding:"10px","font-family":"monospace","font-size":"14px","line-height":"1.5","background-color":"#f8f8f8",color:"#111"},spacer:{height:"10px"},divider:{height:"2px","background-color":"#111118"},table:{padding:"10px 12px"}},headings:{h1:{"font-size":"32px","line-height":"1.2"},h2:{"font-size":"28px","line-height":"1.3"},h3:{"font-size":"20px","line-height":"1.4"},h4:{"font-size":"16px","line-height":"1.5"},h5:{"font-size":"16px","line-height":"1.5"},h6:{"font-size":"16px","line-height":"1.5"}},shortcutsBase:{"meta+z":"## shortcuts.meta-z ##","meta+shift+z":"## shortcuts.meta-shift-z ##","delete, backspace":"## shortcuts.delete ##"},shortcuts:{"ctrl+b, meta+b":{title:"## shortcuts.meta-b ##",name:"meta+b",command:"inline.format",params:{tag:"b"}},"ctrl+i, meta+i":{title:"## shortcuts.meta-i ##",name:"meta+i",command:"inline.format",params:{tag:"i"}},"ctrl+shift+d, meta+shift+d":{title:"## shortcuts.meta-shift-d ##",name:"meta+shift+d",command:"component.duplicate"},"ctrl+shift+up, meta+shift+up":{title:"## shortcuts.meta-shift-up ##",name:"meta+shift+&uarr;",command:"component.moveUp"},"ctrl+shift+down, meta+shift+down":{title:"## shortcuts.meta-shift-down ##",name:"meta+shift+&darr;",command:"component.moveDown"},"ctrl+shift+m, meta+shift+m":{title:"## shortcuts.meta-shift-m ##",name:"meta+shift+m",command:"inline.removeFormat"}},blocks:{add:!1,hidden:!1},forms:{textcolor:{color:{type:"color",picker:!0}},linkcolor:{"link-color":{type:"color",picker:!0}},background:{"background-color":{type:"color",picker:!0}},backgroundimage:{"background-size":{type:"checkbox",text:"## form.pattern ##"},"background-image":{type:"upload",direct:!0,observer:"component.checkImageChange",upload:{success:"image.successBackground",error:"image.error",remove:"image.removeBackground"}}},alignment:{align:{type:"segment",label:"## form.alignment ##",segments:{left:{name:"align-left",prefix:"align"},center:{name:"align-center",prefix:"align"},right:{name:"align-right",prefix:"align"}}},valign:{type:"segment",label:"## form.valign ##",observer:"component.checkValign",segments:{none:{name:"valign-none",prefix:"valign"},top:{name:"valign-top",prefix:"valign"},middle:{name:"valign-middle",prefix:"valign"},bottom:{name:"valign-bottom",prefix:"valign"}}}},border:{"border-width":{type:"number",label:"## form.width ##"},"border-color":{type:"color",label:"## form.color ##"},"border-radius":{type:"number",label:"## form.radius ##"}}},containers:{main:["toolbar","editor","source"]},markerChar:"\ufeff",tags:{denied:["font","html","style","script","head","link","title","body","meta","applet","marquee"],inline:["a","span","strong","strike","b","u","em","i","code","del","ins","samp","kbd","sup","sub","mark","var","cite","small","abbr"],block:["pre","ul","ol","li","p","h1","h2","h3","h4","h5","h6","dl","dt","dd","div","table","tbody","thead","tfoot","tr","th","td","blockquote","output","figcaption","figure","address","main","section","header","footer","aside","article","iframe"]},_blocks:{},_styles:"#outlook a{padding:0}.ExternalClass{width:100%}.ExternalClass,.ExternalClass p,.ExternalClass span,.ExternalClass font,.ExternalClass td,.ExternalClass div{line-height:100%}body,table,td,a{-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}table,td{mso-table-lspace:0;mso-table-rspace:0}img{-ms-interpolation-mode:bicubic}img{border:0;outline:none;text-decoration:none}a img{border:none}td img{vertical-align:top}table,table td{border-collapse:collapse}body{margin:0;padding:0;width:100% !important}.mobile-spacer{width:0;display:none}@media all and (max-width:639px){.container{width:100% !important;max-width:600px !important}.mobile{width:auto !important;max-width:100% !important;display:block !important}.mobile-center{text-align:center !important}.mobile-right{text-align:right !important}.mobile-left{text-align:left!important;}.mobile-hidden{max-height:0;display:none !important;mso-hide:all;overflow:hidden}.mobile-spacer{width:auto !important;display:table !important}.mobile-image,.mobile-image img {height: auto !important; max-width: 600px !important; width: 100% !important}}",_msoStyles:'\x3c!--[if mso]><style type="text/css">body, table, td, a { font-family: Arial, Helvetica, sans-serif !important; }</style><![endif]--\x3e',_tags:["html","head","title","font","style","body","preheader","main","header","container","footer","block","spacer","divider","text","link","list","list-item","heading","grid","column","column-spacer","image","menu","menu-item","menu-spacer","social","social-item","social-spacer","button","table","table-head","table-body","table-row","table-cell","code","mobile-spacer","mobile-divider","var"],_nested:["head","body","main","header","container","footer","block","grid","column","menu","social","table","table-head","table-body","table-row","list"],_elements:["main","header","footer","block","grid","column","spacer","divider","image","text","heading","link","button","menu","social","table-cell","list"],_blockElements:["column","spacer","divider","image","text","heading","link","button","menu","social","list"]},h.lang.en={accessibility:{"help-label":"Rich email editor"},editor:{title:"Body",blocks:"Blocks","add-block":"Add Block"},placeholders:{"type-url-to-add-link":"Type url to add a link...","paste-url-of-image":"Paste url of image...","or-drag-and-drop-the-image":"or drag and drop the image:",lorem:"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.","lorem-short":"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.","lorem-heading":"Lorem ipsum dolor sit amet...",button:"Button",link:"Link...",item:"Item"},buttons:{"add-item":"Add Item",cancel:"Cancel",insert:"Insert",unlink:"Unlink",save:"Save",add:"Add",html:"HTML",shortcuts:"Shortcuts","mobile-view":"Mobile View",background:"Background",settings:"Settings",alignment:"Alignment","text-color":"Text Color",border:"Border",link:"Link",items:"Items",image:"Image"},"add-sections":{one:"One",two:"Two",three:"Three",misc:"Misc"},shortcuts:{delete:"Delete","meta-z":"Undo","meta-shift-z":"Redo","meta-b":"Bold","meta-i":"Italic","meta-shift-m":"Remove inline format","meta-shift-d":"Duplicate","meta-shift-up":"Move up","meta-shift-down":"Move down"},blocks:{text:"Text",heading:"Heading",image:"Image","image-text":"Image with text","image-heading-text":"Image with heading & text",button:"Button",link:"Link",divider:"Divider",spacer:"Spacer",social:"Social",list:"List",menu:"Menu","heading-text":"Heading & text","two-text":"Text","two-headings-text":"Headings & text","two-images":"Images","two-images-text":"Images with text","two-images-headings-text":"Images with headings & text","two-buttons":"Buttons","two-links":"Links","three-text":"Text","three-headings-text":"Headings & text","three-images":"Images","three-images-text":"Images with text","three-images-headings-text":"Images with headings & text","misc-heading-text":"Heading & text","misc-text-heading":"Text & heading","misc-image-text":"Image with text","misc-text-image":"Text with image","misc-image-heading-text":"Image with heading & text","misc-heading-text-image":"Heading & text with image"},headings:{"heading-1":"Heading 1","heading-2":"Heading 2","heading-3":"Heading 3","heading-4":"Heading 4","heading-5":"Heading 5","heading-6":"Heading 6"},lists:{unordered:"Unordered",ordered:"Ordered"},elements:{block:"Block",body:"Body",button:"Button",column:"Column",grid:"Grid",divider:"Divider",footer:"Footer",header:"Header",heading:"Heading",image:"Image",link:"Link",main:"Main",menu:"Menu",social:"Social",spacer:"Spacer",text:"Text","table-cell":"Cell",list:"List"},popup:{back:"Back","insert-link":"Insert Link","edit-link":"Edit Link","add-item":"Add Item","edit-item":"Edit Item","pick-color":"Pick a color","edit-divider":"Edit Divider","edit-column":"Edit Column",border:"Border",items:"Items",background:"Background","background-image":"Image","text-color":"Text Color","link-color":"Link Color",settings:"Settings"},form:{"list-type":"List type",link:"Link",url:"Url",text:"Text",name:"Name","alt-text":"Alt Text",alignment:"Alignment",valign:"Valign",width:"Width",color:"Color",radius:"Radius","image-width":"Image Width",padding:"Padding",margin:"Margin","column-space":"Column Space",height:"Height","text-size":"Text Size",pattern:"Pattern",image:"Image",upload:"Upload",bold:"Bold",underline:"Underline","spacer-content":"Spacer Content","heading-level":"Heading Level","responsive-on-mobile":"Responsive on mobile"}};var p=function(t,e){this.keycodes=h.keycodes,this.dom=h.dom,this.ajax=h.ajax,this.prefix=h.prefix,this.uuid=0,this.$win=this.dom(window),this.$doc=this.dom(document),this.$body=this.dom("body"),this.$element=t,this._elementContent=t.html(),this._store=h._store,this._subscribe=h._subscribe,(this.app=this).initialSettings=e,this._initer=["setting","lang"],this._priority=["utils","container","source","toolbar","path","control","popup","editor","accessibility"],this._plugins=[],this.started=!1,this.start()};p.prototype={start:function(t){this.isStarted()||(t&&(this.initialSettings=t),this._initCore(),this._plugins=this.setting.get("plugins"),this.broadcast("app.before.start"),this._initModules(),this._initPlugins(),this._startPriority(),this._startModules(),this._startPlugins(),this.started=!0,this.broadcast("app.start"))},isStarted:function(){return this.started},stop:function(){this.isStopped()||(this.broadcast("app.before.stop"),this._stopPriority(),this._stopModules(),this._stopPlugins(),this.started=!1,this.broadcast("app.stop"))},isStopped:function(){return!this.started},destroy:function(){this.stop(),this.broadcast("app.destroy"),this.$element.dataset(l.namespace,!1)},broadcast:function(t,e){var i=e instanceof p.Event?e:new p.Event(t,e);if(void 0!==this._subscribe[t])for(var s=this._subscribe[t],n=0;n<s.length;n++){var a=this[s[n].module];a&&s[n].func.call(a,i)}var o=this.setting.has("subscribe")?this.setting.get("subscribe"):{};return"function"==typeof o[t]&&o[t].call(this,i),i},create:function(t){void 0===this._store[t]&&h.error('The class "'+t+'" does not exist.');var e=[].slice.call(arguments,1),i=new this._store[t].proto;if(i.app=this,i.dom=this.dom,i.ajax=this.ajax,i.prefix=this.prefix,i.uuid=this.uuid,this.lang&&(i.lang=this.lang),this.setting&&(i.opts=this.setting.dump()),i.init){var s=i.init.apply(i,e);i=s||i}return i},api:function(t){for(var e=[].slice.call(arguments,1),i=t.split("."),s=i.pop(),n=this,a=0;a<i.length;a++)n=n[i[a]];if(n&&"function"==typeof n[s])return n[s].apply(n,e)},_initCore:function(){for(var t=0;t<this._initer.length;t++)this[this._initer[t]]=this.create(this._initer[t])},_initModules:function(){for(var t in this._store)"module"===this._store[t].type&&-1===this._initer.indexOf(t)&&(this[t]=this.create(t))},_initPlugins:function(){var t=this.setting.get("plugins");for(var e in this._store)"plugin"===this._store[e].type&&-1!==t.indexOf(e)&&(this[e]=this.create(e))},_startPriority:function(){for(var t=0;t<this._priority.length;t++)this._call(this[this._priority[t]],"start")},_startModules:function(){this._iterate("module","start")},_startPlugins:function(){this._iterate("plugin","start")},_stopPriority:function(){for(var t=this._priority.slice().reverse(),e=0;e<t.length;e++)this._call(this[t[e]],"stop")},_stopModules:function(){this._iterate("module","stop")},_stopPlugins:function(){this._iterate("plugin","stop")},_iterate:function(t,e){for(var i in this._store){var s="module"===t?-1===this._priority.indexOf(i):-1!==this._plugins.indexOf(i);this._store[i].type===t&&s&&this._call(this[i],e)}},_call:function(t,e){"function"==typeof t[e]&&t[e].apply(t)}},p.Event=function(t,e){this.name=t,this.params=void 0===e?{}:e,this.stopped=!1},p.Event.prototype={is:function(t){return this.get(t)},has:function(t){return void 0!==this.params[t]},get:function(t){return this.params[t]},set:function(t,e){this.params[t]=e},stop:function(){this.stopped=!0},isStopped:function(){return this.stopped}},h.add("mixin","block",{init:function(){this.build()},getSource:function(){return this.block.getSource()},getElement:function(){return this.block.getElement()}}),h.add("mixin","tag",{init:function(t,e,i){this.$source=this._createSource(t),this._buildSourceProps(t),this.data={},this.build&&this.build(),this._buildDataFromSource(),e?this.$element=this._createFromElement(e):this.create(),this.$target=this.render(),this._renderData(),this._renderStyle(),this._renderElement()},_buildSourceProps:function(t){var e=t&&"string"!=typeof t&&!t.get?t:{};for(var i in e)"html"===i?this.$source.html(e[i]):this.$source.attr(i,e[i])},_buildDataFromSource:function(){for(var t in this.data){var e="html"===t?this.$source.html():this.$source.attr(t),i=this.data[t].prop||null;null!==e?this.data[t].value=e:null!==i&&(this.data[t].value=i)}},_createFromElement:function(t){var e=t;return this.$table=e.find("table").first(),this.$row=e.find("tr").first(),this.$cell=e.find("td").first(),e},_createSource:function(t){return"string"==typeof t||t&&t.get?this.dom(t):this.dom("<re-"+this.type+"></re-"+this.type+">")},_createTableContainer:function(t){return this.$table=this._createTable(t),this.$row=this._createRow(),this.$cell=this._createCell(),this.$row.append(this.$cell),this.$table.append(this.$row),this.$table},_createTable:function(t){var e=this.dom("<table>").attr({cellpadding:0,cellspacing:0,border:0});return t&&(e.attr("width","auto"===t?t:this.app.normalize.number(t)),e.css("width",t)),e},_createCell:function(){var t=this.dom("<td>");return t.attr({align:this._getSourceAlign(),valign:"top"}),t.css({"vertical-align":"top","line-height":1}),t},_createRow:function(){return this.dom("<tr>")},_createImage:function(){return this.dom("<img>").attr("border",0).css({margin:"0",padding:0,"max-width":"100%",border:"none","vertical-align":"top"})},_createLink:function(){var t=this.dom("<a>");return t.attr({href:"#",target:"_blank"}),t.css({"font-family":this.getStyle("text","font-family"),"font-size":this.getStyle("text","font-size"),"font-weight":this.getStyle("link","font-weight"),color:this.getStyle("link","color"),"text-decoration":"underline"}),t},_render:function(t,e,i){var s=this.getDataTargets(t),n="level"!==t&&this._setIsRemove(t,e);if(i)return this[i].call(this,e),void(n&&this._removeValue(t));for(var a=0;a<s.length;a++)this._set(s[a],t,e);n?this._removeValue(t):"html"===t?this.$source.html(e):this.$source.attr(t,e)},_renderData:function(){for(var t in this.data){var e=this.data[t].value?this.data[t].value:void 0;void 0!==e&&(e=this.app.normalize.setter(t,e),e=this.app.content.replaceToHttps(t,e),this._render(t,e,this.data[t].setter))}},_renderStyle:function(){var t=this.$source.attr("style");if(t){var e=this._cssToObject(t);this._renderDataStyle(e)}},_renderDataStyle:function(t){for(var e in t)this.data[e]?this._render(e,t[e],this.data[e].setter):this.$element.css(e,t[e])},_renderElement:function(){this.$element.dataset("instance",this),this.$element.attr("data-"+this.prefix+"-type",this.type),this._renderNoneditable(),this._renderEditable()},_renderNoneditable:function(){this.$source.attr("noneditable")&&this.$element.attr("noneditable",!0)},_renderEditable:function(){this.isEditable()&&!this.opts.editor.viewOnly&&0===this.$source.closest("[noneditable]").length&&(this.opts.editor.grammarly||this.$element.find("."+this.prefix+"-editable").attr("data-gramm_editor",!1),this.getEditableElement().attr("contenteditable",!0))},_cssToObject:function(t){for(var e,i=/([\w-]*)\s*:\s*([^;]*)/g,s={};null!=(e=i.exec(t))&&(s[e[1]]=e[2].trim()),e;);return s},_removeValue:function(t){"html"===t?this.$source.html(""):this.$source.removeAttr(t)},_get:function(t,e){var i;return e?i=this[e].call(this):null===(i="html"===t?this.$source.html():this.$source.attr(t))&&this.data[t].prop&&(i=this.data[t].prop),i=this.app.normalize.getter(t,i)},_getSibling:function(t){var e=this.getElement().get(),i=this.dom();do{if((e=e[t])&&"none"!==getComputedStyle(e,null).display){i=e;break}}while(e);var s=this.dom(i),n=!1;return s.attr("data-"+this.prefix+"-type")&&(n=s.dataget("instance")),n},_getSourceAlign:function(){return this.$source.attr("align")?this.$source.attr("align"):this.opts.editor.align},_getSourceWidth:function(){return this.$source.attr("width")?this.$source.attr("width"):this.opts.editor.width},_getSourceHtml:function(){return this.$source.html().trim()},_set:function(t,e,i){var s=t.get().tagName.toLowerCase();switch(e){case"html":t.html(i);break;case"color":case"padding":case"margin":case"width":case"height":case"border":case"font-size":case"font-weight":case"font-style":case"line-height":case"box-shadow":case"max-width":case"max-height":case"letter-spacing":case"text-transform":case"text-decoration":case"background-size":t.css(e,i),"cover"===i?t.css("background-position","center"):t.css("background-position","");break;case"background-image":t.attr("background",i),t.css(e,'url("'+i+'")');break;case"border-radius":t.css(e,i),"img"!==s&&0!==i&&t.closest("table").css("border-collapse","separate");break;case"background-color":t.css(e,i),"td"!==s&&"th"!==s||(null===i?t.removeAttr("bgcolor"):t.attr("bgcolor",i));break;case"class":t.addClass(i);break;case"alt":case"href":case"align":case"colspan":case"rowspan":t.attr(e,i);break;case"valign":"none"===i?(t.css("vertical-align",""),"td"===s&&t.removeAttr("valign")):(t.css("vertical-align",i),"td"===s&&t.attr("valign",i))}},_setIsRemove:function(t,e){var i=!1;if(e===this.getDataDefault(t))return!0;switch(t){case"alt":case"color":case"href":case"border":case"font-weight":case"border-radius":case"background-color":i=""===e;break;case"background-image":i=!1===e;break;case"background-size":i="auto"===e;break;case"valign":i="none"===e;break;case"font-style":i="normal"===e;break;case"margin":i=0===e}return i},_setParse:function(t){var e={};for(var i in t)"border-width"===i||"border-color"===i?e.border=parseInt(t["border-width"])+"px solid "+t["border-color"]:e[i]=t[i];return e},_parseHtmlLinks:function(t,e,i){var s=e.html();s=this.app.content.parseHtmlLinks(t,s,i),e.html(s)},getStyle:function(t,e){var i=this.opts.styles;if(void 0!==i[t]&&void 0!==i[t][e]){var s=i[t][e];return"font-family"===e?s||this.opts.editor.font:s}},getTag:function(){return this.$element.get().tagName.toLowerCase()},getOffset:function(){var t=this.app.editor.getFrame().offset(),e=this.$element.offset();return{top:t.top+e.top,left:t.left+e.left}},getDimension:function(){return{width:this.$element.width(),height:this.$element.height()}},getParent:function(t){var e="layer"===t?["main","header","footer"]:[t],i=this.getElement(),s=this.app.element.getParents(i,e).first();return 0!==s.length&&s.dataget("instance")},getNext:function(){return this._getSibling("nextElementSibling")},getPrev:function(){return this._getSibling("previousElementSibling")},getElements:function(t,e,i){t=t||this.opts._blockElements;var s=this.app.element.getChildren(this.$element,t);return e&&(s=s.not(this.app.element.getTypesSelector(e))),i&&(s=s.filter(function(t){return 0===t.closest("[data-"+this.prefix+"-type=column]").length}.bind(this))),s},getElement:function(){return this.$element},getEditableElement:function(){var t=this.$element.find("."+this.prefix+"-editable").first();return 0!==t.length?t:this.$element},getSource:function(){return this.$source},getSourceStyle:function(){return this.$source.attr("stylename")},getTarget:function(){return this.$target},getTitle:function(){return"## elements."+this.getType()+" ##"},getType:function(){return this.type},getLinkData:function(t){t=t||this.$source;var e=!!this.isType("text")&&this.getLinkColor();return e=e||this.getStyle("link","color"),this.data["link-color"]&&(this.data["link-color"].value=e),{"font-family":t.attr("font-family")||this.getStyle("text","font-family"),"font-size":t.attr("font-size")||this.getStyle("text","font-size"),"font-weight":this.getStyle("link","font-weight"),"line-height":t.attr("line-height")||this.getStyle("text","line-height"),color:e,"text-decoration":this.getStyle("link","text-decoration")||"underline"}},getData:function(t){var e={};for(var i in this.data)if(e[i]=this._get(i,this.data[i].getter),"border"===i){var s=e[i];if(s){var n=s.split(" ");e["border-width"]=this.app.normalize.getter("border-width",n[0]),e["border-color"]=this.app.normalize.getter("border-color",n[2])}}return t?e[t]:e},getDataTargets:function(t){var e=!!this.data[t]&&this.data[t].target;if(!1===e)return e;for(var i=[],s=0;s<e.length;s++)i.push(this.getDataTarget(e[s]));return i},getDataTarget:function(t){return this["$"+t]},getDataDefault:function(t){var e=null;return void 0!==this.data[t]&&void 0!==this.data[t].prop&&(e=this.data[t].prop),e},getAlign:function(){var t=this.getParent("block"),e=this.getParent("column"),i=this.$source.attr("align");return null===i&&(e?i=e.getSource().attr("align"):t&&(i=t.getSource().attr("align"))),i},getHeadingStyleByLevel:function(t,e){return void 0!==this.opts.headings[t]?this.opts.headings[t][e]:this.opts.styles.text[e]},getElementsTextColor:function(){var t=this.getElements(["text","heading"]).first(),e=0!==t.length?t.dataget("instance").getData("color"):null;return null!==e?e:this.getStyle("text","color")},getElementsLinkColor:function(){var t=this.getElements(["text"]).find("a").first(),e=0!==t.length?t.css("color"):null;return null!==e?this.app.color.normalize(e):this.getStyle("link","color")},setData:function(t){for(var e in t=this._setParse(t)){var i=t[e],s=!!this.data[e]&&this.data[e].setter;i=this.app.normalize.setter(e,i),i=this.app.content.replaceToHttps(e,i),this._render(e,i,s)}},setStyle:function(t){this._renderDataStyle(t)},setElementsTextColor:function(e){this.getElements(["text","heading"]).each(function(t){t.dataget("instance").setData({color:e})})},setElementsLinkColor:function(t){this.getElements(["text"]).find("a").css("color",t)},isActiveSource:function(){return this.$source.attr("active")},isAllowedButton:function(t){var e=this.getType();return(!Object.prototype.hasOwnProperty.call(t,"except")||-1===t.except.indexOf(e))&&(void 0===t.components||"all"===t.components||(!(!Array.isArray(t.components)||-1===t.components.indexOf(e))||!("editable"!==t.components||!this.isEditable())))},isEditable:function(){return this.editable},isType:function(t){return t===this.type},isBlock:function(){return this.isType("block")},isLayer:function(){return this.isType("main")||this.isType("header")||this.isType("footer")},isEmpty:function(){return 0===this.getElements().length},isUnremovable:function(){return this.$source.attr("unremovable")},renderNodes:function(){var t=this.$source.get().tagName.toLowerCase().replace("re-","");-1!==this.opts._nested.indexOf(t)&&this.app.editor.render(this.$source.children(),this.getTarget())},remove:function(){this.isType("image")?this.app.broadcast("image.remove",{image:this.$img}):this.$element.find("[data-"+this.prefix+"-type=image]").each(function(t){this.app.broadcast("image.remove",{image:t})}.bind(this)),this.app.broadcast("component.remove",{element:this.$element}),this.$source.remove(),this.$element.remove()},removeStyle:function(t){for(var e in t)t[e]=this.getDataDefault(e);this._renderDataStyle(t)},add:function(t){this.getTarget().append(t.getElement()),this.getSource().append(t.getSource())},sync:function(){var t=this.getTarget().html().trim();t=this.app.utils.wrap(t,function(t){t.find("a").removeAttr("style target")}),"list"===this.getType()&&(t=this.app.utils.wrap(t,function(t){t.find("li").replaceWith(function(t){var e=t.getAttribute("class"),i=this.dom("<re-list-item>").html(t.innerHTML);return e&&i.addClass(e),i}.bind(this))}.bind(this))),"heading"===this.getType()&&!0===this.href&&(t=this.$link.html().trim()),this.$source.html(t)}}),h.add("mixin","tool",{init:function(t,e,i,s){this.name=t,this.setter=i.get("setter"),this.popup=i,this.data=s,this.instance=i.getInstance(),this.obj=this._observe(e),this.obj&&this._build()},getElement:function(){return this.$tool},getInput:function(){return this.$input},getValue:function(){return this.$input.val().trim()},setValue:function(t){this.$input.val(t)},setFocus:function(){this.$input.focus()},trigger:function(t){this.setValue(t),this.setter&&this.app.api(this.setter,this.popup)},_build:function(){this._buildTool(),this._buildLabel(),this._buildInputElement(),this._buildInput(),this._buildEvent(),this._has("placeholder")&&this.$input.attr("placeholder",this.lang.parse(this.obj.placeholder)),this._has("width")&&this.$input.css("width",this.obj.width),this._has("classname")&&this.$input.addClass(this.obj.classname)},_buildInputElement:function(){this.$input=this.dom("<"+this._getInputParam("tag")+">").addClass(this.prefix+this._getInputParam("classname")),this.$input.attr({name:this.name,type:this._getInputParam("type"),"data-type":this.type}),this.$input.dataset("instance",this)},_buildInput:function(){},_buildEvent:function(){if(-1===["segment"].indexOf(this.type)&&this.setter){var t="checkbox"===this.type||"select"===this.type?"change":"keydown blur";t="number"===this.type?t+" change":t,this.$input.on(t,this._catchSetter.bind(this))}},_buildTool:function(){this.$tool=this.dom("<div>").addClass(this.prefix+"-form-item").dataset("instance",this)},_buildLabel:function(){"checkbox"!==this.type&&this._has("label")&&(this.$label=this.dom("<label>").addClass(this.prefix+"-form-label").html(this.lang.parse(this.obj.label)),this.$tool.append(this.$label))},_getInputParam:function(t){return this.input&&void 0!==this.input[t]?this.input[t]:""},_get:function(t){return this.obj[t]},_has:function(t){return Object.prototype.hasOwnProperty.call(this.obj,t)},_observe:function(t){return Object.prototype.hasOwnProperty.call(t,"observer")&&(t=this.app.api(t.observer,t,this.name)),t},_catchSetter:function(t){"keydown"===t.type&&13!==t.which||("keydown"===t.type&&t.preventDefault(),this.app.api(this.setter,this.popup))}}),h.add("module","accessibility",{start:function(){this._buildRole(),this._buildLabel()},_buildRole:function(){this.app.editor.getEditor().attr({"aria-labelledby":this.prefix+"-voice",role:"presentation"})},_buildLabel:function(){var t=this.lang.get("accessibility.help-label"),e=this._createLabel(t);this.app.container.get("main").prepend(e)},_createLabel:function(t){var e=this.dom("<span />").addClass(this.prefix+"-voice-label");return e.attr({id:this.prefix+"-voice-"+this.uuid,"aria-hidden":!1}),e.html(t),e}}),h.add("module","button",{init:function(t,e,i,s){if("object"==typeof t)this.name=t.name,this.obj=e,this._buildFromElement(t.element);else if(t){this.type=s||!1,this.name=t;var n=this._observe(e);this.obj=void 0===n?e:n,this.obj&&this._build(t,i)}},setColor:function(t,e){var i=t.getName();if("background"===i||"text-color"===i){var s="background"===i?"background-color":"color";this.setBackground(e[s])}},isButton:function(){return!0},isAddbar:function(){return this._has("addbar")},isControl:function(){return this._has("control")},getName:function(){return this.name},getTitle:function(){return this.title},getParams:function(){return!!this._has("params")&&this.obj.params},getOffset:function(){return this.$button.offset()},getDimension:function(){return{width:this.$button.width(),height:this.$button.height()}},getElement:function(){return this.$button},setBackground:function(t){this._background("add",t)},resetBackground:function(){this._background("remove","")},_has:function(t){return Object.prototype.hasOwnProperty.call(this.obj,t)},_observe:function(t){return Object.prototype.hasOwnProperty.call(t,"observer")&&(t=this.app.api(t.observer,t,this.name)),t},_background:function(t,e){var i="remove"===t?"removeClass":"addClass";this.$icon[i](this.prefix+"-button-icon-color").css({"background-color":e,color:""!==e?this.app.color.invert(e):""})},_buildFromElement:function(t){this.$button=this.dom(t),this.$button.addClass(this.prefix+"-button-target"),this._buildData()},_build:function(t,e){this._buildTitle(),this._buildElement(),this._buildIcon(),this._buildData(e)},_buildData:function(t){this.$button.attr({tabindex:"-1","data-name":this.name,"data-command":this.obj.command||!1}),this.$button.dataset("instance",this);var e=this._has("command")?"_catch":"_stop";this.$button.on("click."+this.prefix+"-button",this[e].bind(this)),this.$button.on("dragstart."+this.prefix+"-button",function(t){t.preventDefault()}),t&&(this._buildTooltip(),this._buildBackground(),this._buildPosition(t))},_buildTitle:function(){this.title=void 0!==this.obj.title?this.lang.parse(this.obj.title):""},_buildElement:function(){this.$button=this.dom('<a href="#"></a>'),this.$button.addClass(this.prefix+"-button "+this.prefix+"-button-target"),this.type&&this.$button.addClass(this.prefix+"-button-"+this.type),this._has("classname")&&this.$button.addClass(this.obj.classname)},_buildIcon:function(){var t=this._has("icon"),e='<span class="'+this.prefix+"-icon-"+this.name+'"></span>';this.$icon=this._buildIconElement(),t&&!0!==this.obj.icon&&(e=-1!==this.obj.icon.search(/</)?this.obj.icon:'<span class="'+this.prefix+"-icon-"+this.obj.icon+'"></span>'),this.opts.buttons.icons&&void 0!==this.opts.buttons.icons[this.name]&&(e=this.opts.buttons.icons[this.name]),this.$icon.append(e),this.$button.append(this.$icon)},_buildIconElement:function(){return this.dom("<span>").addClass(this.prefix+"-button-icon")},_buildTooltip:function(){("toolbar"===this.type||"context"===this.type&&this.opts.tooltip.context)&&this.app.tooltip.build(this.$button,this.title)},_buildBackground:function(){this._has("background")&&this.setBackground(this.obj.background)},_buildPosition:function(t){if(this._has("position")){var e=this.obj.position;if("first"===e)t.prepend(this.$button);else if("object"==typeof e){var i=Object.prototype.hasOwnProperty.call(e,"after")?"after":"before",s=e[i],n=this._findPositionElement(s,t);n?n[i](this.$button):t.append(this.$button)}}else t.append(this.$button)},_findPositionElement:function(t,e){var i;if(Array.isArray(t))for(var s=0;s<t.length&&0===(i=e.find("[data-name="+t[s]+"]")).length;s++);else i=e.find("[data-name="+t+"]");return 0!==i.length?i:0},_stop:function(t){t.preventDefault(),t.stopPropagation()},_catch:function(t){t.preventDefault(),t.stopPropagation();var e=this.dom(t.target).closest("."+this.prefix+"-button-target");if(!e.hasClass("disable")){this.app.editor.setFocus();var i=e.attr("data-command"),s=e.attr("data-name"),n=e.dataget("instance");this.app.api(i,this.getParams(),n,s,t),this.app.tooltip.close()}}}),h.add("module","color",{init:function(){},normalize:function(t){return t=(t=t?this.rgb2hex(t):t)?this.shorthex2long(t):t},replaceRgbToHex:function(t){return t.replace(/rgb\((.*?)\)/g,function(t,e){return"#"+e.split(",").map(function(t){return 1===(t=parseInt(t).toString(16)).length?"0"+t:t}).join("")})},rgb2hex:function(t){if(-1===t.search(/^rgb/i))return t;var e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},shorthex2long:function(t){return 3===(t=this._removeHexDiese(t)).length?"#"+t[0]+t[0]+t[1]+t[1]+t[2]+t[2]:"#"+t},invert:function(t){return t=""===t||null==t?"#ffffff":t,t=this.normalize(t),t=this._removeHexDiese(t),186<.299*parseInt(t.slice(0,2),16)+.587*parseInt(t.slice(2,4),16)+.114*parseInt(t.slice(4,6),16)?"black":"white"},_removeHexDiese:function(t){return 0===t.indexOf("#")?t.slice(1):t}}),h.add("module","element",{is:function(t,e,i){var s=!1,n="text"===e?t:this._getNode(t);return"inline"===e?s=this._isElement(n)&&this._isInlineTag(n.tagName,i):"blocks"===e?s=this._isElement(n)&&n.hasAttribute("data-"+this.prefix+"-type"):"blocks-first"===e?s=this._isElement(n)&&n.hasAttribute("data-"+this.prefix+"-first-level"):"block"===e?s=this._isElement(n)&&this._isBlockTag(n.tagName,i):"element"===e?s=this._isElement(n):"text"===e?s="string"==typeof n&&!/^\s*<(\w+|!)[^>]*>/.test(n)||this.isTextNode(n):"list"===e?s=this._isElement(n)&&-1!==["ul","ol"].indexOf(n.tagName.toLowerCase()):"heading"===e&&(s=this._isElement(n)&&-1!==["h1","h2","h3","h4","h5","h6"].indexOf(n.tagName.toLowerCase())),s},isEmptyOrImageInline:function(t){var e=this.dom(t).get();if(!e||3===e.nodeType)return!1;var i=e.tagName.toLowerCase(),s="false"===e.getAttribute("contenteditable"),n=this.is(e,"inline");return!!(n&&this.isEmpty(e)||n&&s||-1!==["svg","img"].indexOf(i))},isEmpty:function(t){var e=this._getNode(t);return!!e&&(3===e.nodeType?""===e.textContent.trim().replace(/\n/,""):""===e.innerHTML)},isTag:function(t,e){return this._getNode(t).tagName.toLowerCase()===e},isTextNode:function(t){var e=this._getNode(t);return e&&e.nodeType&&3===e.nodeType},isVisible:function(t){var e=this._getNode(t);return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},isScrollVisible:function(t){var e=this.app.scroll.getTarget(),i=this.dom(t),s=e.scrollTop()+e.height();return i.offset().top<=s},getFirstLevel:function(t){return this.dom(t).closest("[data-"+this.prefix+"-first-level]")},getDataBlock:function(t){return this.dom(t).closest("[data-"+this.prefix+"-type]")},getType:function(t){return this.dom(t).attr("data-"+this.prefix+"-type")},getAllInlines:function(t){for(var e=[],i=t;i;)this.is(i,"inline")&&e.push(i),i=i.parentNode;return e},getClosest:function(t,e){return this.dom(t).closest(this.getTypesSelector(e))},getParents:function(t,e){return this.dom(t).parents(this.getTypesSelector(e))},getChildren:function(t,e){return this.dom(t).find(this.getTypesSelector(e))},getTypesSelector:function(t){return"[data-"+this.prefix+"-type="+t.join("],[data-"+this.prefix+"-type=")+"]"},hasClass:function(t,e){e="string"==typeof e?[e]:e;for(var i=this.dom(t),s=e.length,n=0,a=0;a<s;a++)i.hasClass(e[a])&&n++;return s===n},scrollTo:function(t,e){if(!this.isScrollVisible(t)){e=e||60;var i=t.offset(),s=this.app.scroll.getTarget(),n=i.top-e;s.scrollTop(n),setTimeout(function(){s.scrollTop(n)},1)}},replaceToTag:function(t,n,a){return this.dom(t).replaceWith(function(t){var e=this.dom("<"+n+">");if(a||e.append(t.innerHTML),t.attributes)for(var i=t.attributes,s=0;s<i.length;s++)e.attr(i[s].nodeName,i[s].value);if(a)for(;0<t.childNodes.length;)e.append(this.dom(t.firstChild));return e}.bind(this))},split:function(t){var e=this.dom(t),i=(t=e.get()).tagName.toLowerCase(),s=this.app.content.extractHtmlFromCaret(t);s.nodeType&&11===s.nodeType&&(s=this.dom(s.childNodes));var n=this.dom("<"+i+" />");(n=this.cloneAttrs(t,n)).append(s),e.after(n);var a=e.children().last();if(this.is(a,"inline")){var o=a.html();""===(o=this.app.utils.removeInvisibleChars(o))&&a.remove()}var r=this.getType(n);return r&&this.app.create("block."+r,n,!0),""===e.html()&&e.remove(),n},cloneEmpty:function(t){var e=this.dom(t).get().tagName.toLowerCase();return this.dom("<"+e+">")},cloneAttrs:function(t,e){for(var i=this.dom(e),s=this._getNode(t).attributes,n=s.length;n--;){var a=s[n];i.attr(a.name,a.value)}return i},getAttrs:function(t){var e=this._getNode(t),i={};if(null!=e.attributes&&e.attributes.length)for(var s=0;s<e.attributes.length;s++){var n=e.attributes[s].nodeValue;n=this._isNumber(n)?parseFloat(n):this._getBooleanFromStr(n),i[e.attributes[s].nodeName]=n}return i},removeEmptyAttrs:function(t,e){var i=this.dom(t),s=e.join(" "),n=!1;return void 0===i.attr(s)||null===i.attr(s)?n=!0:""===i.attr(s)&&(i.removeAttr(s),n=!0),n},getBlocks:function(t,e,i){var s=this._getNode(t).childNodes,n=[],a=e||this.opts.tags.parser;i&&(a=this.app.utils.extendArray(a,i));for(var o=0;o<s.length;o++)1===s[o].nodeType&&-1!==a.indexOf(s[o].tagName.toLowerCase())&&n.push(s[o]);return n},hasBlocks:function(t){return 0!==this.getBlocks(t).length},hasTextSiblings:function(t){var e=this._getNode(t),i=e.previousSibling&&3===e.previousSibling.nodeType&&!this.isEmpty(e.previousSibling),s=e.nextSibling&&3===e.nextSibling.nodeType&&!this.isEmpty(e.nextSibling);return i||s},_getNode:function(t){return this.dom(t).get()},_getBooleanFromStr:function(t){return"true"===t||"false"!==t&&t},_isBlockTag:function(t,e){return-1!==this.app.utils.extendArray(this.opts.tags.block,e).indexOf(t.toLowerCase())},_isInlineTag:function(t,e){return-1!==this.app.utils.extendArray(this.opts.tags.inline,e).indexOf(t.toLowerCase())},_isElement:function(t){return t&&t.nodeType&&1===t.nodeType},_isTag:function(t){return void 0!==t&&t},_isNumber:function(t){return!isNaN(t)&&!isNaN(parseFloat(t))}}),h.add("module","fragment",{build:function(t){return this.is(t)?t:this.create(t)},insert:function(t){var e=this.app.selection.get();if(e.range){if(e.collapsed){var i=e.range.startContainer;3!==i.nodeType&&"BR"===i.tagName&&i.parentNode.removeChild(i)}else e.range.deleteContents();t.frag?e.range.insertNode(t.frag):e.range.insertNode(t)}},createContainer:function(t){var e=this.dom("<div>");return"string"==typeof t?e.html(t):e.append(this.dom(t).clone(!0)),e.get()},create:function(t){for(var e,i,s,n="string"==typeof t?this.createContainer(t):t,a=document.createDocumentFragment(),o=[],r=0;e=n.firstChild;){r++;var h=a.appendChild(e);1===r&&(i=h),o.push(h),s=h}return{frag:a,first:i,last:s,nodes:o}},is:function(t){return"object"==typeof t&&t.frag}}),h.add("module","lang",{init:function(){this.langKey=this.app.setting.get("editor.lang"),this.vars=this._build()},get:function(t){var e=this._get(t,this.vars);return void 0===e&&"en"!==this.langKey&&(e=this._get(t,l.lang.en)),void 0===e?"":e},parse:function(t){if("string"!=typeof t)return t;var e=t.match(/## (.*?) ##/g);if(e)for(var i=0;i<e.length;i++){var s=e[i].replace(/^##\s/g,"").replace(/\s##$/g,"");t=t.replace(e[i],this.get(s))}return t},_get:function(t,e){var i=t.split(".");return 1===i.length?e[t]:void 0!==e[i[0]]?e[i[0]][i[1]]:void 0},_build:function(){var t=l.lang.en;return"en"!==this.langKey&&(t="undefined"!==l.lang[this.langKey]?l.lang[this.langKey]:t),t}}),h.add("module","progress",{stop:function(){this.hide()},show:function(){this.hide(),this.$progress=this.dom("<div>").addClass(this.prefix+"-editor-progress"),this.$progress.attr("id",this.prefix+"-progress"),this.$progressBar=this.dom("<span>"),this.$progress.append(this.$progressBar),this.app.$body.append(this.$progress)},hide:function(){this.app.$body.find("#"+this.prefix+"-progress").remove()}}),h.add("module","scroll",{init:function(){this.scrolltop=!1},save:function(){this.scrolltop=this.getTarget().scrollTop()},restore:function(){!1!==this.scrolltop&&(this.getTarget().scrollTop(this.scrolltop),this.scrolltop=!1)},isTarget:function(){return this.opts.editor.scrollTarget!==window},getTarget:function(){return this.dom(this.opts.editor.scrollTarget)}}),h.add("module","setting",{init:function(){this.opts=this._build()},dump:function(){return this.opts},has:function(t){var e=t.split(".");return 1===e.length?void 0!==this.opts[t]:void 0!==this.opts[e[0]]&&void 0!==this.opts[e[1]]},set:function(t,e,i){void 0===this.opts[t]&&(this.opts[t]={}),void 0===i?this.opts[t]=e:this.opts[t][e]=i},get:function(t){var e=t.split(".");return 1===e.length?this.opts[t]:void 0!==this.opts[e[0]]?this.opts[e[0]][e[1]]:void 0},_build:function(){var t=l.extend(!0,{},l.opts,this.app.initialSettings);return t=l.extend(!0,t,l.settings)}}),h.add("module","shortcut",{init:function(){if(this.opts.shortcutsRemove)for(var t=this.opts.shortcutsRemove,e=0;e<t.length;e++)this.remove(t[e]);this.shortcuts=this.opts.shortcuts,this.hotkeys={8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},this.hotkeysShiftNums={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},add:function(t,e){this.shortcuts[t]=e},remove:function(t){this.opts.shortcutsBase=this._remove(t,this.opts.shortcutsBase),this.opts.shortcuts=this._remove(t,this.opts.shortcuts)},popup:function(t,e){var i=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)?"<b>&#8984;</b>":"ctrl",s={},n=0;n=this._buildPopupItems(s,n,this.opts.shortcutsBase,i,"base"),this._buildPopupItems(s,n,this.opts.shortcuts,i),this.app.popup.create("shortcuts",{width:"360px",items:s}),this.app.popup.open({button:e})},handle:function(t){if((this.triggered=!1)===this.shortcuts)return!t.ctrlKey&&!t.metaKey||66!==t.which&&73!==t.which||t.preventDefault(),!0;if(t.ctrlKey||t.metaKey||t.shoftKey||t.altKey)for(var e in this.shortcuts)this._build(t,e,this.shortcuts[e]);return this.triggered},_buildPopupItems:function(t,e,i,s,n){for(var a in i){for(var o=this.dom("<div>").addClass(this.prefix+"-popup-shortcut-item"),r="base"===n?i[a]:i[a].title,h=this.dom("<span>").addClass(this.prefix+"-popup-shortcut-title").html(this.lang.parse(r)),l=this.dom("<span>").addClass(this.prefix+"-popup-shortcut-kbd"),p=("base"===n?a.replace("meta",s):i[a].name.replace("meta",s)).split("+"),c=0;c<p.length;c++)p[c]="<span>"+p[c]+"</span>";l.html(p.join("+")),o.append(h),o.append(l),t[e]={html:o},e++}return e},_build:function(t,e,i){for(var s=e.split(","),n=s.length,a=0;a<n;a++)"string"!=typeof s[a]||Object.prototype.hasOwnProperty.call(i,"trigger")||this._handler(t,s[a].trim(),i)},_handler:function(t,e,i){e=e.toLowerCase().split(" ");for(var s=this.hotkeys[t.keyCode],n=91!==t.which&&String.fromCharCode(t.which).toLowerCase(),a="",o={},r=["meta","ctrl","alt","shift"],h=0;h<r.length;h++){var l=r[h];t[l+"Key"]&&s!==l&&(a+=l+"+")}93===t.keyCode&&(a+="meta+"),s&&(o[a+s]=!0),n&&(o[a+n]=!0,o[a+this.hotkeysShiftNums[n]]=!0,"shift+"===a&&(o[this.hotkeysShiftNums[n]]=!0));for(var p=e.length,c=0;c<p;c++)if(o[e[c]])return t.preventDefault(),this.triggered=!0,void this.app.api(i.command,i.params,t)},_remove:function(i,s){return Object.keys(s).reduce(function(t,e){return e!==i&&(t[e]=s[e]),t},{})}}),h.add("module","tooltip",{init:function(){this.classname=this.prefix+"-tooltip",this.eventname=this.prefix+"-button-"+this.uuid},stop:function(){this.close()},build:function(t,e){(e=this._cleanTitle(e))&&(t.attr("data-tooltip",e),t.on("mouseover."+this.eventname,this.open.bind(this)),t.on("mouseout."+this.eventname,this.close.bind(this)))},open:function(t){var e=this._getButton(t);this.app.popup.isOpen()||e.hasClass("disable")||(this.$tooltip=this._create(e),this._setPosition(e),this._fixBSModal(),this.app.$body.append(this.$tooltip))},close:function(){this.app.$body.find("."+this.classname).remove()},_create:function(t){return this.dom("<span>").addClass(this.classname).html(t.attr("data-tooltip"))},_cleanTitle:function(t){return!!t&&t.replace(/(<([^>]+)>)/gi,"")},_setPosition:function(t){var e=t.offset(),i=t.height();this.$tooltip.css({top:e.top+i+"px",left:e.left+"px"})},_fixBSModal:function(){this.opts.bsmodal&&this.$tooltip.css("z-index",1060)},_getButton:function(t){return this.dom(t.target).closest("."+this.prefix+"-button-target")}}),h.add("class","upload",{defaults:{type:"image",box:!1,url:!1,cover:!0,name:"file",data:!1,multiple:!0,placeholder:!1,hidden:!0,target:!1,success:!1,error:!1,remove:!1,trigger:!1,input:!1},init:function(t,e,i){this.eventname=this.prefix+"-upload",t&&this._build(t,e,i)},send:function(t,e,i,s){this.p=this._buildParams(i,s),this._send(t,e)},complete:function(t,e){this._complete(t,e)},setImage:function(t){this.p.input||(this.$image&&this.$image.remove(),this.$remove&&this.$remove.remove(),""===t?this.$placeholder.show():(this.$placeholder.hide(),this._buildImage(t),this.p.remove&&this._buildRemove()))},_build:function(t,e,i){this.p=this._buildParams(e,i),this.$element=this.dom(t),"INPUT"===this.$element.get().tagName?this._buildByInput():this._buildByBox()},_buildImage:function(t){this.$image=this.dom("<img>"),this.$image.attr("src",t),this.$box.append(this.$image),!1===this.p.input&&(this.$box.off("click."+this.eventname),this.$image.on("click."+this.eventname,this._click.bind(this)))},_buildRemove:function(){this.$remove=this.dom("<span>"),this.$remove.addClass(this.prefix+"-upload-remove"),this.$remove.on("click",this._removeImage.bind(this)),this.$box.append(this.$remove)},_buildParams:function(t,e){return t=l.extend(!0,this.defaults,t),e&&(t.trigger=e),t},_buildByInput:function(){this.$input=this.$element,this.p.box?(this._buildBox(),this._buildPlaceholder()):this.p.input=!0,this._buildAccept(),this._buildMultiple(),this._buildEvents()},_buildByBox:function(){this._buildInput(),this._buildAccept(),this._buildMultiple(),this._buildBox(),this._buildPlaceholder(),this._buildEvents()},_buildBox:function(){this.$box=this.dom("<div>").addClass(this.prefix+"-form-upload-box"),this.$element.before(this.$box),!1===this.p.cover&&this.$box.addClass(this.prefix+"-form-upload-cover-off"),this.p.hidden&&this.$element.hide()},_buildPlaceholder:function(){this.p.placeholder&&(this.$placeholder=this.dom("<span>").addClass(this.prefix+"-form-upload-placeholder"),this.$placeholder.html(this.p.placeholder),this.$box.append(this.$placeholder))},_buildInput:function(){this.$input=this.dom("<input>"),this.$input.attr("type","file"),this.$input.attr("name",this._getUploadParam()),this.$input.hide(),this.$element.before(this.$input)},_buildAccept:function(){if("image"===this.p.type){var t=this.opts.image.types.join(",");this.$input.attr("accept",t)}},_buildMultiple:function(){"image"===this.p.type&&(this.p.multiple?this.$input.attr("multiple","multiple"):this.$input.removeAttr("multiple"))},_buildEvents:function(){this.$input.on("change."+this.eventname+"-"+this.uuid,this._change.bind(this)),!1===this.p.input&&(this.$box.on("click."+this.eventname,this._click.bind(this)),this.$box.on("drop."+this.eventname,this._drop.bind(this)),this.$box.on("dragover."+this.eventname,this._dragover.bind(this)),this.$box.on("dragleave."+this.eventname,this._dragleave.bind(this)))},_buildData:function(t,e,i){if("single"===this.p.multiple)i.append(t,e[0]);else if(this.p.multiple)for(var s=0;s<e.length;s++)i.append(t+"[]",e[s]);else i.append(t+"[]",e[0]);return i},_removeImage:function(t){t&&(t.preventDefault(),t.stopPropagation()),this.$image&&this.$image.remove(),this.$remove&&this.$remove.remove(),this.$placeholder.show(),!1===this.p.input&&this.$box.on("click."+this.eventname,this._click.bind(this)),t&&this.app.api(this.p.remove,t)},_getUploadParam:function(){return this.p.name},_click:function(t){t.preventDefault(),this.$input.click()},_change:function(t){this._send(t,this.$input.get().files)},_drop:function(t){t.preventDefault(),this._send(t)},_dragover:function(t){return t.preventDefault(),this._setStatus("hover"),!1},_dragleave:function(t){return t.preventDefault(),this._removeStatus(),!1},_setStatus:function(t){!this.p.input&&this.p.box&&(this._removeStatus(),this.$box.addClass(this.prefix+"-form-upload-"+t))},_removeStatus:function(){if(!this.p.input&&this.p.box)for(var t=["hover","error"],e=0;e<t.length;e++)this.$box.removeClass(this.prefix+"-form-upload-"+t[e])},_send:function(t,e){e=e||t.dataTransfer.files;var i=new FormData,s=this._getUploadParam();i=this._buildData(s,e,i),i=this.app.utils.extendData(i,this.p.data),this._sendData(t,e,i)},_sendData:function(e,i,s){"function"==typeof this.p.url?this.p.url.call(this.app,this,{data:s,files:i,e:e}):(this.app.progress.show(),this.ajax.post({url:this.p.url,data:s,before:function(t){if(this.app.broadcast("upload.before.send",{xhr:t,data:s,files:i,e:e}).isStopped())return this.app.progress.hide(),!1}.bind(this),success:function(t){this._complete(t,e)}.bind(this),error:function(t){this._complete(t,e)}.bind(this)}))},_complete:function(t,e){t&&t.error?(this._setStatus("error"),this.p.error&&(this.app.broadcast("upload.error",{response:t}),this.app.api(this.p.error,t,e))):(this._removeStatus(),this._trigger(t),this.p.success&&(this.app.broadcast("upload.complete",{response:t}),this.app.api(this.p.success,t,e))),setTimeout(function(){this.app.progress.hide()}.bind(this),500)},_trigger:function(t){if(this.p.trigger&&t&&t.url){var e=this.p.trigger.instance;e[this.p.trigger.method].call(e,t.url)}}}),h.add("module","utils",{isMobile:function(){return/(iPhone|iPad|iPod|Android)/.test(navigator.userAgent)},createInvisibleChar:function(){return document.createTextNode(this.opts.markerChar)},searchInvisibleChars:function(t){return t.search(/^\uFEFF$/g)},removeInvisibleChars:function(t){return t.replace(/\uFEFF/g,"")},wrap:function(t,e){var i=this.dom("<div>").html(t);return e(i),t=i.html(),i.remove(),t},extendArray:function(t,e){if(t=t.concat(t),e)for(var i=0;i<e.length;i++)t.push(e[i]);return t},removeFromArrayByValue:function(t,e){var i;e=Array.isArray(e)?e:[e];for(var s=0;s<e.length;s++)-1<(i=t.indexOf(e[s]))&&t.splice(i,1);return t},sumOfArray:function(t){return t.reduce(function(t,e){return parseInt(t)+parseInt(e)},0)},getObjectIndex:function(t,e){return Object.keys(t).indexOf(e)},insertToObject:function(s,n,a,o){return Object.keys(a).reduce(function(t,e,i){return i===o&&(t[s]=n),t[e]=a[e],t},{})},getRandomId:function(){for(var t="",e="abcdefghijklmnopqrstuvwxyz0123456789",i=0;i<12;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},escapeRegExp:function(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")},capitalize:function(t){return(t=t.toLowerCase()).charAt(0).toUpperCase()+t.slice(1)},extendData:function(t,e){for(var i in e)t="elements"===i?this._extendDataElements(t,e[i]):this._setData(t,i,e[i]);return t},_extendDataElements:function(n,t){return this.dom(t).each(function(t){if("FORM"===t.get().tagName){var e=t.serialize(!0);for(var i in e)n=this._setData(n,i,e[i])}else{var s=t.attr("name")?t.attr("name"):t.attr("id");n=this._setData(n,s,t.val())}}.bind(this)),n},_setData:function(t,e,i){return t instanceof FormData?t.append(e,i):t[e]=i,t}}),h.add("module","offset",{get:function(t){t=this._getEl(t);var e=this.app.editor.getWinNode().getSelection(),i=!1;if(e&&0<e.rangeCount){var s=e.getRangeAt(0);if(t.contains(e.anchorNode)){var n=s.cloneRange();n.selectNodeContents(t),n.setEnd(s.startContainer,s.startOffset);var a=n.toString().length;i={start:a,end:a+s.toString().length}}}return i},set:function(t,e){!1===e&&(e={start:0,end:0}),t=this._getEl(t);var i,s=0,n=this.app.editor.getDocNode().createRange(),a=[t],o=!1,r=!1;for(n.setStart(t,0),n.collapse(!0);!r&&(i=a.pop());)if(3===i.nodeType){var h=s+i.length;!o&&e.start>=s&&e.start<=h&&(n.setStart(i,e.start-s),o=!0),o&&e.end>=s&&e.end<=h&&(n.setEnd(i,e.end-s),r=!0),s=h}else for(var l=i.childNodes.length;l--;)a.push(i.childNodes[l]);this.app.selection.setRange(n)},_getEl:function(t){return t?this.dom(t).get():this.app.editor.getLayout().get()}}),h.add("module","caret",{set:function(t,e){var i=this.dom(t).get(),s=this.app.editor.getDocNode().createRange();i&&this._isInPage(i)&&(this.app.editor.setWinFocus(),this._isInline(i)&&this._isNon(i)&&("start"===e?e="before":"end"===e&&(e="after")),this[{start:"_setStart",end:"_setEnd",before:"_setBefore",after:"_setAfter"}[e]](s,i),this.app.selection.setRange(s))},is:function(t,e,i,s,n){var a=this.dom(t).get(),o=this.app.editor.getWinNode().getSelection(),r=!1;if(!a||!o.isCollapsed)return r;var h=this._getPosition(a,s,n),l=this._getSize(a,i,s);return"end"===e?r=h===l:"start"===e&&(r=0===h),r},_setStart:function(t,e){t.setStart(e,0),t.collapse(!0);var i=this._getInlineInside(e);i&&(t=this._setStartInline(t,i)),this._isInline(e)&&this._insertInvisibleNode(t)},_setStartInline:function(t,e){var i=this.app.element.getAllInlines(e)[0];t.selectNodeContents(i),t.collapse(!0)},_setEnd:function(t,e){var i=1===e.nodeType&&e.lastChild;i&&this._isInline(i)&&(e=i),t.selectNodeContents(e),t.collapse(!1)},_setBefore:function(t,e){t.setStartBefore(e),t.collapse(!0),this._isInline(e)&&this._insertInvisibleNode(t,e)},_setAfter:function(t,e){t.setStartAfter(e),t.collapse(!0);var i=3!==e.nodeType&&e.tagName.toLowerCase();!this._isInline(e)&&"br"!==i&&"svg"!==i||this._insertInvisibleNode(t)},_insertInvisibleNode:function(t,e){var i=this.app.utils.createInvisibleChar();return e?e.parentNode.insertBefore(i,e):t.insertNode(i),t.selectNodeContents(i),t.collapse(!1),i},_getInlineInside:function(t){var e=t.firstChild;if(this._isInline(e)){for(var i=e.firstChild;i;){if(this._isInline(i))return i;i=i.firstChild}return e}},_getSize:function(t,e,i){var s,n=3===t.nodeType;if(e&&0!==e.length){var a=this.dom(t).clone();a.find(e.join(",")).remove(),s=a.html().trim()}else s=n?t.textContent:t.innerHTML,s=n||!1===i?s:s.trim();return this._trimmed(s,n,i).length},_getPosition:function(t,e,i){var s=this.app.editor.getWinNode().getSelection().getRangeAt(0),n=s.cloneRange(),a=document.createElement("div"),o=3===t.nodeType;n.selectNodeContents(t),n.setEnd(s.endContainer,s.endOffset),a.appendChild(n.cloneContents());var r=o||!1===e?a.innerHTML:a.innerHTML.trim(),h=-1!==r.search(/<\/?br\s?\/?>$/g)?1:0;return!1===i&&(h=0),(r=this._trimmed(r,o,e)).length+h},_trimmed:function(t,e,i){return!1===i?t=t.replace(/\n$/g,""):(""===(t=(t=(t=this.app.utils.removeInvisibleChars(t)).replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,"")).replace(/\s+/g," "))||e||(t=t.replace(/\s$/,"")),t)},_isInline:function(t){return this.app.element.is(t,"inline")},_isInPage:function(t){var e=!1,i=this.app.editor.getDocNode();return t&&t.nodeType&&(e=t!==i.body&&i.body.contains(t)),e},_isNon:function(t){return"false"===t.getAttribute("contenteditable")}}),h.add("module","popup",{init:function(){this.stack=!1,this.stacks=[],this.name=!1,this.supername=!1,this.autoclose=!0,this.control=!1,this.saved=!1},start:function(){this._build(),this._buildDepth()},stop:function(){this._stopEvents(),this._stop()},stopStack:function(){this._stopEvents(),this.app.toolbar.unsetToggled(),this.$popup.removeAttr("data-"+this.prefix+"-popup-name"),this.$popup.removeClass("open")},isOpen:function(t){var e=this.$popup.hasClass("open");return t?this._getName()===t&&e:e},create:function(t,e){return this.isOpen(t)||(this._reset(),this.name=t,this.supername=t,this.stack=this._createStack(t,e)),this.stack},add:function(t,e){return this._createStack(t,e,!0)},setStack:function(t){this.stack=t,this.name=t.getName()},setData:function(t){this.stack.setData(t)},setFocus:function(t){this.stack.setFocus(t)},setWidth:function(t){this.stack.setWidth(t)},getName:function(){return this.name},getElement:function(){return this.$popup},getButton:function(){return this.button},getStack:function(t){return t?this.stacks[t]:this.stack},getBody:function(){return this.stack.getBody()},getItems:function(){return this.stack.getItems()},getFooter:function(){return this.stack.getFooter()},getFooterPrimary:function(){return this.stack.getFooterPrimary()},getTool:function(t){return this.stack.getTool(t)},getInput:function(t){return this.stack.getInput(t)},getFormItem:function(t){return this.stack.getFormItem(t)},getData:function(t){return this.stack.getData(t)},open:function(t){this.isOpen()?this.isOpen(this.supername)?(this.saved=!0,this.close(!1)):(this.saved=!0,this.close(!1),this._open(t,!1)):(this.saved=!1,this._open(t))},openStack:function(t){var e=this.getStack(t),i={};this.stack&&this.stack.isCollapsed()&&(i={collapse:!0},this.removeStack(this.stack)),e.open(i)},close:function(t,e){if(!1===this.autoclose)if(!0===t);else if(!e)return;this.isOpen()&&(t&&this._isPopupTarget(t)||(this._stopEvents(),this._resetToolbarToggledButton(),!1!==t&&!1===this.saved&&(this.app.scroll.save(),this.app.selection.restore(),this.app.scroll.restore()),this.$popup.hide(),this._closed()))},closeStacks:function(){for(var t in this.stacks)"object"==typeof this.stacks[t]&&this.stacks[t].close()},removeStack:function(t){var e=t.getName();delete this.stacks[e],this.$popup.find("[data-"+this.prefix+"-stack-name="+e+"]").remove()},updatePosition:function(t){this._buildPosition(t),this._buildHeight()},resize:function(){var t=this.$popup.attr("data-width"),e=this.app.editor.getWidth();if("100%"!==t&&parseInt(t)<e)return;this.$popup.css("width",e+"px")},_build:function(){this.$popup=this.dom("<div>").addClass(this.prefix+"-popup "+this.prefix+"-popup-"+this.uuid),this.$popup.hide(),this.$popup.attr("dir",this.opts.editor.direction),this.app.$body.append(this.$popup)},_buildDepth:function(){this.opts.bsmodal&&this.$popup.css("z-index",1061)},_buildButton:function(t){t&&(this.button=!!Object.prototype.hasOwnProperty.call(t,"button")&&t.button)},_buildControl:function(t){t&&(this.control=!!Object.prototype.hasOwnProperty.call(t,"control")&&t.control)},_buildName:function(){this.$popup.attr("data-"+this.prefix+"-popup-name",this.name),this.$popup.addClass(this.prefix+"-popup-"+this.name)},_buildHeader:function(){this.header=this.app.create("popup.header",this)},_buildHeight:function(){var t,e=this.app.scroll.getTarget(),i=this.$popup.offset(),s=(this.app.scroll.isTarget()?(t=i.top-e.offset().top,e.height()-parseInt(e.css("border-bottom-width"))):(t=i.top-e.scrollTop(),e.height()))-t-10;this.$popup.css("max-height",s+"px")},_buildPosition:function(){var t;t=this._isButton()&&this.button.isControl()||this._isControl()?this._buildPositionControl():this._isButton()?this._buildPositionButton():this._buildPositionModal(),this.$popup.css({top:t.top-1+"px",left:t.left+"px"})},_buildPositionButton:function(){var t=this.app.editor.getRect(),e=this.button.getOffset(),i=this.button.getDimension(),s=this.$popup.width(),n={};return this._isToolbarButton()||this._isTopbarButton()?(n={top:e.top+i.height,left:e.left}).left+s>t.right&&(n.left=e.left+i.width-s):(n={top:e.top+t.top+i.height,left:e.left+t.left+i.width/2-s/2}).left+s>t.right&&(n.left=t.left+t.width-s),(n.left<t.left||n.left<0)&&(n.left=t.left),n},_buildPositionControl:function(){var t=this.app.block.get();t.isSecondLevel()&&(t=t.getFirstLevel());var e=t.getBlock().offset();return{top:e.top,left:e.left}},_buildPositionModal:function(){var t,e,i;if(this.opts.toolbar){var s=this.app.container.get("toolbar"),n=s.height();e=(t=s.offset()).top+n,i=t.left}else{var a=this.app.block.get();a.isSecondLevel()&&(a=a.getFirstLevel()),e=(t=a.getBlock().offset()).top,i=t.left}return{top:e,left:i}},_getName:function(){return this.$popup.attr("data-"+this.prefix+"-popup-name")},_setToolbarToggledButton:function(){if(this.app.toolbar.unsetToggled(),this._isToolbarButton()){var t=this.button.getName();this.app.toolbar.setToggled(t)}},_createStack:function(t,e,i){Object.prototype.hasOwnProperty.call(e,"collapse")&&!1===e.collapse&&(i=!1),Object.prototype.hasOwnProperty.call(e,"autoclose")&&(this.autoclose=e.autoclose);var s=this.app.create("popup.stack",t,e,i,this);return this.stacks[t]=s},_open:function(t,e){this._buildButton(t),this._buildControl(t),this._buildName(),this._buildHeader(),this.app.broadcast("popup.before.open").isStopped()?this.stopStack():(this._setToolbarToggledButton(),this._startEvents(),!1!==e&&this.app.editor.isPopupSelection()&&this.app.selection.save(),this.stack=this._findActiveStack(),this.stack.open(t,!1,!1),this._buildPosition(),!1===e?(this.$popup.show(),this._opened()):this.$popup.fadeIn(100,this._opened.bind(this)))},_opened:function(){this._buildHeight(),this.$popup.addClass("open"),this.app.broadcast("popup.open"),this.stack.renderFocus()},_closed:function(){var t="data-"+this.prefix+"-popup-name",e=this.$popup.attr(t);this.$popup.removeAttr(t),this.$popup.removeClass("open "+this.prefix+"-popup-"+e),this.saved=!1,this.app.broadcast("popup.close")},_isPopupTarget:function(t){return 0!==this.dom(t.target).closest("."+this.prefix+"-popup").length},_isButton:function(){return this.button},_isControl:function(){return this.control},_isToolbarButton:function(){return this.button&&("toolbar"===this.button.type||"context"===this.button.type)},_isTopbarButton:function(){return this.button&&"topbar"===this.button.type},_findActiveStack:function(){for(var t in this.stacks)"object"==typeof this.stacks[t]&&this.stacks[t].isActive()&&(this.stack=this.stacks[t]);return this.stack},_reset:function(){this.button=!1,this.control=!1,this.autoclose=!0,this.stack=!1,this.stacks=[],this.$popup.html(""),this.$popup.removeClass("has-footer has-items has-form")},_resetToolbarToggledButton:function(){if(this.button){var t=this.button.getName();this.app.toolbar.unsetToggled(t)}},_startEvents:function(){var t=this.prefix+"-popup";this.app.scroll.getTarget().on("resize."+t+" scroll."+t,this.updatePosition.bind(this))},_stopEvents:function(){this.app.scroll.getTarget().off("."+this.prefix+"-popup")},_stop:function(){this.$popup&&this.$popup.remove()}}),h.add("class","popup.stack",{defaults:{active:!1,title:!1,type:!1,width:!1,setter:!1,getter:!1,builder:!1,observer:!1,instance:!1,collapse:!1,form:!1,items:!1,focus:!1,footer:!1},init:function(t,e,i,s){this.defaultWidth="240px",this.popup=s,this.name=t,this.tools={},this.data=!1,this.items=!1,this.formitems=!1,this.params=l.extend({},!0,this.defaults,e),i&&(this.params.collapse=!0),this._build(),this._observe()},set:function(t,e){this.params[t]=e},setData:function(t){this.data=t},setFocus:function(t){void 0!==this.tools[t]&&this.tools[t].setFocus()},setWidth:function(t){var e=this.app.popup.getElement();e.attr("data-width",t),"100%"===t&&(t=this.app.editor.getWidth()+"px"),e.css("width",t),this.app.$win.on("resize."+this.prefix+"-popup-"+this.uuid,this.popup.resize.bind(this.popup)),this.popup.resize()},setItemsData:function(t){this.items=t},get:function(t){return this.params[t]},getElement:function(){return this.$stack},getName:function(){return this.name},getBody:function(){return this.$body},getInstance:function(){return this.get("instance")},getItemsData:function(){return this.items},getItems:function(){return this.$items},getFooter:function(){return this.$footer},getFooterPrimary:function(){return this.$footer.find("."+this.prefix+"-form-button-primary")},getTool:function(t){return void 0!==this.tools[t]&&this.tools[t]},getInput:function(t){var e=this.getTool(t);return e?e.getInput():this.dom()},getFormItem:function(t){var e=this.getTool(t);return e?e.getInput().closest("."+this.prefix+"-form-item"):this.dom()},getData:function(t){var e;if(t)void 0!==this.tools[t]&&(e=this.tools[t].getValue());else for(var i in e={},this.tools)e[i]=this.tools[i].getValue();return e},hasForm:function(){return this.formitems},hasFooter:function(){return 0!==this.footerbuttons},hasItems:function(){return!1!==this.items},isCollapsed:function(){return this.get("collapse")},isActive:function(){return this.get("active")},open:function(t,e,i){if((t&&t.focus&&this.set("focus",t.focus),this.popup.closeStacks(),this.app.popup.setStack(this),!1!==i)&&this.app.broadcast("popup.before.open").isStopped())return void this.popup.stopStack();t&&t.collapse?(this._buildItems(),this._renderItems()):this.render(),this.popup.header.render(this.popup.stacks),this.popup.header.setActive(this),this.$stack.show(),this._renderWidth(),!1!==e&&this.renderFocus(),!1!==i&&this.app.broadcast("popup.open")},close:function(){this.$stack.hide()},collapse:function(){var t=this._getPrev();this.isCollapsed()&&this.popup.removeStack(this),t.open({collapse:!0})},render:function(){this._renderType(),this._renderItems(),this._renderForm(),this._renderFooter(),this._renderEnv()},renderFocus:function(){this.get("focus")&&this.setFocus(this.get("focus"))},_observe:function(){this.params.observer&&this.app.api(this.params.observer,this)},_getPrev:function(){var t;for(var e in this.popup.stacks){if(e===this.name)return t;t=this.popup.stacks[e]}},_build:function(){this._buildElement(),this._buildBody(),this._buildFooter(),this._buildParams()},_buildElement:function(){this.$stack=this.dom("<div>").addClass(this.prefix+"-popup-stack "+this.prefix+"-popup-stack-"+this.name),this.$stack.hide(),this.$stack.attr("data-"+this.prefix+"-stack-name",this.name),this.popup.getElement().append(this.$stack)},_buildBody:function(){this.$body=this.dom("<div>").addClass(this.prefix+"-popup-body"),this.$stack.append(this.$body)},_buildFooter:function(){this.$footer=this.dom("<div>").addClass(this.prefix+"-popup-footer"),this.$stack.append(this.$footer)},_buildParams:function(){this.params.width=this.params.width?this.params.width:this.defaultWidth,this.params.setter=!!this.params.setter&&this.params.setter,this.params.getter=!!this.params.getter&&this.params.getter,this.data=!!this.params.getter&&this.app.api(this.params.getter,this),this._buildItems()},_buildItems:function(){this.params.builder?this.items=this.app.api(this.params.builder,this):this.params.items&&(this.items=this.params.items)},_renderWidth:function(){this.setWidth(this.get("width"))},_renderType:function(){this.$stack.removeClass(this.prefix+"-popup-type-grid");var t=this.get("type");t&&this.$stack.addClass(this.prefix+"-popup-type-"+t)},_renderItems:function(){if(this.items)for(var t in this.$items?this.$items.html(""):(this.$items=this.dom("<div>").addClass(this.prefix+"-popup-items"),this.$body.append(this.$items)),this.items){if(Object.prototype.hasOwnProperty.call(this.items[t],"observer")&&this.items[t].observer){var e=this.app.api(this.items[t].observer,this.items[t],t,this);void 0!==e&&(this.items[t]=e)}if(!1!==this.items[t]){var i=this.app.create("popup.item",this,t,this.items[t]).getElement();this._renderItemPosition(this.$items,i,this.items[t])}}},_renderItemPosition:function(t,e,i){if(i.position){var s=i.position;if("first"===s)t.prepend(e);else if("object"==typeof s){var n=Object.prototype.hasOwnProperty.call(s,"after")?"after":"before",a=s[n],o=this._findPositionElement(a,t);o?o[n](e):t.append(e)}}else t.append(e)},_renderEnv:function(){var t=this.popup.getElement();t.removeClass("has-footer has-items has-form"),this.hasForm()&&t.addClass("has-form"),this.hasFooter()&&t.addClass("has-footer"),this.hasItems()&&t.addClass("has-items")},_renderForm:function(){this.formitems=this.get("form"),this.formitems&&(this.$form?this.$form.html(""):(this.$form=this.dom("<form>").addClass(this.prefix+"-popup-form"),this.$body.append(this.$form),this.$form.on("submit",function(){return!1})),this._renderTools(),this._renderData(),this.$form.find("input[type=text],input[type=url],input[type=email]").on("keydown."+this.prefix+"-popup",function(t){if(13===t.which)return t.preventDefault(),this.app.popup.close(),!1}.bind(this)))},_renderTools:function(){for(var t in this.formitems)this._renderTool(t,this.formitems[t])},_renderTool:function(t,e){var i=this.app.create("tool."+e.type,t,e,this,this.data),s=i.getElement();s&&(this.tools[t]=i,this.$form.append(s))},_renderData:function(){if(this.data)for(var t in this.data)void 0!==this.tools[t]&&this.tools[t].setValue(this.data[t])},_renderFooter:function(){this.footerbuttons=0;var t=this.get("footer");if(t)for(var e in this.$footer.html(""),t)if(!1!==t[e]){var i=this.app.create("popup.button",e,this,t[e]);this.$footer.append(i.getElement()),this.footerbuttons++}},_findPositionElement:function(t,e){var i;if(Array.isArray(t))for(var s=0;s<t.length&&0===(i=e.find("[data-name="+t[s]+"]")).length;s++);else i=e.find("[data-name="+t+"]");return 0!==i.length?i:0}}),h.add("class","popup.header",{init:function(t){this.popup=t,this._build()},setActive:function(t){this.$headerbox.find("."+this.prefix+"-popup-header-item").removeClass("active"),this.$headerbox.find("[data-"+this.prefix+"-name="+t.getName()+"]").addClass("active")},render:function(t){this._reset(),0<this._buildItems(t)&&this._buildClose()},_build:function(){this.$header=this.dom("<div>").addClass(this.prefix+"-popup-header"),this.$headerbox=this.dom("<div>").addClass(this.prefix+"-popup-header-box"),this.$header.append(this.$headerbox),this.popup.getElement().prepend(this.$header)},_buildClose:function(){var t=this.dom("<span>").addClass(this.prefix+"-popup-close");t.one("click",this._catchClose.bind(this)),this.$header.append(t)},_buildItems:function(t){var e=Object.keys(t).length,i=0,s=0;for(var n in t)if("object"==typeof t[n]){s++;var a=t[n].get("title");a?(i++,this._buildItem(t[n],a,e)):1===s&&1<e&&(i++,this._buildItem(t[n],"## popup.back ##",e))}return i},_buildItem:function(t,e,i){var s=1<i,n=s?this.dom("<a>").attr("href","#"):this.dom("<span>");s&&(n.dataset("stack",t),n.addClass(this.prefix+"-popup-header-item-link"),n.on("click",this._catchStack.bind(this))),n.attr("data-"+this.prefix+"-name",t.getName()),n.addClass(this.prefix+"-popup-header-item"),n.html(this.lang.parse(e)),this.$headerbox.append(n)},_reset:function(){this.$headerbox.html(""),this.$header.find("."+this.prefix+"-popup-close").remove()},_catchStack:function(t){t.preventDefault(),t.stopPropagation();var e=this.dom(t.target).dataget("stack"),i=this.app.popup.getStack();i.isCollapsed()&&this.app.popup.removeStack(i),e.open()},_catchClose:function(t){t.preventDefault(),t.stopPropagation(),this.popup.close()}}),h.add("class","popup.button",{init:function(t,e,i){this.name=t,this.obj=i,this.popup=e,this.$button=this.dom("<button>").addClass(this.prefix+"-form-button"),this.$button.attr("data-name",this.name),this.$button.html(this.lang.parse(this.obj.title)),this.$button.dataset("instance",this),this._has("type")&&this.$button.addClass(this.prefix+"-form-button-"+this.obj.type),this._has("classname")&&this.$button.addClass(this.obj.classname),this._has("fullwidth")&&this.$button.addClass(this.prefix+"-form-button-fullwidth"),this._has("right")&&this.$button.addClass(this.prefix+"-form-button-push-right"),this.$button.on("click."+this.prefix+"-popup-button"+this.uuid,this._catch.bind(this))},getName:function(){return this.name},getElement:function(){return this.$button},invokeCommand:function(){this._invoke()},_has:function(t){return Object.prototype.hasOwnProperty.call(this.obj,t)},_catch:function(t){t.preventDefault(),t.stopPropagation(),this._has("command")?this._invoke(t):this._has("close")&&this.app.popup.close()},_invoke:function(t){this.app.api(this.obj.command,this.popup,this.name,t)}}),h.add("class","popup.item",{defaults:{container:!1,title:!1,html:!1,toggle:!0,active:!1,divider:!1,remover:!1,classname:!1,params:!1,instance:!1,observer:!1,command:!1},init:function(t,e,i){this.popup=t,this.name=e,this.params=this._buildParams(i),this._build(),this._buildContainer(),this._buildIcon(),this._buildTitle(),this._buildImage(),this._buildShortcut(),this._buildActive(),this._buildHidden(),this._buildDivider(),this._buildCommand(),this._buildRemover()},getPopup:function(){return this.popup},getName:function(){return this.name},getParams:function(){return this.params.params},getElement:function(){return this.$item},getInstance:function(){return this.params.instance},isControl:function(){return this.params.control},_build:function(){this.$item=this.params.html?this.dom(this.params.html):this.dom("<div>"),this.$item.addClass(this.prefix+"-popup-item "+this.prefix+"-popup-stack-item"),this.$item.attr({"data-name":this.name})},_buildContainer:function(){this.params.container&&this.$item.addClass(this.prefix+"-popup-item-container")},_buildTitle:function(){this.params.title&&(this.$title=this.dom("<span>").addClass(this.prefix+"-popup-item-title"),this.$title.html(this.lang.parse(this.params.title)),this.$item.append(this.$title))},_buildImage:function(){this.params.image&&(this.$image=this.dom("<span>").addClass(this.prefix+"-popup-item-image"),this.$image.html(this.params.image),this.$item.append(this.$image))},_buildIcon:function(){this.params.icon&&(this.$icon=this.dom("<span>").addClass(this.prefix+"-popup-item-icon"),this.opts.buttons.icons&&void 0!==this.opts.buttons.icons[this.name]?this.$icon.html(this.opts.buttons.icons[this.name]):!0===this.params.icon?this.$icon.addClass(this.prefix+"-icon-"+this.name):-1!==this.params.icon.search(/</)?this.$icon.html(this.params.icon):this.$icon.addClass(this.prefix+"-icon-"+this.params.icon),this.$item.append(this.$icon))},_buildShortcut:function(){if(this.params.shortcut){var t=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)?"<b>&#8984;</b>":"ctrl";t=this.params.shortcut.replace("Ctrl",t),this.$shortcut=this.dom("<span>").addClass(this.prefix+"-popup-item-shortcut"),this.$shortcut.html(t),this.$item.append(this.$shortcut)}},_buildParams:function(t){return l.extend({},!0,this.defaults,t)},_buildActive:function(){this.params.active&&this.$item.addClass("active")},_buildHidden:function(){this.params.hidden&&this.$item.addClass(this.prefix+"-popup-item-hidden")},_buildDivider:function(){this.params.divider&&this.$item.addClass(this.prefix+"-popup-item-divider-"+this.params.divider)},_buildCommand:function(){this.params.command&&(this.$item.on("click."+this.prefix+"-popup-item-"+this.uuid,this._catch.bind(this)),this.$item.attr("data-command",this.params.command))},_buildRemover:function(){if(this.params.title&&this.params.remover){var t=this.dom("<span>").addClass(this.prefix+"-popup-item-trash "+this.prefix+"-icon-trash");t.attr("data-command",this.params.remover),t.on("click."+this.prefix+"-popup-item-"+this.uuid,this._catchRemover.bind(this)),this.$item.append(t)}},_catchRemover:function(t){t.preventDefault(),t.stopPropagation();var e=this.dom(t.target).closest("."+this.prefix+"-popup-stack-item"),i=this.dom(t.target).closest("."+this.prefix+"-popup-item-trash").attr("data-command"),s=e.attr("data-name");this.app.api(i,this,s),e.fadeOut(200,function(t){t.remove()})},_catch:function(t){t.preventDefault(),t.stopPropagation();var e=this.dom(t.target).closest("."+this.prefix+"-popup-stack-item"),i=e.attr("data-name"),s=e.attr("data-command");this.popup.$items.find("."+this.prefix+"-popup-stack-item").removeClass("active"),this.params.toggle&&e.addClass("active"),this.app.api(s,this.getParams(),this,i,t)}}),h.add("module","container",{init:function(){this.blurclass=this.prefix+"-in-blur",this.focusclass=this.prefix+"-in-focus"},start:function(){this._buildMain(),this._buildContainers(this.$main,this.opts.containers.main),this._buildBSModal()},stop:function(){this.$main.remove()},get:function(t){return this["$"+t]},setFocus:function(){this.$main.removeClass(this.blurclass).addClass(this.focusclass)},setBlur:function(){this.$main.removeClass(this.focusclass).addClass(this.blurclass)},isFocus:function(){return this.$main.hasClass(this.focusclass)},_buildMain:function(){this.$main=this.dom("<div>").attr(this.prefix+"-uuid",this.uuid),this.$main.addClass(this.prefix+"-container "+this.prefix+"-container-"+this.uuid),this.app.$element.html(""),this.app.$element.append(this.$main)},_buildContainers:function(t,e){for(var i=0;i<e.length;i++){var s=e[i],n="$"+s;this[n]=this._createContainer(s),void 0!==this.opts.containers[s]&&this._buildContainers(this[n],this.opts.containers[s]),t.append(this[n])}},_buildBSModal:function(){this.opts.bsmodal=0!==this.$main.closest(".modal-dialog").length},_createContainer:function(t){return this.dom("<div>").addClass(this.prefix+"-"+t+"-container")}}),h.add("module","source",{init:function(){},start:function(){this._build()},stop:function(){this.$source.off("."+this.prefix+"-source-events"),this.$source.remove()},toggle:function(){this.app.editor.isSourceMode()?this.close():this.open()},open:function(){this.app.broadcast("source.before.open");var t=this.app.editor.getTemplate();t=this.app.content.decodeVarsEntities(t),t=this.app.tidy.parse(t);var e=this.app.container.get("editor").height();this.opts.editor.viewOnly&&this.$source.attr("readonly",!0),this.$source.height(e),this.$source.val(t),this.$source.on("input."+this.prefix+"-source-events",this._handleChanges.bind(this)),this.$source.on("keydown."+this.prefix+"-source-events",this.app.input.handleTextareaTab.bind(this)),this.app.container.get("editor").hide(),this.app.container.get("source").show(),this.app.popup.close(),this.app.control.close(),this.app.path.disable(),this.app.toolbar.setToggled("code"),this.app.toolbar.disableButtons(["code"]),this.app.broadcast("source.open")},close:function(){this.app.broadcast("source.before.close");var t=this.$source.val();this.app.editor.setTemplate(t),this.$source.off("."+this.prefix+"-source-events"),this.app.container.get("source").hide(),this.app.container.get("editor").show(),this.app.path.enable(),this.app.toolbar.unsetToggled("code"),this.app.toolbar.enableButtons(),this.app.broadcast("source.close")},checkCodeView:function(t){return!!this.opts.source&&t},_build:function(){this.$source=this.dom("<textarea>"),this.$source.addClass(this.prefix+"-source"),this.$source.attr("data-gramm_editor",!1),this.app.container.get("source").append(this.$source)},_handleChanges:function(t){this.app.broadcast("source.change",{e:t})}}),h.add("module","toolbar",{subscribe:{"editor.load":function(){this.build()}},init:function(){this.eventname=this.prefix+"-toolbar",this.activeClass="active",this.toggledClass="toggled",this.disableClass="disable",this.customButtons={}},start:function(){this._build(),this._buildSticky()},stop:function(){this.$toolbar.remove(),this.customButtons={}},rebuild:function(){this.build()},build:function(){this.$toolbar.html(""),this._buildButtons(),this.opts.editor.viewOnly&&this.removeAll(["mobile","code"])},isSticky:function(){var t=this.app.container.get("toolbar");return this.app.container.get("main").offset().top<t.offset().top},getElement:function(){return this.$toolbar},get:function(t){return this._findButton(t)},add:function(t,e){this.customButtons[t]=e},remove:function(t){this._findButton(t).remove()},removeAll:function(i){this._findButtons().each(function(t){var e=t.attr("data-name");-1===i.indexOf(e)&&t.remove()}.bind(this))},setActive:function(t){this.opts.toolbar&&(this._findButtons().removeClass(this.activeClass),this._findButton(t).removeClass(this.disableClass).addClass(this.activeClass))},setToggled:function(t){this.opts.toolbar&&(this._findButtons().removeClass(this.toggledClass),this._findButton(t).removeClass(this.disableClass).addClass(this.toggledClass))},unsetActive:function(t){this.opts.toolbar&&(t?this._findButton(t):this._findButtons()).removeClass(this.activeClass)},unsetToggled:function(t){this.opts.toolbar&&(t?this._findButton(t):this._findButtons()).removeClass(this.toggledClass)},disableButtons:function(i){this._findButtons().each(function(t){var e=t.attr("data-name");-1===i.indexOf(e)&&t.addClass(this.disableClass)}.bind(this))},enableButtons:function(){this._findButtons().removeClass(this.disableClass)},_build:function(){this.$toolbar=this.dom("<div>").addClass(this.prefix+"-toolbar");var t=this.app.container.get("toolbar");t.append(this.$toolbar),t.on("mouseover."+this.prefix,this._buildHover.bind(this))},_buildHover:function(){this.app.editor.unsetHover()},_buildSticky:function(){if(this.opts.toolbar.sticky){var t=this.app.container.get("toolbar");if(t.addClass(this.prefix+"-toolbar-sticky"),t.css("top",this.opts.toolbar.stickyTopOffset+"px"),this.app.scroll.isTarget())this.app.scroll.getTarget().on("scroll.revolvapp-toolbar",this._observeSticky.bind(this))}},_buildButtons:function(){var t=this.app.component.is()?this.app.component.get():this.app.editor.getBodyInstance(),e=t.toolbar;for(var i in e)t.isAllowedButton(e[i])&&this.app.create("button",i,e[i],this.$toolbar,"toolbar");for(var s in this.customButtons)t.isAllowedButton(this.customButtons[s])&&this.app.create("button",s,this.customButtons[s],this.$toolbar,"toolbar")},_observeSticky:function(){var t=this.app.scroll.getTarget(),e=this.app.container.get("toolbar"),i=parseInt(t.css("padding-top"));e.css("top",0-i+this.opts.toolbar.stickyTopOffset+"px")},_findButtons:function(){return this.$toolbar.find(".rex-button-toolbar")},_findButton:function(t){return this.$toolbar.find("[data-name="+t+"]")}}),h.add("module","path",{subscribe:{"editor.load":function(){this.build()}},init:function(){this.activeClass="active",this.disableClass="disable"},start:function(){this._build()},stop:function(){this.$path.remove()},build:function(){if(!this.opts.editor.viewOnly){this.$path.html("");var t=this.app.editor.getBodyInstance();if(this.app.component.is()){var e=this.app.component.get();this._buildBodyItem(t),this._buildParents(e),this._buildCurrent(e)}else this._buildBodyItem(t);this._setLastActive()}},get:function(){return this.$path},enable:function(){this._findItems().removeClass(this.disableClass)},disable:function(){this._findItems().addClass(this.disableClass)},_createItem:function(t){var e=this.app.lang.parse(t.getTitle()),i=this.dom("<a>").attr("href","#").html(e).addClass(this.prefix+"-path-item");return i.dataset("instance",t),i.on("click."+this.prefix+"-path",this._catch.bind(this)),i},_buildParents:function(t){var e=t.getElement(),i=this.app.element.getParents(e,this.opts._elements);i.nodes.reverse(),i.each(this._buildParentItem.bind(this))},_buildParentItem:function(t){var e=t.dataget("instance"),i=this._createItem(e);this.$path.append(i)},_buildBodyItem:function(t){var e=this._createItem(t);e.attr("data-body",!0),this.$path.append(e)},_buildCurrent:function(t){var e=this._createItem(t);this.$path.append(e)},_build:function(){this.$path=this.dom("<div>").addClass(this.prefix+"-path"),this.app.container.get("toolbar").append(this.$path)},_findItems:function(){return this.$path.find("."+this.prefix+"-path-item")},_setLastActive:function(){this._findItems().last().addClass(this.activeClass)},_catch:function(t){t.preventDefault(),t.stopPropagation();var e=this.dom(t.target);if(!e.hasClass(this.disableClass)){var i=e.dataget("instance");e.attr("data-body")?this.app.component.unset():this.app.component.set(i.getElement())}}}),h.add("module","control",{init:function(){this.instance=!1,this.customButtons={}},start:function(){this._build()},stop:function(){this.$control.remove(),this.instance=!1,this.customButtons={}},isOpen:function(){return"none"!==this.$control.css("display")},getElement:function(){return this.$control},get:function(t){return this._findButton(t)},add:function(t,e){this.customButtons[t]=e},remove:function(t){this._findButton(t).remove()},open:function(t){if(this.$control.html(""),this.instance=t,0<this._buildButtons()){var e=this.app.scroll.getTarget();this.updatePosition(),e.on("resize.revolvapp-control",this.updatePosition.bind(this)),e.on("scroll.revolvapp-control",this.updatePosition.bind(this)),this.app.editor.getWin().on("scroll.revolvapp-control",this.updatePosition.bind(this)),this.$control.show(),this.updatePosition()}else this.close()},close:function(){this.$control.hide(),this.instance=!1,this.app.scroll.getTarget().off(".revolvapp-control")},updatePosition:function(){if(this.instance){var t=this.instance.getOffset(),e=this.$control.width(),i=this.app.editor.getWin().scrollTop(),s=t.top-2-i,n=this.app.toolbar.getElement(),a=n.offset().top+n.height()-2,o=this.app.editor.getFrameRect();s<a||o.bottom<s?this.$control.hide():this.$control.show(),this.$control.css({top:s+"px",left:t.left-e-3+"px"})}},_buildButtons:function(){var t=this.instance.control,e=0;for(var i in t)"trash"===i&&this.instance.isUnremovable()||this.instance.isAllowedButton(t[i])&&(this.app.create("button",i,t[i],this.$control,"control"),e++);for(var s in this.customButtons)this.instance.isAllowedButton(this.customButtons[s])&&(this.app.create("button",s,this.customButtons[s],this.$control,"control"),e++);return e},_build:function(){this.$control=this.dom("<div>"),this.$control.addClass(this.prefix+"-control"),this.$control.hide(),this.opts.bsmodal&&this.$control.css("z-index",1060),this.app.$body.append(this.$control)},_findButton:function(t){return this.$control.find("[data-name="+t+"]")}}),h.add("module","observer",{init:function(){this.observer=!1,this.trigger=!0},stop:function(){this.observer&&this.observer.disconnect(),this.trigger=!0},build:function(){if(this.stop(),window.MutationObserver){var t=this.app.editor.$template.get();this.observer=this._build(t),this.observer.observe(t,{attributes:!0,subtree:!0,childList:!0,characterData:!0,characterDataOldValue:!0})}},sync:function(t){this._sync(t,!1)},_build:function(e){var i=this;return new MutationObserver(function(t){i._observe(t[t.length-1],e)})},_observe:function(t,e){if(this.trigger&&!("attributes"===t.type&&t.target===e||this.app.state.is())){var i=this.app.component.is(),s=this.app.component.get(),n="childList"===t.type&&i&&s.isEditable();this._sync(e,n)}},_sync:function(t,e){var i=e?300:0;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){this.app.state.add(t,e),this.app.autosave.send()}.bind(this),i),this.app.broadcast("editor.change")}}),h.add("module","component",{init:function(){this.instance=!1,this.items=this.app.create("component.items"),this.popups=this.app.create("component.popups")},set:function(t,e,i,s){var n=t.dataget("instance");!0===e||!this._isActive(t)||n.isEditable()||this.app.popup.isOpen()?(this.app.editor.unset(),this._setActiveInstance(n),this._setActiveClass(),this._setSourceActive(),!1!==s&&this.focus(),this.app.toolbar.build(),this.app.path.build(),this.app.control.open(n),this.app.popup.close(),!1!==i&&this.app.broadcast("component.set")):this.unset()},unset:function(){!1!==this.instance&&(this.app.editor.unset(),this._unsetActiveClass(),this._unsetSourceActive(),this.instance=!1,this.app.popup.close(),this.app.control.close(),this.app.toolbar.build(),this.app.path.build(),this.app.broadcast("component.unset"))},is:function(t){return t?this._isActive(t):this.get()},get:function(){return this.instance},observe:function(t,e){var i=t;if("background"===e)t.background=this.get().getData("background-color");else if("text-color"===e){var s=this.get();0!==(!s.isType("block")&&!s.isType("column")||s.getElements(["text"]).length)?t.background=s.getData("color"):i=!1}return i},focus:function(){var t=this.get();if(t)if(t.isEditable()){t.getEditableElement().focus()}else{var e=this.dom("<span>").attr("contenteditable",!0);e.css({width:0,height:0,display:"block"}),t.getElement().before(e),e.focus(),e.remove()}},popup:function(t,e,i){this.popups.open(e,i)},openAdd:function(t,e){this.popups.add(e)},duplicate:function(){var t=this.get();if(!t.isLayer()&&!t.isType("column")){var e=t.getSource(),i=e.clone();i.removeAttr("unremovable"),e.after(i);var s=this.app.create("tag."+t.getType(),i);s.renderNodes();var n=s.getElement();t.getElement().after(n),this.set(n),this.app.editor.rebuild(),this.app.broadcast("component.duplicate")}},remove:function(){var t=this.get();if(!t.isLayer()&&!t.isUnremovable()){var e=t.getParent("block"),i=t.getParent("column"),s=t.getParent("grid"),n=t.getNext();n&&n.isType("column-spacer")&&(n=n.getNext());var a=t.getType();t.remove(),this.unset(),this.app.editor.rebuild(),this._traverseRemove(e,i,s,a,n)}},drop:function(t,e){if(this.opts.image&&this.opts.image.upload){var i=this.dom(t.target).closest("[data-"+this.prefix+"-type=image]");if(0!==i.length&&i.dataget("instance")){this.set(i,!0,!1);for(var s=[],n=0;n<e.files.length;n++){var a=e.files[n]||e.items[n].getAsFile();a&&s.push(a)}var o={url:this.opts.image.upload,name:this.opts.image.name,data:this.opts.image.data,multiple:this.opts.image.multiple,success:"image.successDropUpload",error:"image.error"};this.app.create("upload").send(t,s,o)}}},sync:function(){var t=this.get();t.isEditable()&&(t.sync(),this.app.editor.adjustHeight())},insert:function(t,e){var i=this.get();if(i&&i.isEditable()){var s=this.app.insertion.insertNode(t,e);return i.sync(),s}},paste:function(t){t.preventDefault(),this.app.content.paste(t),this.get().sync()},moveUp:function(t){var e=this.get(),i=e.getPrev();if(i&&!e.isLayer()){t.e.preventDefault();var s=e.getElement(),n=e.getSource(),a=i.getElement(),o=i.getSource();a.before(s),o.before(n),this.app.control.updatePosition()}},moveDown:function(t){var e=this.get(),i=e.getNext();if(i&&!e.isLayer()){t.e.preventDefault();var s=e.getElement(),n=e.getSource(),a=i.getElement(),o=i.getSource();a.after(s),o.after(n),this.app.control.updatePosition()}},replaceSource:function(t){var e=this.get(),i=e.getType(),s=this.app.create("tag."+i,t),n=s.getElement();s.renderNodes(),e.getElement().after(n),e.getSource().after(s.getSource()),e.remove(),this.set(n),this.app.editor.rebuild()},getData:function(){return this.get().getData()},setData:function(t){var e=this.app.popup.getButton(),i=t.getData();this.get().setData(i),e.setColor(t,i),this.triggerData(i)},triggerData:function(t){this.app.control.updatePosition(),this.app.editor.adjustHeight(),this.app.broadcast("component.change",{data:t})},checkImageChange:function(t){if(this.app.editor.isImageChange())return t},checkColumnSpacer:function(t){return 0!==this.get().getElements(["column-spacer"]).length&&t},checkValign:function(t){var e=this.get().getType();return-1!==["block","column"].indexOf(e)&&t},add:function(t,e){var i;if(t){t.preventDefault(),t.stopPropagation();var s=this.dom(t.target).closest("."+this.prefix+"-popup-section-item").attr("data-type");i=this.app.create("block."+s)}else(i=this.app.create("tag.block",e)).renderNodes();var n=this.get(),a=n?"block":"button";!n||n.isType("block")||n.isLayer()?"button"===a&&(n=this._getAddInstance()):a="element";var o=n.getSource(),r=n.getTarget(),h=n.getElement(),l=i.getSource(),p=i.getElement();if("element"===a){var c,d=l.children();return d.nodes.reverse(),d.each(function(t){var e=t.get().tagName.toLowerCase(),i=this.app.create("tag."+e.replace("re-",""),t);i.renderNodes();var s=i.getElement();h.after(s),o.after(i.getSource()),c=s}.bind(this)),void this._setAddInstance(c)}if("block"===a){var u=n.isLayer()?"append":"after";o[u](l),n.isLayer()?r[u](p):h[u](p)}else r.removeClass(this.prefix+"-empty-layer").html(""),r.append(p),o.append(l);this._setAddInstance(p)},buildAddItems:function(t){for(var e in this.opts._blocks){var i=this.dom("<div>").addClass(this.prefix+"-popup-section"),s=this.dom("<div>").addClass(this.prefix+"-popup-section-box"),n=this.lang.get("add-sections."+e);i.html(n||e);var a=this.opts._blocks[e];for(var o in a)if(!this._isHiddenBlock(a[o].type)){var r=this.dom("<span>").addClass(this.prefix+"-popup-section-item");if(r.attr("data-type",a[o].type),a[o].icon)r.html(a[o].icon);else{var h=this.dom("<div>").addClass(this.prefix+"-popup-block-map "+this.prefix+"-b-map-"+a[o].type);r.append(h)}var l=this.dom("<span>").html(a[o].title);r.append(l),s.append(r),r.on("click.revolvapp",this.add.bind(this))}""!==s.html()&&(t.$body.append(i),t.$body.append(s))}},_isActive:function(t){return this.instance&&t.get()===this.get().$element.get()},_isHiddenBlock:function(t){return this.opts.blocks.hidden&&-1!==this.opts.blocks.hidden.indexOf(t)},_setActiveClass:function(){this.get().getElement().addClass(this.prefix+"-element-active")},_setActiveInstance:function(t){this.instance=t},_setSourceActive:function(){this.get().getSource().attr("active",!0)},_unsetActiveClass:function(){this.get().getElement().removeClass(this.prefix+"-element-active")},_unsetSourceActive:function(){this.get().getSource().removeAttr("active")},_setAddInstance:function(t){this.app.popup.close(),this.set(t),this.app.editor.rebuild(),this.app.element.scrollTo(t),this.app.broadcast("component.add")},_getAddInstance:function(){var t=this.app.popup.getButton().getElement();return this.app.element.getClosest(t,["main","header","footer"]).dataget("instance")},_traverseRemove:function(t,e,i,s,n){"block"===s?n&&this.set(n.getElement()):"column"===s?n?this.set(n.getElement()):i.isEmpty()&&(t=i.getNext(),i.remove(),t&&this.set(t.getElement())):n?this.set(n.getElement()):e?this.set(e.getElement()):t&&(t.isEmpty()?(n=t.getNext(),t.remove(),n&&this.set(n.getElement())):this.set(t.getElement()))}}),h.add("class","component.items",{init:function(){this.instance=!1},reset:function(){this.instance=!1},get:function(){return this.instance},getItemData:function(){if(this.instance)return this.instance.getData()},setItemData:function(t){var e=t.getData();t.getInstance().setData(e),this.app.component.triggerData(e)},build:function(){this.reset();var n={};return this.app.component.get().getItems().each(function(t,e){var i=t.dataget("instance"),s=t.html();"social-item"===i.getType()&&(s='<span class="'+this.prefix+'-popup-item-image">'+s+"</span>"),n[e]={title:s,command:"component.items.edit",remover:"component.items.remove",instance:i,close:!1}}.bind(this)),n},edit:function(t,e){this.instance=e.getInstance(),this.app.component.popups.edititem(e)},add:function(t){this.reset();var e=t.getData(),i=this.app.component.get(),s=i.getSpacers().first(),n=i.getItems().first(),a=i.isType("social")?"social":"menu",o=0!==n.length&&n.dataget("instance").getSource().clone(),r=0!==s.length&&s.dataget("instance").getSource().clone();if(i.isType("social")){if(""===e.image)return;(o=o||this.dom("<re-image>")).attr({placeholder:!1,src:e.image})}else if(""===e.html)return;var h=this.app.create("tag."+a+"-item",o),l=this.app.create("tag."+a+"-spacer",r);!1===r&&l.setData({html:"&nbsp;&nbsp;"}),0!==n.length&&i.add(l),i.add(h),h.setData(e),t.collapse()},remove:function(t){t.getInstance().removeItem()}}),h.add("class","component.popups",{init:function(){},open:function(t,e){"text-color"===e?this.textcolor(t):"background"===e?this.background(t):"alignment"===e?this.alignment(t):"border"===e?this.border(t):"tune"===e?this.settings(t):"items"===e?this.items(t):"add"===e?this.add(t):"image"===e&&this.image(t)},image:function(t){var e=this.app.component.get();this.app.popup.create("image",{width:"320px",title:e.getTitle(),instance:e,getter:"component.getData",setter:"component.setData",form:e.forms.image}),this.app.popup.open({button:t})},items:function(t){this.app.popup.create("items",{width:"300px",builder:"component.items.build",footer:{add:{title:"## buttons.add-item ##",fullwidth:!0,command:"component.popups.additem",type:"primary"}}}),this.app.popup.open({button:t})},additem:function(){var t=this.app.component.get(),e=this.app.popup.add("add-item",{width:"320px",title:"## popup.add-item ##",form:t.forms.item,footer:{add:{title:"## buttons.add ##",command:"component.items.add",type:"primary"},cancel:{title:"## buttons.cancel ##",collapse:!0}}});e.open(),t.isType("menu")&&e.setFocus("html")},edititem:function(t){var e=this.app.component.get(),i=t.getInstance();this.app.popup.add("edit-item",{width:"320px",title:"## popup.edit-item ##",instance:i,getter:"component.items.getItemData",setter:"component.items.setItemData",form:e.forms.item}).open()},add:function(t){this._unsetComponent(t),this.app.popup.create("add",{width:"600px",title:"## editor.add-block ##",builder:"component.buildAddItems"}),this.app.popup.open({button:t})},textcolor:function(t){var e=this.app.component.get();this.app.popup.create("text-color",{title:"## popup.text-color ##",width:"320px",getter:"component.getData",setter:"component.setData",form:this.opts.forms.textcolor}),-1!==["block","column","text"].indexOf(e.getType())&&this.app.popup.add("link-color",{collapse:!1,title:"## popup.link-color ##",width:"320px",getter:"component.getData",setter:"component.setData",form:this.opts.forms.linkcolor}),this.app.popup.open({button:t})},background:function(t){var e=this.app.component.get();this.app.popup.create("background",{title:"## popup.background ##",width:"320px",getter:"component.getData",setter:"component.setData",form:this.opts.forms.background}),-1!==["block","column","main","header","footer"].indexOf(e.getType())&&this.app.editor.isImageChange()&&this.app.popup.add("background-image",{collapse:!1,width:"320px",title:"## popup.background-image ##",instance:e,getter:"component.getData",setter:"component.setData",form:this.opts.forms.backgroundimage}),this.app.popup.open({button:t})},alignment:function(t){this.app.popup.create("alignment",{getter:"component.getData",setter:"component.setData",form:this.opts.forms.alignment}),this.app.popup.open({button:t})},border:function(t){this.app.popup.create("border",{title:"## popup.border ##",getter:"component.getData",setter:"component.setData",form:this.opts.forms.border}),this.app.popup.open({button:t})},settings:function(t){var e=this.app.component.get(),i=e.isType("image")?this.lang.get("popup.settings"):e.getTitle();this.app.popup.create("settings",{width:"320px",title:i,instance:e,getter:"component.getData",setter:"component.setData",form:e.forms.settings}),this.app.popup.open({button:t})},_unsetComponent:function(t){"addempty"===t.getName()&&this.app.component.unset()}}),h.add("module","editor",{init:function(){this.cssfile="css/revolvapp-frame.min.css?"+(new Date).getTime(),this.$template=null,this.$templateSource=null,this.$elements=[],this.mobileMode=!1,this.stateLoad=!1,this.popups=this.app.create("editor.popups")},start:function(){if(this._build(),this.opts.editor.template)this._buildTemplate();else{var t=this.opts.content?this.opts.content:this.app._elementContent.trim();t&&""!==t&&this._buildContent(t)}this._buildOptions(),this._buildBlocksOpts()},stop:function(){this.app.$element.show()},rebuild:function(){this._buildElements(),this.opts.editor.viewOnly?this.app.event.buildPreventLinks():this.app.event.build(),this.buildEmptyLayers(),this.adjustHeight();var s=this.stateLoad;!1===this.stateLoad?this.app.broadcast("editor.rebuild"):this.$elements.each(function(t){var e=t.dataget("instance");if(e.isActiveSource()&&(this.app.component.set(t),"object"==typeof s)){var i=(e=this.app.component.get()).getElement();this.app.offset.set(i,s)}}.bind(this)),this.stateLoad=!1},insertContent:function(t){t.html&&this.app.component.add(!1,t.html)},setTemplate:function(t){t=this.app.broadcast("editor.before.set",{template:t}).get("template"),this._buildContent(t),this.app.component.unset(),this.app.broadcast("editor.change")},setTemplateElement:function(t){this.$template=t},setState:function(t,e){this.stateLoad=!1===e||e,this._buildTemplateSource(t),this.app.parser.parse()},setFocus:function(){},setWinFocus:function(){this.getWin().focus()},getWidth:function(){var t=this.getEditor(),e=parseInt(t.css("padding-left")),i=parseInt(t.css("padding-right"));return t.width()-e-i},getEditor:function(){return this.getFrame()},getLayout:function(){return this.getFrame()},getFrame:function(){return this.$editor},getDoc:function(){return this.dom(this.$editor.get().contentWindow.document)},getWin:function(){return this.dom(this.$editor.get().contentWindow)},getDocNode:function(){return this.$editor.get().contentWindow.document},getWinNode:function(){return this.$editor.get().contentWindow},getHead:function(){return this.getDoc().find("head")},getBody:function(){return this.getDoc().find("body")},getBodyTarget:function(){return this.getBody().find("td").first()},getBodyInstance:function(){return this.getBody().dataget("instance")},getRect:function(){return this.getFrameRect()},getFrameRect:function(){var t=this.$editor.offset(),e=this.$editor.width(),i=this.$editor.height(),s=Math.round(t.top),n=Math.round(t.left);return{top:s,left:n,bottom:s+i,right:n+e}},getText:function(){var t=this.$template.html();t=(t=(t=(t=this.app.utils.wrap(t,function(t){t.find("a, re-link, re-button").each(function(t){var e=t.attr("href"),i=t.html().trim();i=i+" ("+e+")",t.html(i)}),t.find("re-heading").each(function(t){var e="*** "+t.text().trim().toUpperCase();t.text(e)}),t.find("re-template, re-menu, re-social, re-head, re-preheader, re-options").remove()})).replace(/<re-footer/gi,"----<re-footer")).replace(/<\/(re-text|re-link|re-button|re-heading)>/gi,"</$1>\n")).replace(/<br\s?\/?>/gi,"\n");for(var e=this.dom("<div>").html(t).get(),i="",s=(t=e.textContent||e.innerText||"").split("\n"),n=0;n<s.length;n++)i+=s[n].trim()+"\n";return t=(t=i.trim()).replace(/[\n]+/g,"\n\n")},getHtml:function(t){return this.app.parser.unparse(t)},getTemplateElement:function(){return this.$template},getTemplateSourceElement:function(){return this.$templateSource},getTemplate:function(t){return this._getTemplate(this.$template.html(),t)},getTemplateSource:function(t){return this._getTemplate(this.$templateSource.html(),t)},unset:function(){0<this.$elements.length&&(this.$elements.removeClass(this.prefix+"-element-active "+this.prefix+"-element-hover"),this.$template.find("."+this.prefix+"-element-active").removeClass(this.prefix+"-element-active"))},unsetHover:function(){0<this.$elements.length&&this.$elements.removeClass(this.prefix+"-element-hover")},unsetActive:function(){0<this.$elements.length&&(this.$elements.removeClass(this.prefix+"-element-active"),this.$template.find("."+this.prefix+"-element-active").removeClass(this.prefix+"-element-active"))},adjustHeight:function(e){setTimeout(function(){var t=this.getBody().height()+(e||0);t=t<140?140:t,this.$editor.height(t)}.bind(this),50)},render:function(t,e){this.app.parser.render(t,e),this._reload()},buildEmptyLayers:function(){if(!this.opts.editor.viewOnly){var t=this.getBody();this.app.element.getChildren(t,["main","header","footer"]).each(function(t){var e=t.dataget("instance");if(!e.getTarget().hasClass(this.prefix+"-empty-layer")&&0===e.getElements().length){var i=e.getTarget();i.addClass(this.prefix+"-empty-layer");var s={command:"component.openAdd",classname:this.prefix+"-plus-button"};this.app.create("button","addempty",s,i)}}.bind(this))}},isPopupSelection:function(){return!0},isImageChange:function(){var t=this.opts.image;return!(!t||!t.upload&&!t.url)},isSourceMode:function(){return"none"===this.app.container.get("editor").css("display")},isMobileMode:function(){return this.mobileMode},toggleView:function(){this.mobileMode?(this.$editor.css("width",""),this.app.event.run(),this.app.path.enable(),this.app.toolbar.enableButtons(),this.app.toolbar.unsetToggled("mobile"),this.mobileMode=!1):(this.$editor.css("width",this.opts.editor.mobile+"px"),this.app.event.pause(),this.app.component.unset(),this.app.path.disable(),this.app.toolbar.disableButtons(["mobile"]),this.app.toolbar.setToggled("mobile"),this.app.popup.close(),this.app.control.close(),this.mobileMode=!0),this.adjustHeight()},observe:function(t,e){return"background"===e&&(t.background=this.getBodyInstance().getData("background-color")),t},popup:function(t,e,i){this.popups.open(e,i)},getData:function(){return this.getBodyInstance().getData()},setData:function(t){var e=this.app.popup.getButton(),i=t.getData(),s=this.getBodyInstance();e.setColor(t,i),s.setData(i),this.adjustHeight()},_build:function(){this.$editor=this.dom("<iframe>"),this.$editor.addClass(this.prefix+"-editor").css("visibility","hidden"),this.app.container.get("editor").append(this.$editor)},_buildState:function(){this.app.state.build()},_buildObserver:function(){this.app.observer.build()},_buildBodyInstance:function(){var t=this.$template.find("re-body"),e=this.getBody();this.app.create("tag.body",t,e,!0)},_buildTemplate:function(){this.ajax.get({url:this.opts.editor.template,data:{d:(new Date).getTime()},success:this._buildContent.bind(this)})},_buildTemplateSource:function(t){t=t.trim(),this.$templateSource=this.dom("<div>"),this.$templateSource.html(t)},_buildContent:function(t){t=this.app.broadcast("editor.before.render",{template:t}).get("template"),this._buildTemplateSource(t),this.app.parser.parse()},_buildElements:function(){var t=this.getBody();this.$elements=this.app.element.getChildren(t,this.opts._elements)},_buildBlocksOpts:function(){for(var t in this.app._store)if("block"===this.app._store[t].type){var e=this.app._store[t].proto.prototype;void 0===this.opts._blocks[e.section]&&(this.opts._blocks[e.section]={});var i=e.title?e.title:this.lang.get("blocks."+e.type),s=e.priority||!1;if(this.opts.blocks.hidden&&"all"===this.opts.blocks.hidden&&s)continue;var n={type:e.type,icon:e.icon,title:i};if(s)this.opts._blocks[e.section][s]=n;else{var a=parseInt(function(i){var t=Object.keys(i);return 0<t.length?t.reduce(function(t,e){return i[t]>i[e]?t:e}):0}(this.opts._blocks[e.section]));this.opts._blocks[e.section][a+1]=n}}},_buildOptions:function(){var t=this.$editor,e=this.opts.editor;t.attr("dir",e.direction),t.attr("scrolling","no"),e.minHeight&&t.css("min-height",e.minHeight),e.maxHeight&&(t.css("max-height",e.maxHeight),t.attr("scrolling","yes")),e.notranslate&&t.addClass("notranslate"),e.spellcheck||t.attr("spellcheck",!1)},_buildUICss:function(){this.opts.editor.path&&this._buildCssLink(this.opts.editor.path+this.cssfile);for(var t=0;t<this.opts.pluginsCss.length;t++)this._buildCssLink(this.opts.pluginsCss[t])},_buildCssLink:function(t){var e=this.dom("<link>").attr({class:this.prefix+"-css",type:"text/css",rel:"stylesheet",href:t});this.getHead().append(e)},_buildVisibility:function(){this.$editor.css("visibility","visible")},_buildImage:function(t){if(this.opts.editor.images){var e=t.get(),i=e.src.split("/"),s=i[i.length-1];e.src=this.opts.editor.images+s}t.one("load",this._loadImage.bind(this))},_loaded:function(){this.adjustHeight(),this._buildVisibility(),this._buildUICss(),this._buildBodyInstance(),!1===this.stateLoad&&this._buildState(),this._buildObserver(),this.rebuild(),!1===this.stateLoad&&this.app.broadcast("editor.load")},_load:function(){try{this._loadImages(),this._loaded()}catch(t){h.error(t)}},_reload:function(){try{this._loadImages(),this.adjustHeight(),this.rebuild()}catch(t){h.error(t)}},_loadImages:function(){var t=this.getDoc().find("img");this.imageslen=t.length,t.each(this._buildImage.bind(this));var e=setInterval(function(){if(0===this.imageslen)return this.adjustHeight(),void clearInterval(e)}.bind(this),50)},_loadImage:function(){this.imageslen--},_getTemplate:function(t,e){return t=this.app.content.removeTemplateUtils(t),t=!0===e?this.app.tidy.parse(t,"source"):t}}),h.add("class","editor.popups",{init:function(){},open:function(t,e){"background"===e?this.background(t):"tune"===e&&this.settings(t)},settings:function(t){var e=this.app.editor.getBodyInstance();this.app.popup.create("settings",{width:"300px",title:e.getTitle(),getter:"editor.getData",setter:"editor.setData",form:e.forms.settings}),this.app.popup.open({button:t})},background:function(t){var e=this.app.editor.getBodyInstance();this.app.popup.create("background",{title:"## popup.background ##",width:"320px",getter:"editor.getData",setter:"editor.setData",form:e.forms.background}),this.app.editor.isImageChange()&&this.app.popup.add("background-image",{collapse:!1,width:"400px",title:"## popup.background-image ##",instance:e,getter:"editor.getData",setter:"editor.setData",form:e.forms.backgroundimage}),this.app.popup.open({button:t})}}),h.add("module","event",{init:function(){this.eventname=this.prefix+"-editor-events",this.eventpreventname=this.prefix+"-editor-prevent-events",this.dragoverEvent=!1,this.isPopupMouse=!1,this.frameEvents=["mousedown","mouseover","keydown","keyup","paste","drop","dragstart","dragover","dragleave"],this.docEvents=["click","mousedown","keydown"]},stop:function(){this.$frameBody&&(this.$frameBody.off("."+this.eventname),this.app.$doc.off("."+this.eventname))},pause:function(){this.$frameBody&&(this.$frameBody.off("."+this.eventname),this.app.$doc.off("."+this.eventname))},run:function(){this.$frameBody&&this._buildEvents()},build:function(){this.$frameBody=this.app.editor.getBody(),this.stop(),this.buildPreventLinks(),this._buildEvents()},buildPreventLinks:function(){this.app.editor.getBody().on("click."+this.eventpreventname+" dblclick."+this.eventpreventname,this.preventLinks.bind(this))},preventLinks:function(t){this._isLinkClick(t)&&t.preventDefault()},onmouseover:function(t){var e=this.dom(t.target),i=this._getElementFromTarget(e);this._isNoneditable(i)||(this.app.editor.unsetHover(),0===i.length||i.hasClass(this.prefix+"-element-active")||i.addClass(this.prefix+"-element-hover"),this.app.broadcast("event.mouseover",{e:t}))},onmousedown:function(t){var e=this.dom(t.target),i=this._getElementFromTarget(e);0===i.length||this._isNoneditable(i)?this.app.popup.isOpen()?this.app.popup.close():this.app.component.unset():this.app.component.set(i),this.app.state.build(!0),this.app.broadcast("event.click",{e:t})},onkeydown:function(t){var e=t.which,i=this.app.keycodes;if(!this.app.state.listen(t)){e===i.ESC&&(this.app.popup.isOpen()?this.app.popup.close():this.app.component.is()&&this.app.component.unset());var s=this._buildEventKeysObj(t),n=this.app.broadcast("event.keydown",s);if(n.isStopped())return t.preventDefault();this.app.shortcut.handle(t)||this.app.input.handle(n)}},onkeyup:function(t){var e=this.app.component.get(),i=this.app.selection.getCurrent(),s=this.dom(i).closest("[data-"+this.prefix+"-type]");0!==s.length&&(e=s.dataget("instance"))&&(e.isEditable()||e.isType("list-item"))&&!this.app.component.is(s)&&(this.app.state.build(),s=e.isType("list-item")?s.closest("[data-"+this.prefix+"-type=list]"):s,this.app.component.set(s,!1,!0,!1)),e=this.app.component.get(),this.app.component.is()&&e.isEditable()&&(this.app.control.updatePosition(),this.app.component.sync()),this.app.broadcast("event.keyup",{e:t})},onpaste:function(t){if(this.app.broadcast("event.paste",{e:t}).isStopped())return t.preventDefault();this.app.component.paste(t)},ondrop:function(t){t.preventDefault(),t.stopPropagation();var e=t.dataTransfer;null!==e.files&&0<e.files.length&&this.app.component.drop(t,e),this.app.broadcast("event.drop",{e:t})},ondragstart:function(t){this.app.broadcast("event.dragstart",{e:t})},ondragover:function(t){t.preventDefault(),this.dragoverEvent=!0,this.app.broadcast("event.dragover",{e:t})},ondragleave:function(t){t.preventDefault(),this.dragoverEvent=!1,this.app.broadcast("event.dragleave",{e:t})},ondocclick:function(t){!this.isPopupMouse&&this.app.popup.isOpen()&&this.app.popup.close(t),0!==this.dom(t.target).closest("."+this.prefix+"-popup").length||this.app.component.unset(),this.isPopupMouse=!1},ondocmousedown:function(t){var e=this.dom(t.target);this.isPopupMouse=0!==e.closest("."+this.prefix+"-popup").length},ondockeydown:function(t){t.which===this.app.keycodes.ESC&&this.app.popup.isOpen()&&this.app.popup.close()},_isLinkClick:function(t){return 0!==this.dom(t.target).closest("a").length},_isNoneditable:function(t){return 0!==t.closest("[noneditable]").length},_getElementFromTarget:function(t){return this.app.element.getClosest(t,this.opts._elements)},_buildEvents:function(){for(var t=0;t<this.frameEvents.length;t++)this.$frameBody.on(this.frameEvents[t]+"."+this.eventname,this["on"+this.frameEvents[t]].bind(this));for(var e=0;e<this.docEvents.length;e++)this.app.$doc.on(this.docEvents[e]+"."+this.eventname,this["ondoc"+this.docEvents[e]].bind(this))},_buildEventKeysObj:function(t){var e=t.which,i=[this.app.keycodes.UP,this.app.keycodes.DOWN,this.app.keycodes.LEFT,this.app.keycodes.RIGHT],s=!t.ctrlKey&&!t.metaKey&&(48<=e&&e<=57||65<=e&&e<=90),n=this.app.keycodes;return{e:t,key:e,ctrl:t.ctrlKey||t.metaKey,shift:t.shiftKey,alt:t.altKey,select:(t.ctrlKey||t.metaKey)&&!t.altKey&&65===e,enter:e===n.ENTER,space:e===n.SPACE,esc:e===n.ESC,tab:!(e!==n.TAB||t.shiftKey||t.altKey||t.ctrlKey||t.metaKey),delete:e===n.DELETE,backspace:e===n.BACKSPACE,alpha:s,arrow:-1!==i.indexOf(e),left:e===n.LEFT,right:e===n.RIGHT,up:e===n.UP,down:e===n.DOWN,"left-right":e===n.LEFT||e===n.RIGHT,"up-left":e===n.UP||e===n.LEFT,"down-right":e===n.DOWN||e===n.RIGHT}}}),h.add("module","link",{popups:{add:{width:"400px",title:"## popup.insert-link ##",form:{text:{type:"input",label:"## form.text ##"},href:{type:"input",label:"## form.url ##"}},footer:{insert:{title:"## buttons.insert ##",command:"link.insert",type:"primary"},cancel:{title:"## buttons.cancel ##",close:!0}}},edit:{width:"400px",title:"## popup.edit-link ##",form:{text:{type:"input",label:"## form.text ##"},href:{type:"input",label:"## form.url ##"}},footer:{save:{title:"## buttons.save ##",command:"link.save",type:"primary"},unlink:{title:"## buttons.unlink ##",command:"link.unlink",type:"danger"},cancel:{title:"## buttons.cancel ##",close:!0}}}},init:function(){},popup:function(t,e){var i=this._getData(),s=this._getLink()?"edit":"add";this.app.popup.create("link",this.popups[s]).setData(i),this.app.popup.open({button:e,focus:"href"})},insert:function(t){var e=t.getData();if(this.app.popup.close(),-1!==e.href.search(/^javascript:/i)&&(e.href=""),""!==e.href){var i=this.app.component.get(),s=i.getLinkData(),n=this.app.inline.format({tag:"a"}),a=this.dom(n[0]);a.css(s),e.text=""===e.text?e.href:e.text,a.text(e.text);var o=this.app.content.replaceToHttps("href",e.href);a.attr("href",o),i.sync(),this.app.caret.set(a,"after"),this.app.broadcast("link.add",{url:e.href,text:e.text})}},save:function(t){var e=t.getData();if(this.app.popup.close(),-1!==e.href.search(/^javascript:/i)&&(e.href=""),""!==e.href){var i=this.app.component.get(),s=this._getLink();e.text=""===e.text?e.href:e.text,s.text(e.text);var n=this.app.content.replaceToHttps("href",e.href);s.attr("href",n),i.sync(),this.app.broadcast("link.change",{url:e.href,text:e.text})}},unlink:function(){this.app.popup.close();var t=this.app.selection.getNodes({type:"inline",tags:["a"]});if(0!==t.length)for(var e=this.app.component.get(),i=0;i<t.length;i++){var s=this.dom(t[i]);this.app.broadcast("link.remove",{url:s.attr("href"),text:s.text()}),s.unwrap(),e.sync()}},_getData:function(){var t=this._getLink();return{text:t?t.text():this.app.selection.getText(),href:t?t.attr("href"):""}},_getLink:function(){var t=this.app.selection.getNodes({tags:["a"]});return 0!==t.length&&this.dom(t[0])}}),h.add("module","state",{init:function(){this.prevState="",this.undoStorage=[],this.redoStorage=[]},stop:function(){this.clear()},is:function(){return this.app.content.removeTemplateUtils(this.app.editor.$template.html())===this.app.state.prevState},build:function(t){var e=this.app.editor.$template.get(),i=this._getLastUndo();this.prevState=this.app.content.removeTemplateUtils(this.app.editor.$template.html());var s={initial:!0,editable:!1,html:e.innerHTML,offset:!1};if(i){if(t&&i.initial){s.initial=!1;var n=this.app.component.get();if(n){var a=n.getElement();a&&n.isEditable()&&(s.offset=this.app.offset.get(a))}this._replaceUndo(0,s)}}else this._setUndo(s)},clear:function(){this.prevState="",this.undoStorage=[],this.redoStorage=[]},listen:function(t){return this._isUndo(t)?(t.preventDefault(),this.undo(),!0):this._isRedo(t)?(t.preventDefault(),this.redo(),!0):void 0},add:function(t,e){var i=this.app.component.get(),s=!1;if(i){var n=i.getElement();s=e?this.app.offset.get(n):s}var a=t.innerHTML,o=this._getLastUndo();if(this.prevState=this.app.content.removeTemplateUtils(this.app.editor.$template.html()),o&&a!==o.html){var r={initial:!1,editable:e,html:a,offset:s};this._setUndo(r)}},undo:function(){if(this._hasUndo()){var t=this._getUndo();t&&(this.app.editor.setState(t.html,t.offset),this.app.broadcast("state.undo"))}},redo:function(){if(this._hasRedo()){var t=this._getRedo();t&&(this._setUndo(t),this.app.editor.setState(t.html,t.offset),this.app.broadcast("state.redo"))}},_hasUndo:function(){return 0!==this.undoStorage.length},_hasRedo:function(){return 0!==this.redoStorage.length},_isUndo:function(t){var e=t.which;return(t.ctrlKey||t.metaKey)&&90===e&&!t.shiftKey&&!t.altKey},_isRedo:function(t){var e=t.which;return(t.ctrlKey||t.metaKey)&&(90===e&&t.shiftKey||89===e&&!t.shiftKey)&&!t.altKey},_getRedo:function(){return 0!==this.redoStorage.length&&this.redoStorage.pop()},_getUndo:function(){var t;if(0===this.undoStorage.length)t=!1;else if(1===this.undoStorage.length)t=this.undoStorage[0],this._setRedo(t);else{var e=this.undoStorage.pop();this._setRedo(e),t=this.undoStorage.pop(),this._setUndo(t)}return t},_getLastUndo:function(){return 0!==this.undoStorage.length&&this.undoStorage[this.undoStorage.length-1]},_setRedo:function(t){this.redoStorage.push(t),this.redoStorage=this.redoStorage.slice(0,this.opts.buffer.limit)},_setUndo:function(t){this.undoStorage.push(t),this._removeOverStorage()},_replaceUndo:function(t,e){this.undoStorage[t]=e},_removeOverStorage:function(){this.undoStorage.length>this.opts.buffer.limit&&(this.undoStorage=this.undoStorage.slice(0,this.undoStorage.length-this.opts.buffer.limit))}}),h.add("module","tidy",{init:function(){},parse:function(t,e){t=(t=(t=(t=t.replace(/\n\s+/g,"\n")).replace(/\t/g,"    ")).replace(/<!--\s+</g,"\x3c!-- <")).replace(/\n/g,"");var i=["re-style","style","meta","link"],s=[],n=["re-container","re-title","re-social","re-menu","re-font","re-link","re-list","re-list-item","re-spacer","re-text","re-heading","re-body","re-head","re-header","re-footer","re-divider","re-menu-item","re-main","re-block","re-grid","re-column","re-preheader","re-button"];"html"===e&&(n=["p","h1","h2","h3","h4","h5","h6","title","head","body","table","thead","tbody","tfoot","tr","td","th"]),this.lineBefore=new RegExp("^<(/?"+i.join("|/?")+"|"+s.join("|")+")[ >]"),this.lineAfter=new RegExp("^<(br|/?"+i.join("|/?")+"|/"+s.join("|/")+")[ >]"),this.newLevel=new RegExp("^</?("+n.join("|")+")[ >]");var a=0,o=t.length,r=0,h=null,l=null,p="",c="",d="";for(this.cleanlevel=0;a<o;a++){if(r=a,-1==t.substr(a).indexOf("<"))return c+=t.substr(a),this.finish(c,e);for(;r<o&&"<"!=t.charAt(r);)r++;for(a!=r&&((d=t.substr(a,r-a)).match(/^\s{2,}$/g)||("\n"==c.charAt(c.length-1)?c+=this.getTabs():"\n"==d.charAt(0)&&(c+="\n"+this.getTabs(),d=d.replace(/^\s+/,"")),c+=d),d.match(/\n/)&&(c+="\n"+this.getTabs())),h=r;r<o&&">"!=t.charAt(r);)r++;var u;if(a=r,"!--"==(p=t.substr(h,r-h)).substr(1,3)){if(!p.match(/--$/)){for(;"--\x3e"!=t.substr(r,3);)r++;r+=2,p=t.substr(h,r-h),a=r}"\n"!=c.charAt(c.length-1)&&(c+="\n"),c+=this.getTabs(),c+=p+">\n"}else"!"==p[1]?c=this.placeTag(p+">",c):"?"==p[1]?c+=p+">\n":u===p.match(/^<(script|style|pre)/i)?(u[1]=u[1].toLowerCase(),p=this.cleanTag(p),c=this.placeTag(p,c),(l=String(t.substr(a+1)).toLowerCase().indexOf("</"+u[1]))&&(d=t.substr(a+1,l),a+=l,c+=d)):(p=this.cleanTag(p),c=this.placeTag(p,c))}return this.finish(c,e)},getTabs:function(){for(var t="",e=0;e<this.cleanlevel;e++)t+="    ";return t},finish:function(t,e){if(t=(t=(t=(t=t.replace(/\n\s*\n/g,"\n")).replace(/^[\s\n]*/,"")).replace(/[\s\n]*$/,"")).replace(/<script(.*?)>\n<\/script>/gi,"<script$1><\/script>"),this.opts.editor.delimiters){var i=this.app.parser._store(t);t=i.html;var s=this.opts.editor.delimiters;for(var n in s)t=(t=t.replace(new RegExp(s[n][1]+"\\n","g"),s[n][1])).replace(new RegExp(s[n][1],"g"),s[n][1]+"\n");t=this.app.parser._restoreReplaced(i.data,t),t=this.app.parser._restoreReplaced(i.data,t)}if(this.cleanlevel=0,"html"!==e){var a=new RegExp(">\\n\\s+</("+["re-font","re-mobile-spacer","re-column-spacer","re-image","re-divider","re-spacer"].join("|")+")>","g");t=t.replace(a,"></$1>")}return t},cleanTag:function(t){var e,i="",s="";for((t=(t=(t=t.replace(/\n/g," ")).replace(/\s{2,}/g," ")).replace(/^\s+|\s+$/g," ")).match(/\/$/)&&(s="/",t=t.replace(/\/+$/,""));null!=(e=/\s*([^= ]+)(?:=((['"']).*?\3|[^ ]+))?/.exec(t))&&(e[2]?i+=e[1].toLowerCase()+"="+e[2]:e[1]&&(i+=e[1].toLowerCase()),i+=" ",t=t.substr(e[0].length)),e;);return i.replace(/\s*$/,"")+s+">"},placeTag:function(t,e){var i=t.match(this.newLevel);return(t.match(this.lineBefore)||i)&&(e=e.replace(/\s*$/,""),e+="\n"),i&&"/"==t.charAt(1)&&this.cleanlevel--,"\n"==e.charAt(e.length-1)&&(e+=this.getTabs()),i&&"/"!=t.charAt(1)&&this.cleanlevel++,e+=t,(t.match(this.lineAfter)||t.match(this.newLevel))&&(e=e.replace(/ *$/,""),e+="\n"),e}}),h.add("module","inline",{init:function(){},removeFormat:function(){var t=this.app.component.get();if(t&&t.isEditable()){this.app.selection.save(t.getTarget());for(var e=this.app.selection.getNodes({type:"inline"}),i=0;i<e.length;i++)this.dom(e[i]).unwrap();this.app.selection.restore(t.getTarget())}},format:function(t){this.app.popup.isOpen()&&this.app.popup.close(),this.params=this._buildParams(t);var e=[];return e=this.app.selection.isCollapsed()?this.formatCollapsed():this.formatUncollapsed(),this.app.broadcast("inline.format",{nodes:e}),e},formatCollapsed:function(){var t,e=[],i=this.app.selection.getInline(),s=this.dom(i),n=i&&i.tagName.toLowerCase()===this.params.tag;if(i)if(this.app.content.isEmptyHtml(i.innerHTML))if(n)this.app.caret.set(i,"after"),s.remove();else{var a=this.app.element.replaceToTag(i,this.params.tag);this.app.caret.set(a,"start")}else if(n){var o=this.app.content.extractHtmlFromCaret(i),r=this.dom("<"+this.params.tag+" />");r=this.app.element.cloneAttrs(i,r),s.after(r.append(o)),this.app.caret.set(r,"before")}else t=this._insertInline(e,this.params.tag);else t=this._insertInline(e,this.params.tag);return t&&(e=[t]),e},formatUncollapsed:function(){var t=this.app.component.get(),e=this.app.selection.getNodes({type:"inline"});this._convertTags("u",t),this._convertToStrike(e,t),this.app.selection.save(t.getTarget()),this.app.editor.getDoc().get().execCommand("strikethrough");var i=this._revertToInlines(t);this.app.selection.restore(t.getTarget());for(var s=[],n=this.app.selection.getText(),a=0;a<i.length;a++)this._isInSelection(i[a],n)&&s.push(i[a]);if(this._clearEmptyStyle(),void 0!==this.params.attr)for(var o=0;o<s.length;o++)for(var r in this.params.attr)s[o].setAttribute(r,this.params.attr[r]);return this.app.selection.save(t.getTarget()),t.getTarget().get().normalize(),this._revertTags("u",t),this.app.selection.restore(t.getTarget()),s},_clearEmptyStyle:function(){for(var t=this.app.selection.getNodes({type:"inline"}),e=0;e<t.length;e++){this._clearEmptyStyleAttr(t[e]);var i=t[e].childNodes;if(i)for(var s=0;s<i.length;s++)this._clearEmptyStyleAttr(i[s])}},_clearEmptyStyleAttr:function(t){3!==t.nodeType&&""===t.getAttribute("style")&&t.removeAttribute("style")},_isInSelection:function(t,e){return-1!==this.app.utils.removeInvisibleChars(t.textContent).search(new RegExp(this.app.utils.escapeRegExp(e)))},_buildParams:function(t){for(var e=!0,i={},s=["tag","classname","attr"],n=0;n<s.length;n++)Object.prototype.hasOwnProperty.call(t,s[n])&&(i[s[n]]=t[s[n]],e=!1);return e?t.params:i},_insertInline:function(t,e){return[this.app.component.insert(document.createElement(e),"start")]},_convertTags:function(e,t){this.params.tag!==e&&t.getTarget().find(e).each(function(t){this.app.element.replaceToTag(t,"span").addClass(this.prefix+"-convertable-"+e)}.bind(this))},_revertTags:function(i,t){t.getTarget().find("span."+this.prefix+"-convertable-"+i).each(function(t){var e=this.app.element.replaceToTag(t,i);e.removeClass(this.prefix+"-convertable-"+i),this.app.element.removeEmptyAttrs(e,["class"])&&e.removeAttr("class")}.bind(this))},_convertToStrike:function(t,e){this.app.selection.save(e.getTarget());for(var i=0;i<t.length;i++){var s=t[i],n=this.dom(s);t[i].tagName.toLowerCase()===this.params.tag&&this._replaceToStrike(n)}this.app.selection.restore(e.getTarget())},_removeAllAttr:function(t){t.each(function(t){var e=t.get();if(0<e.attributes.length)for(var i=e.attributes,s=i.length-1;0<=s;s--)"class"!==i[s].name&&e.removeAttribute(i[s].name)})},_replaceToStrike:function(t){t.replaceWith(function(){return this.dom("<strike>").append(t.contents())}.bind(this))},_revertToInlines:function(t){var i=[];return t.getTarget().find("strike").each(function(t){var e=this.app.element.replaceToTag(t,this.params.tag);i.push(e.get())}.bind(this)),i}}),h.add("module","insertion",{init:function(){},insertBreakline:function(t){return this.insertNode(document.createElement("br"),t||"after")},insertChar:function(t,e){return this.insertNode(t,e||"after")},insertHtml:function(t,e){var i=this.insertNode(t,e||"after");return this.app.broadcast("editor.change"),i},insertFromPaste:function(t,e){return this._insertFragment({html:t},e)},insertNode:function(t,e){return"string"!=typeof t||/^\s*<(\w+|!)[^>]*>/.test(t)||(t=document.createTextNode(t)),this._insertFragment({node:this.dom(t).get()},e)},_insertFragment:function(t,e){if(t.html||t.fragment){var i=this.app.fragment.build(t.html||t.fragment);this.app.fragment.insert(i)}else this.app.fragment.insert(t.node);if(e){var s=t.node?t.node:"start"===e?i.first:i.last;this.app.caret.set(s,e)}return t.node?this.dom(t.node):this.dom(i.nodes)}}),h.add("module","selection",{init:function(){this.savedSelection=!1},get:function(){var t=this._getSelection(),e=this._getRange(t),i=this._getCurrent(t);return{selection:t,range:e,collapsed:this._getCollapsed(t,e),current:i,parent:this._getParent(i)}},getNodes:function(t){for(var e,i,s=this._getSelection(),n=this._getRange(s),a=s&&n?this._getRangeNodes(n):[],o=[],r=0;r<a.length;r++)e=!0,t&&(t.type&&("inline"!==t.type||this.app.element.is(a[r],"inline")||(e=!1)),t.tags&&((i=void 0!==a[r].tagName)||(e=!1),i&&-1===t.tags.indexOf(a[r].tagName.toLowerCase())&&(e=!1))),e&&o.push(a[r]);return o},getCurrent:function(){var t=this._getSelection();return this._getCurrent(t)},getParent:function(){var t=this.getCurrent();return this._getParent(t)},getElement:function(t){return this._getElement(t,"element")},getInline:function(t){return this._getElement(t,"inline")},getBlock:function(t){return this._getElement(t,"block")},getRange:function(){var t=this._getSelection();return this._getRange(t)},getText:function(t,e){var i=this.get(),s=!1;if(!i.selection)return!1;if(t&&i.range){e=void 0===e?1:e;var n=this.app.editor.$editor.get(),a=i.range.cloneRange();"before"===t?(a.collapse(!0),a.setStart(n,0),s=a.toString().slice(-e)):"after"===t&&(a.selectNodeContents(n),a.setStart(i.range.endContainer,i.range.endOffset),s=a.toString().slice(0,e))}else s=i.selection?i.selection.toString():"";return s},getHtml:function(){var t="",e=this.get();if(e.selection){var i=e.range.cloneContents(),s=document.createElement("div");s.appendChild(i),t=(t=s.innerHTML).replace(/<p><\/p>$/i,"")}return t},set:function(t){t.selection&&(t.selection.removeAllRanges(),t.selection.addRange(t.range))},setRange:function(t){this.set({selection:this.app.editor.getWinNode().getSelection(),range:t})},is:function(t){if(void 0===t)return this.get().selection;for(var e=this.dom(t).get(),i=this.getNodes(),s=0;s<i.length;s++)if(i[s]===e)return!0;return!1},isCollapsed:function(){var t=this.get(),e=this.getRange();return this._getCollapsed(t,e)},isAll:function(t){var e=this.dom(t).get(),i=this.app.editor.getWinNode().getSelection(),s=this._getRange(i);return!i.isCollapsed&&(!!this.is(e)&&(void 0!==e.textContent&&e.textContent.trim().length===s.toString().trim().length))},collapse:function(t){t=t||"start";var e=this.get();e.selection&&!e.collapsed&&("start"===t?e.selection.collapseToStart():e.selection.collapseToEnd())},removeAllRanges:function(){this.app.editor.getWinNode().getSelection().removeAllRanges()},deleteContents:function(){this.getRange().deleteContents()},save:function(t){this.savedSelection=this.app.offset.get(t)},restore:function(t){this.savedSelection&&(this.app.offset.set(t,this.savedSelection),this.savedSelection=!1)},_getSelection:function(){var t=this.app.editor.getWinNode().getSelection();return 0<t.rangeCount&&t},_getRange:function(t){return!!t&&(0<t.rangeCount&&t.getRangeAt(0))},_getCurrent:function(t){return!!t&&t.anchorNode},_getParent:function(t){var e=!!t&&t.parentNode;return!this._isEditableNode(e)&&e},_getElement:function(t,e){var i=this._getSelection();if(i){var s=t||this._getCurrent(i);for(s=this.dom(s).get();s;){if(this.app.element.is(s,e)&&!this._isEditableNode(s))return s;s=s.parentNode}}return!1},_getCollapsed:function(t,e){var i=!1;return t&&t.isCollapsed?i=!0:e&&0===e.toString().length&&(i=!0),i},_getNextNode:function(t){if(t.firstChild)return t.firstChild;for(;t;){if(t.nextSibling)return t.nextSibling;t=t.parentNode}},_getRangeNodes:function(t){var e,i=t.startContainer.childNodes[t.startOffset]||t.startContainer,s=t.endContainer.childNodes[t.endOffset]||t.endContainer,n=t.commonAncestorContainer,a=[];for(e=i.parentNode;e&&!this._isEditableNode(e)&&(a.push(e),e!=n);e=e.parentNode);for(a.reverse(),e=i;e&&(3===e.nodeType||0!==this.dom(e.parentNode).closest(n).length)&&(a.push(e),e!=s);e=this._getNextNode(e));return a},_isEditableNode:function(t){return this.dom(t).hasClass(this.prefix+"-editable")}}),h.add("module","autosave",{send:function(){this.opts.autosave.url&&this._sending()},_sending:function(){var e={html:this.app.editor.getHtml(),template:this.app.editor.getTemplate()};this.ajax.request(this.opts.autosave.method,{url:this.opts.autosave.url,data:e,before:function(t){if(this.app.broadcast("autosave.before.send",{xhr:t,data:e}).isStopped())return!1}.bind(this),success:function(t){this._complete(t,e)}.bind(this)})},_complete:function(t,e){var i=t&&t.error?"autosave.error":"autosave.send";this.app.broadcast(i,{data:e,response:t})}}),h.add("module","normalize",{init:function(){},getter:function(t,e){switch(t){case"padding":case"margin":case"width":case"href":case"alt":e=null===e?"":e;break;case"html":e=null===e?"":e.trim();break;case"height":case"font-size":case"border-width":case"border-radius":e=null===e?0:e,e=parseInt(e);break;case"color":case"border-color":case"background-color":e=null===e?"":this.app.color.normalize(e);break;case"align":e=null===e?this.opts.editor.align:e;break;case"valign":e=null===e?"none":e;break;case"background-size":null===e?e="auto":!1===e&&(e="cover"),e="auto"===e;break;case"font-weight":e="bold"===(e=null===e?"normal":e)||e;break;case"text-decoration":e="underline"===(e=null===e?"none":e)||e}return e},setter:function(t,e){switch(t){case"padding":case"alt":case"href":e=new String(e).trim();break;case"margin":e=""===(e=new String(e).trim())?0:e;break;case"color":case"background-color":e=""!==(e=new String(e).trim())&&-1===e.indexOf("#")?"#"+e:e;break;case"border":var i=e.split(" ");e=0===parseInt(i[0])||""===i[2]?"":e;break;case"width":case"height":case"font-size":case"border-radius":e=this.number(e,"px");break;case"background-size":e=!0===e||"auto"===e?"auto":"cover";break;case"font-weight":e=!0===e||"bold"===e?"bold":"normal";break;case"font-style":e=!0===e||"italic"===e?"italic":"normal";break;case"text-decoration":e=!0===e||"underline"===e?"underline":"none"}return e},number:function(t,e){return-1!==t.search("%")?t:e?parseInt(t)+e:parseInt(t)}}),h.add("module","content",{init:function(){},paste:function(t){var e,i=this.app.component.get(),s=i.getType(),n=t.clipboardData||t.originalEvent.clipboardData,a=n.getData("URL"),o=this._isClipboardPlainText(n)?n.getData("text/plain"):n.getData("text/html"),r=this._isHtmlMsWord(o);o=a&&""!==a?a:o,o=this.removeDoctype(o),o=this.removeComments(o),o=(o=this.removeTags(o,this.opts.tags.denied)).trim(),o=this._cleanGDocs(o),o=this.app.utils.wrap(o,function(t){t.find(".Apple-converted-space").unwrap(),t.find(this.opts.tags.block.join(",")).append("<br>").unwrap(),t.find(this.opts.tags.inline.join(",")).removeAttr("style"),t.find("span").each(this._removeEmptySpan.bind(this))}.bind(this));-1!==["text","list","table-cell"].indexOf(s)?(e=this.opts.tags.inline.concat(["br"]),o=this.parseHtmlLinks(i.$source,o,i)):-1!==["heading","link","button"].indexOf(s)&&(e=this.app.utils.removeFromArrayByValue(this.opts.tags.inline,"a")),r&&(o=(o=o.replace(/\n/g," ")).replace(/<!--\[if !supportLists\]-->([\s\S]*?)<!--\[endif\]-->/gi,"")),o=this._removeTagsExcept(o,this.app.utils.removeFromArrayByValue(e,"span")),o=this.removeComments(o),r||(o=this._replaceNlToBr(o)),o=o.replace(/<br\s?\/?>$/gi,""),o=this.app.utils.removeInvisibleChars(o),this.app.insertion.insertFromPaste(o,"end")},removeTemplateUtils:function(t){return(t=this.app.utils.wrap(t,this.decodeVars.bind(this))).replace(/\sactive="true"/gi,"")},removeDoctype:function(t){return t.replace(new RegExp("<!doctype[^>]*>","gi"),"")},removeComments:function(t){return t.replace(/<!--[\s\S]*?-->\n?/g,"")},removeTags:function(t,i){var e=i?/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi:/(<([^>]+)>)/gi,s=i?function(t,e){return-1===i.indexOf(e.toLowerCase())?t:""}:"";return t.replace(e,s)},parseHtmlLinks:function(a,t,o){var r=this;return t=this.app.utils.wrap(t,function(t){t.find("a").each(function(t){var e=o.getLinkData(a);for(var i in e)r.setLinkCssProp(t,i,e[i]);var s=t.attr("href");s=r.replaceToHttps("href",s),t.attr({target:"_blank",href:s});var n=t.attr("style");n&&(n=n.replace(/"/g,"'"),t.attr("style",n))})})},setLinkCssProp:function(t,e,i){t.css(e)||t.css(e,i)},decodeVars:function(t){this.opts.editor.delimiters;return t.find("re-var").each(function(t){t.replaceWith(t.html())}.bind(this)),t},decodeVarsEntities:function(t){if(this.opts.editor.delimiters){var e=this.opts.editor.delimiters;for(var i in e){var s=t.match(new RegExp(e[i][0]+"([\\w\\W]*?)"+e[i][1],"g"));if(s)for(var n=0;n<s.length;n++)t=t.replace(s[n],this.app.content.decodeEntities(s[n]))}}return t},decodeEntities:function(t){return String(t).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},replaceToHttps:function(t,e){return!this.opts.editor.https||"href"!==t&&"src"!==t?e:e.replace("http://","https://")},isEmptyHtml:function(t,e){return""===(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=this.removeInvisibleChars(t)).replace(/&nbsp;/gi,"")).replace(/<\/?br\s?\/?>/g,e?"br":"")).replace(/\s/g,"")).replace(/^<p>[^\W\w\D\d]*?<\/p>$/i,"")).replace(/^<div>[^\W\w\D\d]*?<\/div>$/i,"")).replace(/<hr(.*?[^>])>$/i,"hr")).replace(/<iframe(.*?[^>])>$/i,"iframe")).replace(/<source(.*?[^>])>$/i,"source")).replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")).replace(/<[^\/>][^>]*><\/[^>]+>/gi,"")).trim())},extractHtmlFromCaret:function(t){t=this.dom(t).get();var e=this.app.selection.getRange();if(e){var i=e.cloneRange();return i.selectNodeContents(t),i.setStart(e.endContainer,e.endOffset),i.extractContents()}},_isHtmlMsWord:function(t){return t.match(/class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i)},_isClipboardPlainText:function(t){var e=t.getData("text/plain"),i=t.getData("text/html");if(!e||!i)return null!==e;var s=document.createElement("div");return s.innerHTML=i,s.textContent===e?!s.querySelector(":not(meta)"):void 0},_removeEmptySpan:function(t){0===t.get().attributes.length&&t.unwrap()},_removeTagsExcept:function(t,i){if(void 0===i)return t.replace(/(<([^>]+)>)/gi,"");return t.replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(t,e){return-1===i.indexOf(e.toLowerCase())?"":t})},_cleanGDocs:function(t){return t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2")).replace(/<b(.*?)id="docs-internal-guid(.*?)">([\w\W]*?)<\/b>/gi,"$3")).replace(/<br[^>]*>/gi,"<br>")).replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?bold|font-weight:\s?bold;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>")).replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?600|font-weight:\s?600;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>")).replace(/<span[^>]*(font-style:\s?italic;\s?font-weight:\s?700|font-weight:\s?700;\s?font-style:\s?italic)[^>]*>([\w\W]*?)<\/span>/gi,"<b><i>$2</i></b>")).replace(/<span[^>]*font-style:\s?italic[^>]*>([\w\W]*?)<\/span>/gi,"<i>$1</i>")).replace(/<span[^>]*font-weight:\s?bold[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>")).replace(/<span[^>]*font-weight:\s?700[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>")).replace(/<span[^>]*font-weight:\s?600[^>]*>([\w\W]*?)<\/span>/gi,"<b>$1</b>")).replace(/<p[^>]*>\s<\/p>/gi,"")},_replaceNlToBr:function(t){return t.replace(/\n/g,"<br />")}}),h.add("module","image",{init:function(){},set:function(t){var e=this.app.component.get();e&&"image"===e.getType()&&(e.setImage(t),this.app.editor.adjustHeight(),this.app.broadcast("image.change",{response:{url:t}}))},removeBackground:function(){var t=this.app.component.get()||this.app.editor.getBodyInstance();this.app.popup.getStack().setData({"background-image":""}),t.setData({"background-image":""}),this.app.broadcast("image.background.remove")},successBackground:function(t){this.app.broadcast("image.background.change",{response:t})},successDropUpload:function(t){this.app.component.get().setImage(t.url),this.app.editor.adjustHeight(),this.app.broadcast("image.change",{response:t})},successUpload:function(t){this.app.editor.adjustHeight(),this.app.broadcast("image.change",{response:t})},successSocialUpload:function(t){this.app.editor.adjustHeight(),this.app.broadcast("image.change",{response:t})},error:function(t){this.app.broadcast("image.upload.error",{response:t})}}),h.add("module","parser",{parse:function(){var t=this.app.editor.getTemplateSourceElement().html(),e=this.dom("<div>"),i=this.dom("<div>").html(t);this.app.editor.setTemplateElement(i);var s=i.children().first(),n=s.find("re-head"),a=s.find("re-body"),o=s.find("re-options"),r=s.find("re-headings"),h=this._createTag("html",s,!0),l=a.html();if(this.opts.editor.delimiters){var p=this._store(l);l=p.html;var c=this.opts.editor.delimiters;for(var d in c)l=(l=l.replace(new RegExp(c[d][0],"g"),"<re-var>"+c[d][0])).replace(new RegExp(c[d][1],"g"),c[d][1]+"</re-var>");l=this._restoreReplaced(p.data,l),l=this._restoreReplaced(p.data,l)}a.html(l),this._parseOptions(o),this._parseHeadings(r),e.append(h.$element),this._parse(n,h.$element),this._parse(a,h.$element,!0),this._createDefaultStyles(e);var u=this._createDoctype(),m=e.html();m=u+m,this._setHtml(m),this._renderContent(a.children())},unparse:function(t){var e=this.app.editor.getDoc().clone(),i=e.get();this.app.content.decodeVars(e),this._transformTags(e),this._removeUtils(e);var s=i.documentElement.outerHTML;return s=(s=(s=!0===t?this.app.tidy.parse(s,"html"):s).replace(/url\(&quot;(.*?)&quot;\)/gi,"url('$1')")).replace(/&quot;(.*?)&quot;/gi,"'$1'"),s=this.app.color.replaceRgbToHex(s),s=this.app.broadcast("editor.unparse",{html:s}).get("html"),s=this.app.content.decodeVarsEntities(s),s=this.app.utils.removeInvisibleChars(s),this._getDoctype(i)+"\n"+s},render:function(t,e){this._parse(t,e)},_parse:function(t,s,n){t.each(function(t){var e,i=t.get().tagName.toLowerCase().replace("re-","");-1!==this.opts._tags.indexOf(i)?(e=this._createTag(i,t),"text"===i&&e._parseHtmlLinks(e.$source,e.$element,e),n||-1===this.opts._nested.indexOf(i)||this._parse(t.children(),e.getTarget())):e={$element:t},"preheader"===i?this.app.editor.getBody().prepend(e.$element):s.append(e.$element)}.bind(this))},_parseOptions:function(t){if(0!==t.length){var e=t.text().trim(),i=JSON.parse(e);this.opts.styles=l.extend(!0,this.opts.styles,i)}},_parseHeadings:function(t){if(0!==t.length){var e=t.text().trim(),i=JSON.parse(e);this.opts.headings=l.extend(!0,this.opts.headings,i)}},_createDoctype:function(){return this.opts.editor.doctype+"\n"},_createDefaultStyles:function(t){var e=this.dom("<style>");e.attr("type","text/css"),e.html(this.opts._styles);var i=t.find("head"),s=i.find("style");0!==s.length?s.first().before(e):i.append(e),i.append(this.opts._msoStyles)},_createTag:function(t,e){return e=e||this.dom("<re-"+t+">"),this.app.create("tag."+t,e)},_setHtml:function(t){var e=this.app.editor.getDocNode();e.open(),e.write(t),e.close()},_renderContent:function(t){var e=this.app.editor.getBodyTarget();this._parse(t,e),this.app.editor._load()},_getDoctype:function(t){var e=t.doctype;return"<!DOCTYPE "+e.name+(e.publicId?' PUBLIC "'+e.publicId+'"':"")+(!e.publicId&&e.systemId?" SYSTEM":"")+(e.systemId?' "'+e.systemId+'"':"")+">"},_removeUtils:function(t){var e=t.find("[data-"+this.prefix+"-type]");e.each(function(t){var e=t.get(),i=e.style.lineHeight,s=e.style.fontSize;i&&s&&"0"!==i&&-1===i.search("px")&&(e.style.lineHeight=Math.ceil(parseFloat(i)*parseInt(s.replace("px","")))+"px")}),e.removeAttr("data-"+this.prefix+"-type contenteditable noneditable unremovable"),e.removeClass(this.prefix+"-element-active "+this.prefix+"-element-hover"),t.find("."+this.prefix+"-editable").removeAttr("contenteditable").removeClass(this.prefix+"-editable"),t.find("[data-gramm_editor]").removeAttr("data-gramm_editor"),t.find("."+this.prefix+"-image-placeholder, ."+this.prefix+"-social-placeholder, ."+this.prefix+"-plus-button").remove(),t.find("."+this.prefix+"-empty-layer").removeClass(this.prefix+"-empty-layer"),t.find("."+this.prefix+"-css, .rex-block-hidden-text").remove(),t.find("p").each(function(t){this.app.element.removeEmptyAttrs(t,["class"])}.bind(this))},_removeEmptyLink:function(t){var e=t.attr("href");e&&""!==e&&"#"!==e||t.unwrap()},_transformTags:function(t){t.find("[data-"+this.prefix+"-type=menu-item]").each(this._transformItemToSpan.bind(this)),t.find("[data-"+this.prefix+"-type=image] a,[data-"+this.prefix+"-type=heading] a").each(this._removeEmptyLink.bind(this)),t.find("[data-"+this.prefix+"-type=heading]").each(this._transformHeadings.bind(this))},_transformItemToSpan:function(t){var e=t.attr("href");e&&""!==e&&"#"!==e||(t.removeAttr("href"),t=this.app.element.replaceToTag(t,"span"))},_transformHeadings:function(t){for(var e=1;e<7;e++){var i="h"+e;t.hasClass(i)&&this.app.element.replaceToTag(t,i)}},_store:function(t){for(var e=["a","re-image","re-link","re-button","re-heading","re-text","re-list-item","re-table-cell"],i=[],s=0,n=0;n<e.length;n++){var a="<"+e[n]+"[^>]*>([\\w\\W]*?)</"+e[n]+">",o=t.match(new RegExp(a,"gi"));if(null!==o)for(var r=0;r<o.length;r++)t=t.replace(o[r],"#####replaceparse"+s+"#####"),i.push(o[r]),s++}return{data:i,html:t}},_restoreReplaced:function(t,e){for(var i=0;i<t.length;i++)e=e.replace("#####replaceparse"+i+"#####",t[i]);return e}}),h.add("module","input",{handle:function(t){if(this.app.component.is()){var e,i,s=t.get("e"),n=this.app.component.get();if(t.is("tab")||t.is("down")){var a=n.getNext(),o=!n.isEditable()||this.app.caret.is(n.getEditableElement(),"end");(a=this._traverseParent(a,n))&&o&&(s.preventDefault(),e=a.getElement(),this.app.component.set(e))}else if(t.is("up")){var r=n.getPrev(),h=!n.isEditable()||this.app.caret.is(n.getEditableElement(),"start");(r=this._traverseParent(r,n))&&h&&(s.preventDefault(),e=r.getElement(),this.app.component.set(e))}else if(t.is("delete")||t.is("backspace"))if(n.isEditable()){if("list"===(i=n.getType())){var l=n.getElement().find("li"),p=this.app.selection.getBlock();if(1===l.length&&this.app.content.isEmptyHtml(p.innerHTML))return void s.preventDefault()}}else s.preventDefault(),this.app.component.remove();else if(t.is("enter")){if("list"===(i=n.getType()))return;if(s.preventDefault(),!n.isEditable())return;var c=this.app.selection.get();c.collapsed||-1===["text","heading","link","button"].indexOf(i)?-1!==["text","heading","table-cell"].indexOf(i)&&this.app.insertion.insertBreakline():c.range.deleteContents()}}},handleTextareaTab:function(t){if(9!==t.keyCode)return!0;t.preventDefault();var e=t.target,i=e.value,s=e.selectionStart;e.value=i.substring(0,s)+"    "+i.substring(e.selectionEnd),e.selectionStart=e.selectionEnd=s+4},_traverseParent:function(t,e){var i=e.getType();if(t||-1!==["block","column"].indexOf(i))t||"column"!==i||(t=e.getParent("grid"));else{var s=e.getParent("block"),n=e.getParent("column");t=n||s}return t}}),h.add("class","tool.input",{mixins:["tool"],type:"input",input:{tag:"input",type:"text",classname:"-form-input"},_buildInput:function(){this.$tool.append(this.$input)}}),h.add("class","tool.textarea",{mixins:["tool"],type:"textarea",input:{tag:"textarea",classname:"-form-textarea"},setFocus:function(){this.$input.focus(),this.$input.get().setSelectionRange(0,0),this.$input.scrollTop(0)},_buildInput:function(){this._has("rows")&&this.$input.attr("rows",this._get("rows")),this.$input.attr("data-gramm_editor",!1),this.$tool.append(this.$input)}}),h.add("class","tool.select",{mixins:["tool"],type:"select",input:{tag:"select",classname:"-form-select"},_buildInput:function(){for(var t in this.obj.options){var e=this.dom("<option>");e.val(t),e.html(this.lang.parse(this.obj.options[t])),this.$input.append(e)}this.$tool.append(this.$input)}}),h.add("class","tool.checkbox",{mixins:["tool"],type:"checkbox",input:{tag:"input",type:"checkbox",classname:"-form-checkbox"},getValue:function(){return this.$input.val()},_buildInput:function(){if(this.$box=this.dom("<label>").addClass(this.prefix+"-form-checkbox-item"),this.$box.append(this.$input),this._has("text")){var t=this.dom("<span>").html(this.lang.parse(this.obj.text));this.$box.append(t)}this.$tool.append(this.$box)}}),h.add("class","tool.segment",{mixins:["tool"],type:"segment",input:{tag:"input",type:"hidden",classname:"-form-input"},setValue:function(t){this.$segment.find("."+this.prefix+"-form-segment-item").removeClass("active"),this.$segment.find("[data-segment="+t+"]").addClass("active"),this.$input.val(t)},_buildInput:function(){this.$segment=this.dom("<div>").addClass(this.prefix+"-form-segment");var t=this.obj.segments;for(var e in t){var i=this.dom("<span>").addClass(this.prefix+"-form-segment-item");i.attr("data-segment",e).on("click",this._catchSegment.bind(this)),Object.prototype.hasOwnProperty.call(t[e],"icon")?i.html(t[e].icon):i.addClass(this.prefix+"-icon-"+t[e].prefix+"-"+e),this.$segment.append(i)}this.$segment.append(this.$input),this.$tool.append(this.$segment)},_catchSegment:function(t){t.preventDefault(),t.stopPropagation();var e=this.dom(t.target).closest("."+this.prefix+"-form-segment-item"),i=e.attr("data-segment");this.$segment.find("."+this.prefix+"-form-segment-item").removeClass("active"),e.addClass("active"),this.$input.val(i),this.app.api(this.setter,this.popup)}}),h.add("class","tool.color",{mixins:["tool"],type:"color",input:{tag:"input",type:"text",classname:"-form-input"},setValue:function(t){this.$input.val(t),this.$select.css("background-color",t),this.$picker&&this.setColor(t),t&&this.$checkbox&&this.$checkbox.attr("checked",!0)},setColor:function(e){this.$picker.attr("data-current-color",e),this.$picker.find("."+this.prefix+"-color").removeClass("active"),this.$picker.find("."+this.prefix+"-color").each(function(t){t.attr("data-value")===e&&(t.addClass("active"),t.css("color",this.app.color.invert(e)))}.bind(this))},_buildInput:function(){this.$box=this.dom("<div>").addClass(this.prefix+"-form-container-flex "+this.prefix+"-form-container-color"),this.$select=this.dom("<span>").addClass(this.prefix+"-form-color-select"),this.$checkbox=this.dom("<input>").addClass(this.prefix+"-form-checkbox").attr("type","checkbox"),this.$input.css("max-width","90px"),this.$input.on("keydown blur",this._changeColorSelect.bind(this)),this._has("picker")?(this.$picker=this._createPicker(),this.$tool.append(this.$picker)):(this.$select.addClass(this.prefix+"-form-color-select-pointer"),this.$select.on("click",this._buildColorpicker.bind(this))),"background-color"===this.name&&(this.$box.append(this.$checkbox),this.$checkbox.on("change",this._changeColorState.bind(this))),this.$box.append(this.$select),this.$box.append(this.$input),this.$tool.append(this.$box),this._has("picker")&&this._buildColors()},_buildColors:function(){for(var t in this.$picker.html(""),this.opts.colors){for(var e=this.dom('<div class="'+this.prefix+'-form-colors">'),i=0;i<this.opts.colors[t].length;i++){var s=this.opts.colors[t][i],n=this._createColor(s,t,i);"#fff"!==s&&"#ffffff"!==s||n.addClass(this.prefix+"-form-color-contrast"),e.append(n)}this.$picker.append(e)}},_buildColorpicker:function(t){t.preventDefault(),t.stopPropagation(),this.$picker=this._createPicker();var e=this.app.popup.add("colorpicker",{title:"## popup.pick-color ##",width:"320px"});e.getBody().append(this.$picker),this._buildColors(),this.setColor(this.$input.val()),e.open()},_createPicker:function(){return this.dom("<div>").addClass(this.prefix+"-form-colorpicker")},_createColor:function(t,e,i){var s=this.dom("<span>").addClass(this.prefix+"-color").css("background-color",t);return s.attr({title:e+"-"+i,"data-value":t}),s.on("mouseover",this._inColor.bind(this)),s.on("mouseout",this._outColor.bind(this)),s.on("click",this._setColor.bind(this)),s},_inColor:function(t){var e=this.dom(t.target).attr("data-value");this._setColorToInput(e)},_outColor:function(){this._setColorToInput(this.$picker.attr("data-current-color"))},_setColorToInput:function(t){this.$input.val(t),this.$select.css("background-color",t)},_setColor:function(t){t.preventDefault(),t.stopPropagation();var e=this.dom(t.target),i=e.attr("data-value");(this.$picker.attr("data-current-color",i),this.$picker.find("."+this.prefix+"-color").removeClass("active"),e.addClass("active"),e.css("color",this.app.color.invert(i)),this._setColorToInput(i),this.setter&&this.app.api(this.setter,this.popup),this._has("picker"))?this.app.popup.close():this.app.popup.getStack().collapse()},_changeColorSelect:function(t){if("keydown"!==t.type||13===t.which){"keydown"===t.type&&t.preventDefault();var e=this.$input.val();e=this.app.color.normalize(e),this.$input.val(e),this.$select.css("background-color",e),this.picker&&this.picker.setColor(e),this.$checkbox.attr("checked",""!==e)}},_changeColorState:function(t){t.preventDefault(),t.stopPropagation();var e=this.$checkbox.attr("checked")?"#ffffff":"";this.setValue(e),this.app.api(this.setter,this.stack)}}),h.add("class","tool.number",{mixins:["tool"],type:"number",input:{tag:"input",type:"number",classname:"-form-input"},_buildInput:function(){this.$input.attr("min",0).css("max-width","65px"),this.$tool.append(this.$input)}}),h.add("class","tool.upload",{mixins:["tool"],type:"upload",input:{tag:"input",type:"hidden",classname:"-form-input"},setValue:function(t){t=t||"",this.upload&&this.upload.setImage(t),this.$input.val(t)},_buildInput:function(){this.$tool.append(this.$input),this._isDirect()&&this._buildDirectUrl(),this._isUpload()&&(this._isDirect()&&this._buildOrSection(),this._buildUpload())},_buildOrSection:function(){var t=this.dom('<div class="'+this.prefix+'-upload-or">').html(this.lang.get("placeholders.or-drag-and-drop-the-image"));this.$tool.append(t)},_buildUpload:function(){this.$upload=this.dom("<input>").attr("type","file"),this.$tool.append(this.$upload);var t=l.extend({},this.obj.upload,{url:this.opts.image.upload,name:this.opts.image.name,data:this.opts.image.data,placeholder:this.opts.placeholders.upload,multiple:this.opts.image.multiple,box:!0,hidden:!1});this.upload=this.app.create("upload",this.$upload,t,{instance:this,method:"trigger"})},_buildDirectUrl:function(){if(this.$directInput=this.dom("<input>").addClass(this.prefix+"-form-input"),this.$directInput.attr({type:"text",placeholder:this.lang.get("placeholders.paste-url-of-image")}),this.$directInput.on("input blur",this._catchDirectInput.bind(this)),!this._isUpload()&&(this.$directLabel=this.dom("<label>").addClass(this.prefix+"-form-label").html(this.lang.get("form.url")),this.$tool.append(this.$directLabel),this._isLayerType())){var t=this.data["background-image"];t=void 0===t?"":t,this.data.src=t,this.$directInput.val(t)}this.$tool.append(this.$directInput)},_isUpload:function(){var t=this.opts.image;return t&&t.upload},_isDirect:function(){var t=this.opts.image;return this._has("direct")&&t&&t.url},_isLayerType:function(){var t=this.instance.getType();return"image"!==t&&"social-item"!==t},_catchDirectInput:function(t){if("keydown"!==t.type||13===t.which){"keydown"===t.type&&t.preventDefault();var e=this.$directInput.val();(""!==e||!this._isUpload()&&this._isLayerType())&&this.trigger(e)}}}),h.add("class","tag.html",{mixins:["tag"],type:"html",create:function(){this.$element=this.dom("<html>").attr(this.params)},build:function(){this.params={xmlns:"http://www.w3.org/1999/xhtml"}},render:function(){return this.$element}}),h.add("class","tag.head",{mixins:["tag"],type:"head",create:function(){this.$element=this.dom("<head>"),this.$element.append('<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />'),this.$element.append('<meta name="viewport" content="width=device-width, initial-scale=1.0" />')},render:function(){return this.$element}}),h.add("class","tag.title",{mixins:["tag"],type:"title",create:function(){this.$element=this.dom("<title>").html(this.params.html)},build:function(){this.params={html:this._getSourceHtml()}},render:function(){return this.$element}}),h.add("class","tag.font",{mixins:["tag"],type:"font",create:function(){this.$element=this.dom("<link>").attr({href:this.params.href,rel:"stylesheet"})},build:function(){this.params={href:this.$source.attr("href")}},render:function(){return this.$element}}),h.add("class","tag.style",{mixins:["tag"],type:"style",create:function(){var t=this.app.content.decodeEntities(this.params.html);this.$element=this.dom("<style>").html(t).attr("type","text/css")},build:function(){this.params={html:this._getSourceHtml()}},render:function(){return this.$element}}),h.add("class","tag.body",{mixins:["tag"],type:"body",toolbar:{shortcut:{title:"## buttons.shortcuts ##",command:"shortcut.popup",observer:"shortcut.observePopup"},mobile:{title:"## buttons.mobile-view ##",command:"editor.toggleView"},code:{title:"## buttons.html ##",command:"source.toggle",observer:"source.checkCodeView"},background:{title:"## buttons.background ##",command:"editor.popup",color:!0,observer:"editor.observe"},tune:{title:"## buttons.settings ##",command:"editor.popup"}},forms:{background:{"background-color":{type:"color",picker:!0}},backgroundimage:{"background-size":{type:"checkbox",text:"## form.pattern ##"},"background-image":{type:"upload",direct:!0,observer:"component.checkImageChange",upload:{success:"image.successBackground",error:"image.error",remove:"image.removeBackground"}}},settings:{padding:{type:"input",label:"## form.padding ##"}}},create:function(){this.$element=this.dom("<body>"),this.$element.css({"font-family":this.opts.editor.font,margin:0,padding:0}),this._createTableContainer(this.params.width),this.$table.addClass("body"),this.$cell.attr("align","center"),this.$element.append(this.$table)},build:function(){this.params={width:"100%"},this.data={"background-color":{target:["element"]},"background-image":{target:["element"]},"background-size":{target:["element"]},class:{target:["cell"]},padding:{target:["cell"]}}},render:function(){return this.$cell}}),h.add("class","tag.preheader",{mixins:["tag"],type:"preheader",create:function(){this.$element=this.dom("<span>").html(this.params.html),this.$element.css({color:"transparent",display:"none",height:0,"max-height":0,"max-width":0,opacity:0,overflow:"hidden","mso-hide":"all",visibility:"hidden",width:0})},build:function(){this.params={html:this._getSourceHtml()}},render:function(){return this.$element}}),h.add("class","tag.header",{mixins:["tag"],type:"header",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},background:{title:"## buttons.background ##",command:"component.popup",color:!0,observer:"component.observe"},border:{title:"## buttons.border ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},forms:{settings:{padding:{type:"input",label:"## form.padding ##"}}},create:function(){this.$element=this._createTableContainer(this.params.width),this.$element.addClass("header container")},build:function(){this.params={width:this._getSourceWidth()},this.data={class:{target:["cell"]},width:{target:["element"]},padding:{target:["cell"]},"background-color":{target:["cell"]},"background-image":{target:["cell"]},"background-size":{target:["cell"]},border:{target:["cell"]},"border-radius":{target:["cell"]},"box-shadow":{target:["element"]}}},render:function(){return this.$cell}}),h.add("class","tag.main",{mixins:["tag"],type:"main",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},background:{title:"## buttons.background ##",command:"component.popup",color:!0,observer:"component.observe"},border:{title:"## buttons.border ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},forms:{settings:{padding:{type:"input",label:"## form.padding ##"}}},create:function(){this.$element=this._createTableContainer(this.params.width),this.$element.addClass("main container")},build:function(){this.params={width:this._getSourceWidth()},this.data={class:{target:["cell"]},width:{target:["element"]},padding:{target:["cell"]},"background-color":{target:["cell"]},"background-image":{target:["cell"]},"background-size":{target:["cell"]},border:{target:["cell"]},"border-radius":{target:["cell"]},"box-shadow":{target:["element"]}}},render:function(){return this.$cell}}),h.add("class","tag.footer",{mixins:["tag"],type:"footer",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},background:{title:"## buttons.background ##",command:"component.popup",color:!0,observer:"component.observe"},border:{title:"## buttons.border ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},forms:{settings:{padding:{type:"input",label:"## form.padding ##"}}},create:function(){this.$element=this._createTableContainer(this.params.width),this.$element.addClass("footer container")},build:function(){this.params={width:this._getSourceWidth()},this.data={class:{target:["cell"]},width:{target:["element"]},padding:{target:["cell"]},"background-color":{target:["cell"]},"background-image":{target:["cell"]},"background-size":{target:["cell"]},border:{target:["cell"]},"border-radius":{target:["cell"]},"box-shadow":{target:["element"]}}},render:function(){return this.$cell}}),h.add("class","tag.container",{mixins:["tag"],type:"container",create:function(){this.$element=this._createTableContainer(this.params.width),this.$element.addClass("container")},build:function(){this.params={width:"100%"},this.data={class:{target:["cell"]},width:{target:["element"]},padding:{target:["cell"]},"background-color":{target:["cell"]},"background-image":{target:["cell"]},"background-size":{target:["cell"]},border:{target:["cell"]},"border-radius":{target:["cell"]}}},render:function(){return this.$cell}}),h.add("class","tag.block",{mixins:["tag"],type:"block",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},alignment:{title:"## buttons.alignment ##",command:"component.popup"},background:{title:"## buttons.background ##",command:"component.popup",color:!0,observer:"component.observe"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},border:{title:"## buttons.border ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{settings:{padding:{type:"input",label:"## form.padding ##"},"column-space":{type:"number",label:"## form.column-space ##",observer:"component.checkColumnSpacer"}}},create:function(){this.$element=this._createTableContainer(this.params.width),this.$element.addClass("block");var t=this.dom('<span class="rex-block-hidden-text">').css({"font-size":"0px",position:"absolute",left:"-9999px",height:0,width:0}).html("hidden text");this.$cell.append(t)},build:function(){this.params={width:"100%"},this.data={align:{target:["cell"]},valign:{target:["cell"]},padding:{target:["cell"]},"background-color":{target:["cell"]},"background-image":{target:["cell"]},"background-size":{target:["cell"]},border:{target:["cell"]},"border-radius":{target:["cell"]},class:{target:["cell"]},color:{target:!1,getter:"getElementsTextColor",setter:"setElementsTextColor",prop:this.getStyle("text","color")},"link-color":{target:!1,getter:"getElementsLinkColor",setter:"setElementsLinkColor",prop:this.getStyle("link","color")},"column-space":{target:!1,getter:"getColumnSpace",setter:"setColumnSpace"},"box-shadow":{target:["element"]}}},render:function(){return this.$cell},getColumnSpace:function(){var t=this.getElements(["column-spacer"]).first();return 0===t.length?null:t.dataget("instance").getData("width")},setColumnSpace:function(e){this.getElements(["column-spacer"]).each(function(t){t.dataget("instance").setData({width:e})})},setAlign:function(e){"left"===e?(this.$cell.removeAttr("align"),this.$source.removeAttr("align")):(this.$cell.attr("align",e),this.$source.attr("align",e));this.getElements(["text","heading","link","menu","social"]).each(function(t){t.dataget("instance").setData({align:null})}),this.getElements(["column"]).each(function(t){t.dataget("instance").setData({align:e})})}}),h.add("class","tag.spacer",{mixins:["tag"],type:"spacer",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{settings:{height:{type:"number",label:"## form.height ##"}}},create:function(){this.$element=this._createTableContainer(this.params.width),this.$element.addClass("spacer"),this.$cell.css({padding:0,"font-size":this.params.height,"line-height":this.params.height}),this.$cell.html("&nbsp;")},build:function(){this.params={height:this.getStyle("spacer","height"),width:"100%"},this.data={height:{target:["cell"],setter:"setHeight",prop:this.params.height}}},render:function(){return this.$cell},setHeight:function(t){var e=0===parseInt(t)?"":"&nbsp;";t=0===parseInt(t)?1:t,t=this.app.normalize.number(t,"px"),this.$cell.html(e),this.$cell.css({height:t,"font-size":t,"line-height":t}),this.$source.attr("height",t)}}),h.add("class","tag.divider",{mixins:["tag"],type:"divider",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},background:{title:"## buttons.background ##",command:"component.popup",color:!0,observer:"component.observe"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{settings:{height:{type:"number",label:"## form.height ##"},width:{type:"input",width:"65px",label:"## form.width ##"}}},create:function(){this.$element=this._createTableContainer(this.params.width),this.$element.addClass("divider"),this.$cell.css({padding:0,"font-size":this.params.height,"line-height":this.params.height}),this.$cell.html("&nbsp;")},build:function(){this.params={height:this.getStyle("divider","height"),width:"100%"},this.data={width:{target:["element"],prop:this.params.width},height:{target:["cell"],setter:"setHeight",prop:this.params.height},"background-color":{target:["cell"],prop:this.getStyle("divider","background-color")}}},render:function(){return this.$cell},setHeight:function(t){this.$cell.css({"font-size":t,"line-height":t}),this.$source.attr("height",t)}}),h.add("class","tag.text",{mixins:["tag"],type:"text",editable:!0,toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},alignment:{title:"## buttons.alignment ##",command:"component.popup"},link:{title:"## buttons.link ##",command:"link.popup"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{settings:{margin:{type:"input",label:"## form.margin ##"},"font-size":{type:"number",label:"## form.text-size ##"}}},create:function(){this.$element=this.dom("<p>").addClass("rex-editable"),this.$element.css({padding:0,margin:0,"font-family":this.getStyle("text","font-family")}),this.$element.html(this.params.html)},build:function(){this.params={html:this._getSourceHtml()},this.data={html:{target:["element"]},color:{target:["element"],prop:this.getStyle("text","color")},"font-size":{target:["element"],setter:"setTextSize",prop:this.getStyle("text","font-size")},"line-height":{target:["element"],prop:this.getStyle("text","line-height")},"link-color":{target:!1,getter:"getLinkColor",setter:"setLinkColor",prop:this.getStyle("link","color")},align:{target:["element"],getter:"getAlign"},margin:{target:["element"]},class:{target:["element"]},"font-weight":{target:["element"]},"font-style":{target:["element"]},"text-decoration":{target:["element"]},"letter-spacing":{target:["element"]},"text-transform":{target:["element"]}}},render:function(){return this._parseHtmlLinks(this.$source,this.$element,this),this.$element},getLinkColor:function(){var t=this.$element.find("a").first(),e=0!==t.length?t.get().style.color:this.getStyle("link","color");return this.app.color.normalize(e)},setTextSize:function(t){this.$element.find("a").css("font-size",t),this.$element.css("font-size",t),this.$source.attr("font-size",t)},setLinkColor:function(t){this.$element.find("a").css("color",t),this.$source.find("a").css("color",t)}}),h.add("class","tag.link",{mixins:["tag"],type:"link",editable:!0,toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},alignment:{title:"## buttons.alignment ##",command:"component.popup"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{settings:{margin:{type:"input",label:"## form.margin ##"},href:{type:"input",label:"## form.url ##"},"font-size":{type:"number",label:"## form.text-size ##"},"text-decoration":{type:"checkbox",text:"## form.underline ##"}}},create:function(){this.$element=this.dom("<p>"),this.$element.css({margin:0,"font-family":this.getStyle("text","font-family")})},build:function(){this.params={html:this._getSourceHtml()},this.data={html:{target:["link"]},color:{target:["link"],prop:this.getStyle("link","color")},"font-size":{target:["link"],prop:this.getStyle("text","font-size")},"font-weight":{target:["link"],prop:this.getStyle("link","font-weight")},"line-height":{target:["link"],prop:this.getStyle("text","line-height")},"text-decoration":{target:["link"],prop:"underline"},align:{target:["element"],getter:"getAlign"},margin:{target:["element"]},href:{target:["link"]},class:{target:["link"]},"font-style":{target:["link"]},"letter-spacing":{target:["link"]},"text-transform":{target:["link"]}}},render:function(){return this._createElementLink(),this.$link},_createElementLink:function(){this.$link=this.dom("<a>").html(this.params.html).addClass("rex-editable"),this.$link.attr("target","_blank"),this.$link.css({"font-family":this.getStyle("text","font-family"),"text-decoration":"underline"}),this.$element.append(this.$link)}}),h.add("class","tag.heading",{mixins:["tag"],type:"heading",editable:!0,href:!1,toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},alignment:{title:"## buttons.alignment ##",command:"component.popup"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{settings:{margin:{type:"input",label:"## form.margin ##"},href:{type:"input",label:"## form.url ##",placeholder:"## placeholders.type-url-to-add-link ##"},level:{type:"select",label:"## form.heading-level ##",options:{h1:"## headings.heading-1 ##",h2:"## headings.heading-2 ##",h3:"## headings.heading-3 ##",h4:"## headings.heading-4 ##",h5:"## headings.heading-5 ##",h6:"## headings.heading-6 ##"}},"font-weight":{type:"checkbox",text:"## form.bold ##"}}},create:function(){this.$element=this.dom("<p>").addClass(this.params.level),this.$element.css(this.css)},build:function(){this.level=this.$source.attr("level")?this.$source.attr("level"):"h2",this.css=this._getCss(this.level),this.params={level:this.level,html:this._getSourceHtml(),href:this.$source.attr("href")},this.data={html:{target:["element"]},level:{target:["element"],setter:"setLevel",prop:this.params.level},color:{target:["element","link"],prop:this.getStyle("heading","color")},"font-weight":{target:["element","link"],getter:"getBold",prop:this.getStyle("heading","font-weight")},"font-size":{target:["element","link"],prop:this.getHeadingStyleByLevel(this.params.level,"font-size")},"line-height":{target:["element","link"],prop:this.getHeadingStyleByLevel(this.params.level,"line-height")},align:{target:["element"],getter:"getAlign"},margin:{target:["element"]},class:{target:["element"]},"font-style":{target:["element","link"]},"text-decoration":{target:["element","link"]},href:{target:["link"]},"letter-spacing":{target:["element","link"]},"text-transform":{target:["element","link"]}}},render:function(){return this._createElementLink(),this.$element},setLevel:function(t){var e={"font-size":this.getHeadingStyleByLevel(t,"font-size"),"line-height":this.getHeadingStyleByLevel(t,"line-height")};this.$element.css(e),this.$link.css(e),this.$source.attr("level",t)},getBold:function(){var t=this.$element.css("font-weight");return"bold"===t||"600"===t||"700"===t||"900"===t},_getCss:function(){return{padding:0,margin:0,"font-style":"normal","font-family":this.getStyle("heading","font-family")}},_createElementLink:function(){this.$link=this._createLink(),this.$link.css({"text-decoration":"none",display:"block"}),this.$link.css(this.css),this.$element.html(""),this.$element.append(this.$link),this.$link.html(this.params.html),this.$link.addClass("rex-editable")}}),h.add("class","tag.grid",{mixins:["tag"],type:"grid",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},create:function(){this.$element=this._createTable(this.params.width),this.$element.addClass("grid"),this.$row=this._createRow(),this.$element.append(this.$row)},build:function(){this.params={width:"100%"}},render:function(){return this.$row}}),h.add("class","tag.column",{mixins:["tag"],type:"column",toolbar:{alignment:{title:"## buttons.alignment ##",command:"component.popup"},background:{title:"## buttons.background ##",command:"component.popup",color:!0,observer:"component.observe"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},border:{title:"## buttons.border ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"}},forms:{settings:{padding:{type:"input",label:"## form.padding ##"},width:{type:"input",width:"65px",label:"## form.width ##"}}},create:function(){this.$element=this._createCell(),this.$element.addClass("mobile column")},build:function(){this.data={color:{target:!1,getter:"getElementsTextColor",setter:"setElementsTextColor",prop:this.getStyle("text","color")},"link-color":{target:!1,getter:"getElementsLinkColor",setter:"setElementsLinkColor",prop:this.getStyle("link","color")},align:{target:["element"],setter:"setAlign"},valign:{target:["element"]},width:{target:["element"]},padding:{target:["element"]},"background-color":{target:["element"]},"background-image":{target:["element"]},"background-size":{target:["element"]},border:{target:["element"]},"border-radius":{target:["element"]},class:{target:["element"]}}},render:function(){return this.$element},remove:function(){this.app.broadcast("component.remove",{element:this.$element});var t=this.getNext();t&&t.isType("column-spacer")&&t.remove(),this.$source.remove(),this.$element.remove()},setAlign:function(t){"left"===t?(this.$element.removeAttr("align"),this.$source.removeAttr("align")):(this.$element.attr("align",t),this.$source.attr("align",t));this.getElements(["text","heading","link","menu","social"]).each(function(t){t.dataget("instance").setData({align:null})})}}),h.add("class","tag.column-spacer",{mixins:["tag"],type:"column-spacer",create:function(){this.$element=this.dom("<td>").addClass("mobile-hidden column-spacer").html("&nbsp;")},build:function(){this.params={width:"20px"},this.data={width:{target:["element"],getter:"getWidth",setter:"setWidth",prop:this.params.width}}},render:function(){return this.$element},getWidth:function(){return this.$element.width()},setWidth:function(t){var e=0===t?"":"&nbsp;";this.$element.html(e),this.$element.css({width:t,"min-width":t}),this.$source.attr("width",t)}}),h.add("class","tag.image",{mixins:["tag"],type:"image",href:!1,toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},border:{title:"## buttons.border ##",command:"component.popup"},image:{title:"## buttons.image ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{image:{src:{type:"upload",direct:!0,observer:"component.checkImageChange",upload:{success:"image.successUpload",error:"image.error"}}},settings:{width:{section:"settings",type:"input",width:"65px",label:"## form.width ##"},alt:{section:"settings",type:"input",label:"## form.alt-text ##"},href:{section:"link",label:"## form.link ##",type:"input"},responsive:{section:"settings",type:"checkbox",text:"## form.responsive-on-mobile ##"}}},create:function(){this.$element=this.dom("<span>"),this.$element.css({display:"inline-block","font-size":"0","line-height":"0","vertical-align":"top"})},build:function(){this.params={width:"100%",href:this.$source.attr("href"),placeholder:this.$source.attr("placeholder")},this.data={placeholder:{target:["img"]},width:{target:["img"],setter:"setWidth",getter:"getWidth"},class:{target:["img"]},src:{target:["img"],setter:"setImage",getter:"getImage"},alt:{target:["img"]},"border-radius":{target:["img"]},border:{target:["img"]},href:{target:["link"]},responsive:{target:!1,setter:"setResponsive",getter:"getResponsive"},"box-shadow":{target:["img"]},"max-width":{target:["img"]},"max-height":{target:["img"]}}},render:function(){return this._createElementImage(),this._createElementLink(),this.$link},isPlaceholder:function(){return this.params.placeholder},getImage:function(){return this.params.placeholder?"":this.$img.attr("src")},getWidth:function(){return this.params.placeholder?"":this.$img.css("width")},getResponsive:function(){return!this.params.placeholder&&this.$element.hasClass("mobile-image")},setResponsive:function(t){t?(this.$element.addClass("mobile-image"),this.$source.attr("responsive",!0)):(this.$element.removeClass("mobile-image"),this.$source.removeAttr("responsive"))},setWidth:function(t){this.params.placeholder||(t=null===t?"":t,this.$img.attr("width",t.replace("px","")),this.$img.css("width",t),this.$source.attr("width",t))},setImage:function(t){""!==t&&(this.params.placeholder&&(this.$source.removeAttr("placeholder"),this.$img=this._createImage(),this.$link.html(""),this.$link.append(this.$img),this.params.placeholder=!1,this.$element.removeClass("rex-image-placeholder")),t=this.app.content.replaceToHttps("src",t),this.$img.attr("src",t),this.$source.attr("src",t),this.params.placeholder||this.$img.one("load",function(){var t=this.app.popup.getStack(),e=this.$img.css("width");t&&t.getInput("width").val(e),this.setWidth(e),this.app.control.updatePosition(),this.app.editor.adjustHeight()}.bind(this)))},_createElementImage:function(){this.params.placeholder?(this.$img=this.dom(this.opts.placeholders.image),this.$element.addClass("rex-image-placeholder")):(this.$source.removeAttr("placeholder"),this.$img=this._createImage())},_createElementLink:function(){this.$link=this._createLink(),this.$link.css({"text-decoration":"none",cursor:"pointer","line-height":"100%","font-size":"0px",display:"block"}),this.$link.append(this.$img),this.$element.append(this.$link)}}),h.add("class","tag.menu",{mixins:["tag"],type:"menu",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},alignment:{title:"## buttons.alignment ##",command:"component.popup"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},items:{title:"## buttons.items ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{item:{html:{type:"input",label:"## form.name ##"},href:{type:"input",label:"## form.url ##"},"text-decoration":{type:"checkbox",text:"## form.underline ##"}},settings:{margin:{type:"input",label:"## form.margin ##"},"font-size":{type:"number",label:"## form.text-size ##"},html:{type:"input",label:"## form.spacer-content ##"}}},create:function(){this.$element=this.dom("<div>").addClass("menu")},build:function(){this.data={color:{target:!1,getter:"getTextColor",setter:"setTextColor",prop:this.getStyle("text","color")},"font-size":{target:!1,getter:"getTextSize",setter:"setTextSize",prop:this.getStyle("text","font-size")},align:{target:["element"],getter:"getAlign"},margin:{target:["element"]},class:{target:["element"]},html:{target:!1,getter:"getSpacerContent",setter:"setSpacerContent"}}},render:function(){return this.$element},getSpacers:function(){return this.getElements(["menu-spacer"])},getItems:function(){return this.getElements(["menu-item"])},getItemsAndSpacers:function(){return this.getElements(["menu-item","menu-spacer"])},getItemInstance:function(){return this.getItems().first().dataget("instance")},getSpacerInstance:function(){return this.getSpacers().first().dataget("instance")},getTextSize:function(){var t=this.getItemInstance();return t?t.getData("font-size"):this.getStyle("text","font-size")},getTextColor:function(){var t=this.getItemInstance();return t?t.getData("color"):this.getStyle("text","color")},getSpacerContent:function(){var t=this.getSpacerInstance();return t?t.getData("html"):""},setTextSize:function(e){this.getItems().each(function(t){t.dataget("instance").setData({"font-size":e})})},setTextColor:function(e){this.getItemsAndSpacers().each(function(t){t.dataget("instance").setData({color:e})})},setSpacerContent:function(e){this.getSpacers().each(function(t){t.dataget("instance").setData({html:e})})}}),h.add("class","tag.menu-item",{mixins:["tag"],type:"menu-item",create:function(){this.$element=this.dom("<a>"),this.$element.html(this.params.html),this.$element.css("font-family",this.getStyle("text","font-family"))},build:function(){this.params={html:this._getSourceHtml(),href:this.$source.attr("href")},this.data={color:{target:["element"],prop:this.getStyle("text","color")},"font-size":{target:["element"],prop:this.getStyle("text","font-size")},"text-decoration":{target:["element"],prop:this.params.href?"underline":"none"},html:{target:["element"]},href:{target:["element"]},class:{target:["element"]},"font-weight":{target:["element"]}}},render:function(){return this.$element},removeItem:function(){this.removeSpacer(),this.remove()},removeSpacer:function(){this.removeNextSpacer(),0===this.$element.nextElement().length&&this.removePrevSpacer()},removePrevSpacer:function(){var t=this.$element.prevElement();"menu-spacer"===t.attr("data-"+this.prefix+"-type")&&t.dataget("instance").remove()},removeNextSpacer:function(){var t=this.$element.nextElement();"menu-spacer"===t.attr("data-"+this.prefix+"-type")&&t.dataget("instance").remove()}}),h.add("class","tag.menu-spacer",{mixins:["tag"],type:"menu-spacer",create:function(){this.$element=this.dom("<span>").html(this.params.html),this.$element.css({display:"inline-block","line-height":0,"font-family":this.getStyle("text","font-family")})},build:function(){this.params={html:this._getSourceHtml()},this.data={"font-size":{target:["element"],prop:this.getStyle("text","font-size")},class:{target:["element"],prop:this.getStyle("text","color")},html:{target:["element"]},color:{target:["element"]},"font-weight":{target:["element"]}}},render:function(){return this.$element}}),h.add("class","tag.social",{mixins:["tag"],type:"social",toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},alignment:{title:"## buttons.alignment ##",command:"component.popup"},items:{title:"## buttons.items ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{item:{src:{type:"upload",direct:!0,observer:"component.checkImageChange",upload:{cover:!1,success:"image.successSocialUpload",error:"image.error"}},width:{type:"input",label:"## form.image-width ##",width:"75px"},href:{type:"input",label:"## form.link ##"},alt:{type:"input",label:"## form.alt-text ##"}},settings:{margin:{type:"input",label:"## form.margin ##"}}},create:function(){this.$element=this.dom("<div>"),this.$element.addClass("social")},build:function(){this.data={align:{target:["element"],getter:"getAlign"},margin:{target:["element"]},class:{target:["element"]}}},render:function(){return this.$element},getItems:function(){return this.getElements(["social-item"])},getSpacers:function(){return this.getElements(["social-spacer"])}}),h.add("class","tag.social-item",{mixins:["tag"],type:"social-item",create:function(){this.$element=this.dom("<a>")},build:function(){this.params={href:this.$source.attr("href"),src:this.$source.attr("src"),placeholder:this.$source.attr("placeholder")},this.data={placeholder:{target:["element"]},href:{target:["element"]},class:{target:["element"]},width:{target:["img"],setter:"setWidth",getter:"getWidth"},alt:{target:["img"]},src:{target:["img"],setter:"setImage",getter:"getImage"}}},render:function(){return this._createElementImage(),this.$element},isPlaceholder:function(){return this.params.placeholder},removeItem:function(){this.removeSpacer(),this.remove()},removeSpacer:function(){this.removeNextSpacer(),0===this.$element.nextElement().length&&this.removePrevSpacer()},removePrevSpacer:function(){var t=this.$element.prevElement();"social-spacer"===t.attr("data-"+this.prefix+"-type")&&t.dataget("instance").remove()},removeNextSpacer:function(){var t=this.$element.nextElement();"social-spacer"===t.attr("data-"+this.prefix+"-type")&&t.dataget("instance").remove()},getWidth:function(){return this.params.placeholder?"":this.$img.css("width")},getImage:function(){return this.params.placeholder?"":this.$img.attr("src")},setImage:function(t){""!==t&&(this.params.placeholder&&(this.$source.removeAttr("placeholder"),this.$img=this._createImage(),this.$element.html(""),this.$element.append(this.$img),this.params.placeholder=!1,this.$element.removeClass("rex-social-placeholder")),t=this.app.content.replaceToHttps("src",t),this.$img.attr("src",t),this.$source.attr("src",t))},setWidth:function(t){this.params.placeholder||(t=null===t?"":t,this.$img.attr("width",t),this.$img.css("width",t),this.$source.attr("width",t))},_createElementImage:function(){this.params.placeholder?(this.$img=this.dom(this.opts.placeholders.social),this.$element.addClass("rex-social-placeholder")):(this.$source.removeAttr("placeholder"),this.$img=this._createImage()),this.$element.append(this.$img)}}),h.add("class","tag.social-spacer",{mixins:["tag"],type:"social-spacer",create:function(){this.$element=this.dom("<span>").html(this.params.html),this.$element.css({display:"inline-block","line-height":0,"font-family":this.getStyle("text","font-family")})},build:function(){this.params={html:this._getSourceHtml()},this.data={"font-size":{target:["element"],prop:this.getStyle("text","font-size")},class:{target:["element"],prop:this.getStyle("text","color")},html:{target:["element"]},color:{target:["element"]},"font-weight":{target:["element"]}}},render:function(){return this.$element}}),h.add("class","tag.button",{mixins:["tag"],type:"button",editable:!0,toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},background:{title:"## buttons.background ##",command:"component.popup",color:!0,observer:"component.observe"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},border:{title:"## buttons.border ##",command:"component.popup"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{settings:{margin:{type:"input",label:"## form.margin ##"},padding:{type:"input",label:"## form.padding ##"},href:{type:"input",label:"## form.url ##"},"font-size":{type:"number",label:"## form.text-size ##"}}},create:function(){this.$element=this._createTableContainer(this.params.width),this.$cell.attr({valign:"top",align:"center"}),this.$cell.css({"vertical-align":"top","text-align":"center","font-family":this.getStyle("text","font-family")})},build:function(){this.params={width:"auto",html:this._getSourceHtml()};var t=this.$source.attr("border"),e=this.$source.attr("background-color");t=t||(e||this.getStyle("button","background-color")),this.data={html:{target:["link"]},"font-size":{target:["element","link"],prop:this.getStyle("button","font-size")},"font-weight":{target:["element","link"],prop:this.getStyle("button","font-weight")},"background-color":{target:["element","link"],prop:this.getStyle("button","background-color")},color:{target:["element","link"],prop:this.getStyle("button","color")},"border-radius":{target:["element","link","cell"],prop:this.getStyle("button","border-radius")},border:{target:["link"],setter:"setBorder",prop:"1px solid "+t},padding:{target:["link"],prop:this.getStyle("button","padding")},margin:{target:["element"]},"font-style":{target:["element","link"]},class:{target:["link"]},href:{target:["link"]},"letter-spacing":{target:["link"]},"text-transform":{target:["link"]}}},render:function(){return this._createElementLink(),this.$link},setBorder:function(t){var e=t.split(" ");this.$link.css("border",t),this.$cell.attr("bgcolor",e[2]),this.$source.attr("border",t)},_createElementLink:function(){this.$link=this.dom("<a>").html(this.params.html).addClass("rex-editable"),this.$link.attr("target","_blank"),this.$link.css({display:"inline-block","box-sizing":"border-box",cursor:"pointer","text-decoration":"none",margin:0,"font-family":this.getStyle("text","font-family")}),this.$cell.append(this.$link)}}),h.add("class","tag.table",{mixins:["tag"],type:"table",create:function(){this.$element=this._createTable(this.params.width),this.$element.addClass("table")},build:function(){this.params={width:"100%"},this.data={class:{target:["element"]},padding:{target:["element"]},border:{target:["element"]},"background-color":{target:["element"]}}},render:function(){return this.$element}}),h.add("class","tag.table-head",{mixins:["tag"],type:"table-head",create:function(){this.$element=this.dom("<thead>")},render:function(){return this.$element}}),h.add("class","tag.table-body",{mixins:["tag"],type:"table-body",create:function(){this.$element=this.dom("<tbody>")},render:function(){return this.$element}}),h.add("class","tag.table-row",{mixins:["tag"],type:"table-row",create:function(){this.$element=this.dom("<tr>")},build:function(){this.data={class:{target:["element"]}}},render:function(){return this.$element}}),h.add("class","tag.table-cell",{mixins:["tag"],type:"table-cell",editable:!0,toolbar:{alignment:{title:"## buttons.alignment ##",command:"component.popup"},link:{title:"## buttons.link ##",command:"link.popup"},background:{title:"## buttons.background ##",command:"component.popup",color:!0,observer:"component.observe"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},tune:{title:"## buttons.settings ##",command:"component.popup"}},forms:{settings:{width:{type:"input",label:"## form.width ##"},padding:{type:"input",label:"## form.padding ##"},"font-size":{type:"number",label:"## form.text-size ##"}}},create:function(){this.$element=this._createCell(),this.$element.html(this.params.html)},build:function(){this.params={html:this._getSourceHtml()},this.data={width:{target:["element"]},align:{target:["element"]},rowspan:{target:["element"]},colspan:{target:["element"]},class:{target:["element"]},padding:{target:["element"],prop:this.getStyle("table","padding")},border:{target:["element"]},color:{target:["element"]},"font-size":{target:["element"],setter:"setTextSize",prop:this.getStyle("text","font-size")},"line-height":{target:["element"],prop:this.getStyle("text","line-height")},"background-color":{target:["element"]}}},render:function(){return this.$element},setTextSize:function(t){this.$element.find("a").css("font-size",t),this.$element.css("font-size",t),this.$source.attr("font-size",t)}}),h.add("class","tag.code",{mixins:["tag"],type:"code",create:function(){this.$element=this.dom("<pre>").html(""),this.$element.css({"font-family":this.getStyle("code","font-family"),margin:0,overflow:"auto","white-space":"pre"})},build:function(){this.params={html:this._getSourceHtml()},this.data={"font-size":{target:["element"],prop:this.getStyle("code","font-size")},"line-height":{target:["element"],prop:this.getStyle("code","line-height")},color:{target:["element"],prop:this.getStyle("code","color")},padding:{target:["element"],prop:this.getStyle("code","padding")},"background-color":{target:["element"],prop:this.getStyle("code","background-color")},class:{target:["element"]},border:{target:["element"]}}},render:function(){return this.$element}}),h.add("class","tag.list",{mixins:["tag"],type:"list",editable:!0,toolbar:{add:{title:"## buttons.add ##",command:"component.popup"},alignment:{title:"## buttons.alignment ##",command:"component.popup"},link:{title:"## buttons.link ##",command:"link.popup"},"text-color":{title:"## buttons.text-color ##",command:"component.popup",color:!0,observer:"component.observe"},tune:{title:"## buttons.settings ##",command:"component.popup"}},control:{trash:{command:"component.remove"},duplicate:{command:"component.duplicate"}},forms:{settings:{type:{type:"select",label:"## form.list-type ##",options:{unordered:"## lists.unordered ##",ordered:"## lists.ordered ##"}},margin:{type:"input",label:"## form.margin ##"},"font-size":{type:"number",label:"## form.text-size ##"}}},create:function(){var t=this.params.type?this.params.type:"unordered";t="unordered"===t?"ul":"ol",this.$element=this.dom("<"+t+">"),this.$element.css({margin:0,padding:0,"font-family":this.getStyle("text","font-family")})},build:function(){this.params={type:this.$source.attr("type")},this.data={type:{target:["element"],setter:"setListType",getter:"getListType"},margin:{target:["element"]},color:{target:["element"],prop:this.getStyle("text","color"),setter:"setTextColor"},align:{target:["element"],getter:"getAlign"},"font-size":{target:["element"],setter:"setTextSize",prop:this.getStyle("text","font-size")},"font-weight":{target:["element"],prop:this.getStyle("text","font-weight")},"line-height":{target:["element"],prop:this.getStyle("text","line-height")},class:{target:["element"]}}},render:function(){return this.$element},getListType:function(){return"ul"===this.getTag()?"unordered":"ordered"},setListType:function(t){var e="unordered"===t?"ul":"ol";e!==this.getTag()&&(this.$element=this.app.element.replaceToTag(this.$element,e,!0),this.$element.dataset("instance",this),this.app.editor.rebuild(),this.$source.attr("type",t))},setTextColor:function(t){this.$element.find("li").css("color",t),this.$source.attr("color",t)},setTextSize:function(t){this.$element.find("a, li").css("font-size",t),this.$element.css("font-size",t),this.$source.attr("font-size",t)}}),h.add("class","tag.list-item",{mixins:["tag"],type:"list-item",create:function(){var t=this.$source.parent();this.$element=this.dom("<li>"),this.$element.css({"font-family":t.attr("font-family")||this.getStyle("text","font-family"),"font-size":t.attr("font-size")||this.getStyle("text","font-size"),"font-weight":t.attr("font-weight")||this.getStyle("text","font-weight"),"line-height":t.attr("line-height")||this.getStyle("text","line-height"),color:t.attr("color")||this.getStyle("text","color"),margin:0,"margin-left":"24px"}),this.$element.html(this.params.html)},build:function(){this.params={html:this._getSourceHtml()},this.data={class:{target:["element"]}}},render:function(){return this._parseHtmlLinks(this.$source,this.$element,this),this.$element}}),h.add("class","tag.var",{mixins:["tag"],type:"var",create:function(){this.$element=this.dom("<re-var>").attr("data-type",this.$source.attr("data-type")),this.$element.css("display","none"),this.$element.html(this.$source.text())},render:function(){return this.$element}}),h.add("block","block.text",{mixins:["block"],type:"text",section:"one",priority:10,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 20px 20px"});var t=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});this.block.add(t)}}),h.add("block","block.heading",{mixins:["block"],type:"heading",section:"one",priority:20,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 5px 20px"});var t=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading")});this.block.add(t)}}),h.add("block","block.heading-text",{mixins:["block"],type:"heading-text",section:"one",priority:30,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 20px 20px"});var t=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),margin:"0 0 5px 0"}),e=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});this.block.add(t),this.block.add(e)}}),h.add("block","block.image",{mixins:["block"],type:"image",section:"one",priority:40,build:function(){this.block=this.app.create("tag.block");var t=this.app.create("tag.image",{placeholder:!0});this.block.add(t)}}),h.add("block","block.image-text",{mixins:["block"],type:"image-text",section:"one",priority:50,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 20px 20px"});var t=this.app.create("tag.image",{placeholder:!0}),e=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem"),margin:"10px 0 0 0"});this.block.add(t),this.block.add(e)}}),h.add("block","block.image-heading-text",{mixins:["block"],type:"image-heading-text",section:"one",priority:60,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 20px 20px"});var t=this.app.create("tag.image",{placeholder:!0}),e=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),margin:"10px 0 5px 0"}),i=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});this.block.add(t),this.block.add(e),this.block.add(i)}}),h.add("block","block.button",{mixins:["block"],type:"button",section:"one",priority:70,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px"});var t=this.app.create("tag.button",{html:this.lang.get("placeholders.button")});this.block.add(t)}}),h.add("block","block.link",{mixins:["block"],type:"link",section:"one",priority:80,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px"});var t=this.app.create("tag.link",{html:this.lang.get("placeholders.link")});this.block.add(t)}}),h.add("block","block.divider",{mixins:["block"],type:"divider",section:"one",priority:90,build:function(){this.block=this.app.create("tag.block",{padding:"10px 0"});var t=this.app.create("tag.divider");this.block.add(t)}}),h.add("block","block.spacer",{mixins:["block"],type:"spacer",section:"one",priority:100,build:function(){this.block=this.app.create("tag.block");var t=this.app.create("tag.spacer");this.block.add(t)}}),h.add("block","block.menu",{mixins:["block"],type:"menu",section:"one",priority:110,build:function(){this.block=this.app.create("tag.block",{align:"center",padding:"10px 20px"});var t=this.app.create("tag.menu"),e=this.app.create("tag.menu-item",{href:"https://example.com",html:this.lang.get("placeholders.item")+" 1"}),i=this.app.create("tag.menu-item",{href:"https://example.com",html:this.lang.get("placeholders.item")+" 2"}),s=this.app.create("tag.menu-spacer",{html:"&nbsp;&nbsp;&nbsp;"});t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.social",{mixins:["block"],type:"social",section:"one",priority:120,build:function(){this.block=this.app.create("tag.block",{align:"center",padding:"10px 20px"});var t=this.app.create("tag.social"),e=this.app.create("tag.social-item",{placeholder:!0,href:"https://facebook.com",alt:"Facebook"}),i=this.app.create("tag.social-item",{placeholder:!0,href:"https://twitter.com",alt:"Twitter"}),s=this.app.create("tag.social-spacer",{html:"&nbsp;&nbsp;&nbsp;"});t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.list",{mixins:["block"],type:"list",section:"one",priority:130,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 20px 20px"});var t=this.app.create("tag.list"),e=this.app.create("tag.list-item");t.add(e),this.block.add(t)}}),h.add("block","block.two-text",{mixins:["block"],type:"two-text",section:"two",priority:10,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")}),a=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(n),i.add(a),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.two-headings-text",{mixins:["block"],type:"two-headings-text",section:"two",priority:50,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),margin:"0 0 5px 0"}),a=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),margin:"0 0 5px 0"}),o=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")}),r=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(n),e.add(o),i.add(a),i.add(r),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.two-images",{mixins:["block"],type:"two-images",section:"two",priority:20,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.image",{placeholder:!0}),a=this.app.create("tag.image",{placeholder:!0});e.add(n),i.add(a),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.two-images-text",{mixins:["block"],type:"two-images-text",section:"two",priority:60,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.image",{placeholder:!0}),a=this.app.create("tag.image",{placeholder:!0}),o=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem"),margin:"10px 0 0 0"}),r=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem"),margin:"10px 0 0 0"});e.add(n),e.add(o),i.add(a),i.add(r),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.two-images-headings-text",{mixins:["block"],type:"two-images-headings-text",section:"two",priority:70,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.image",{placeholder:!0}),a=this.app.create("tag.image",{placeholder:!0}),o=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"10px 0 5px 0"}),r=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"10px 0 5px 0"}),h=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")}),l=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(n),e.add(o),e.add(h),i.add(a),i.add(r),i.add(l),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.two-buttons",{mixins:["block"],type:"two-buttons",section:"two",priority:30,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%",align:"right"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.button",{html:this.lang.get("placeholders.button")}),a=this.app.create("tag.button",{html:this.lang.get("placeholders.button")});e.add(n),i.add(a),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.two-links",{mixins:["block"],type:"two-links",section:"two",priority:40,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",align:"right",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.link",{html:this.lang.get("placeholders.link"),align:"right"}),a=this.app.create("tag.link",{html:this.lang.get("placeholders.link")});e.add(n),i.add(a),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.three-text",{mixins:["block"],type:"three-text",section:"three",priority:10,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),s=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),n=this.app.create("tag.column-spacer",{width:"20px"}),a=this.app.create("tag.column-spacer",{width:"20px"}),o=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")}),r=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")}),h=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")});e.add(o),i.add(r),s.add(h),t.add(e),t.add(n),t.add(i),t.add(a),t.add(s),this.block.add(t)}}),h.add("block","block.three-headings-text",{mixins:["block"],type:"three-headings-text",section:"three",priority:30,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),s=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),n=this.app.create("tag.column-spacer",{width:"20px"}),a=this.app.create("tag.column-spacer",{width:"20px"}),o=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"0 0 5px 0"}),r=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"0 0 5px 0"}),h=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"0 0 5px 0"}),l=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")}),p=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")}),c=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")});e.add(o),e.add(l),i.add(r),i.add(p),s.add(h),s.add(c),t.add(e),t.add(n),t.add(i),t.add(a),t.add(s),this.block.add(t)}}),h.add("block","block.three-images",{mixins:["block"],type:"three-images",section:"three",priority:20,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),s=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),n=this.app.create("tag.column-spacer",{width:"20px"}),a=this.app.create("tag.column-spacer",{width:"20px"}),o=this.app.create("tag.image",{placeholder:!0}),r=this.app.create("tag.image",{placeholder:!0}),h=this.app.create("tag.image",{placeholder:!0});e.add(o),i.add(r),s.add(h),t.add(e),t.add(n),t.add(i),t.add(a),t.add(s),this.block.add(t)}}),h.add("block","block.three-images-text",{mixins:["block"],type:"three-images-text",section:"three",priority:40,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),s=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),n=this.app.create("tag.column-spacer",{width:"20px"}),a=this.app.create("tag.column-spacer",{width:"20px"}),o=this.app.create("tag.image",{placeholder:!0}),r=this.app.create("tag.image",{placeholder:!0}),h=this.app.create("tag.image",{placeholder:!0}),l=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short"),margin:"10px 0 0 0"}),p=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short"),margin:"10px 0 0 0"}),c=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short"),margin:"10px 0 0 0"});e.add(o),e.add(l),i.add(r),i.add(p),s.add(h),s.add(c),t.add(e),t.add(n),t.add(i),t.add(a),t.add(s),this.block.add(t)}}),h.add("block","block.three-images-headings-text",{mixins:["block"],type:"three-images-headings-text",section:"three",priority:50,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),s=this.app.create("tag.column",{padding:"0 0 20px 0",width:"33%"}),n=this.app.create("tag.column-spacer",{width:"20px"}),a=this.app.create("tag.column-spacer",{width:"20px"}),o=this.app.create("tag.image",{placeholder:!0}),r=this.app.create("tag.image",{placeholder:!0}),h=this.app.create("tag.image",{placeholder:!0}),l=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"10px 0 5px 0"}),p=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"10px 0 5px 0"}),c=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"10px 0 5px 0"}),d=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")}),u=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")}),m=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem-short")});e.add(o),e.add(l),e.add(d),i.add(r),i.add(p),i.add(u),s.add(h),s.add(c),s.add(m),t.add(e),t.add(n),t.add(i),t.add(a),t.add(s),this.block.add(t)}}),h.add("block","block.misc-heading-text",{mixins:["block"],type:"misc-heading-text",section:"misc",priority:50,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading")}),a=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(n),i.add(a),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.misc-text-heading",{mixins:["block"],type:"misc-text-heading",section:"misc",priority:60,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading")}),a=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(a),i.add(n),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.misc-image-text",{mixins:["block"],type:"misc-image-text",section:"misc",priority:10,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.image",{placeholder:!0}),a=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(n),i.add(a),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.misc-text-image",{mixins:["block"],type:"misc-text-image",section:"misc",priority:20,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"50%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.image",{placeholder:!0}),a=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(a),i.add(n),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.misc-image-heading-text",{mixins:["block"],type:"misc-image-heading-text",section:"misc",priority:30,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"40%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"60%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.image",{placeholder:!0}),a=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"0 0 5px 0"}),o=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(n),i.add(a),i.add(o),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),h.add("block","block.misc-heading-text-image",{mixins:["block"],type:"misc-heading-text-image",section:"misc",priority:40,build:function(){this.block=this.app.create("tag.block",{padding:"10px 20px 0 20px"});var t=this.app.create("tag.grid"),e=this.app.create("tag.column",{padding:"0 0 20px 0",width:"60%"}),i=this.app.create("tag.column",{padding:"0 0 20px 0",width:"40%"}),s=this.app.create("tag.column-spacer",{width:"20px"}),n=this.app.create("tag.image",{placeholder:!0}),a=this.app.create("tag.heading",{html:this.lang.get("placeholders.lorem-heading"),level:"h3",margin:"0 0 5px 0"}),o=this.app.create("tag.text",{html:this.lang.get("placeholders.lorem")});e.add(a),e.add(o),i.add(n),t.add(e),t.add(s),t.add(i),this.block.add(t)}}),window.$RE=window.Revolvapp=h,window.addEventListener("load",function(){h("[data-revolvapp]")}),"object"==typeof module&&module.exports&&(module.exports=h,module.exports.Revolvapp=h)}();
export default Revolvapp;